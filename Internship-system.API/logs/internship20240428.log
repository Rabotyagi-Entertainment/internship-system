[2024-04-28 13:50:38 +07:00 INF] Executed DbCommand (130ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT EXISTS (
    SELECT 1 FROM pg_catalog.pg_class c
    JOIN pg_catalog.pg_namespace n ON n.oid=c.relnamespace
    WHERE n.nspname='public' AND
          c.relname='__EFMigrationsHistory'
) <s:Microsoft.EntityFrameworkCore.Database.Command>
[2024-04-28 13:50:38 +07:00 INF] Executed DbCommand (12ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT "MigrationId", "ProductVersion"
FROM "__EFMigrationsHistory"
ORDER BY "MigrationId"; <s:Microsoft.EntityFrameworkCore.Database.Command>
[2024-04-28 13:50:38 +07:00 INF] Executed DbCommand (42ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT EXISTS (
    SELECT 1 FROM pg_catalog.pg_class c
    JOIN pg_catalog.pg_namespace n ON n.oid=c.relnamespace
    WHERE n.nspname='public' AND
          c.relname='__EFMigrationsHistory'
) <s:Microsoft.EntityFrameworkCore.Database.Command>
[2024-04-28 13:50:38 +07:00 INF] Executed DbCommand (3ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT EXISTS (
    SELECT 1 FROM pg_catalog.pg_class c
    JOIN pg_catalog.pg_namespace n ON n.oid=c.relnamespace
    WHERE n.nspname='public' AND
          c.relname='__EFMigrationsHistory'
) <s:Microsoft.EntityFrameworkCore.Database.Command>
[2024-04-28 13:50:38 +07:00 INF] Executed DbCommand (1ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT "MigrationId", "ProductVersion"
FROM "__EFMigrationsHistory"
ORDER BY "MigrationId"; <s:Microsoft.EntityFrameworkCore.Database.Command>
[2024-04-28 13:50:38 +07:00 INF] Applying migration '20240421072010_fix_practice_diary'. <s:Microsoft.EntityFrameworkCore.Migrations>
[2024-04-28 13:50:38 +07:00 INF] Executed DbCommand (11ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
ALTER TABLE "PracticeDiaries" RENAME COLUMN "StudentFullName" TO "WorkName"; <s:Microsoft.EntityFrameworkCore.Database.Command>
[2024-04-28 13:50:38 +07:00 INF] Executed DbCommand (1ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
ALTER TABLE "PracticeDiaries" RENAME COLUMN "CourseWorkName" TO "StudentCharacteristics"; <s:Microsoft.EntityFrameworkCore.Database.Command>
[2024-04-28 13:50:38 +07:00 INF] Executed DbCommand (9ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
ALTER TABLE "PracticeDiaries" ADD "DiaryType" integer NOT NULL DEFAULT 0; <s:Microsoft.EntityFrameworkCore.Database.Command>
[2024-04-28 13:50:38 +07:00 INF] Executed DbCommand (1ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
ALTER TABLE "PracticeDiaries" ADD "EditedAt" timestamp with time zone NOT NULL DEFAULT TIMESTAMPTZ '-infinity'; <s:Microsoft.EntityFrameworkCore.Database.Command>
[2024-04-28 13:50:38 +07:00 INF] Executed DbCommand (6ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
ALTER TABLE "Internships" ADD "OrderNumber" text; <s:Microsoft.EntityFrameworkCore.Database.Command>
[2024-04-28 13:50:38 +07:00 INF] Executed DbCommand (2ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
INSERT INTO "__EFMigrationsHistory" ("MigrationId", "ProductVersion")
VALUES ('20240421072010_fix_practice_diary', '8.0.4'); <s:Microsoft.EntityFrameworkCore.Database.Command>
[2024-04-28 13:50:38 +07:00 INF] User profile is available. Using 'C:\Users\danka\AppData\Local\ASP.NET\DataProtection-Keys' as key repository and Windows DPAPI to encrypt keys at rest. <s:Microsoft.AspNetCore.DataProtection.KeyManagement.XmlKeyManager>
[2024-04-28 13:50:39 +07:00 INF] Executed DbCommand (17ms) [Parameters=[@__normalizedName_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT a."Id", a."ConcurrencyStamp", a."Name", a."NormalizedName", a."RoleType"
FROM "AspNetRoles" AS a
WHERE a."NormalizedName" = @__normalizedName_0
LIMIT 1 <s:Microsoft.EntityFrameworkCore.Database.Command>
[2024-04-28 13:50:39 +07:00 INF] Executed DbCommand (1ms) [Parameters=[@__normalizedName_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT a."Id", a."ConcurrencyStamp", a."Name", a."NormalizedName", a."RoleType"
FROM "AspNetRoles" AS a
WHERE a."NormalizedName" = @__normalizedName_0
LIMIT 1 <s:Microsoft.EntityFrameworkCore.Database.Command>
[2024-04-28 13:50:39 +07:00 INF] Executed DbCommand (5ms) [Parameters=[@__normalizedEmail_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT a."Id", a."AccessFailedCount", a."ConcurrencyStamp", a."Discriminator", a."Email", a."EmailConfirmed", a."FullName", a."JoinedAt", a."LockoutEnabled", a."LockoutEnd", a."NormalizedEmail", a."NormalizedUserName", a."PasswordHash", a."PhoneNumber", a."PhoneNumberConfirmed", a."SecurityStamp", a."TwoFactorEnabled", a."UserName", a."CourseNumber", a."Group"
FROM "AspNetUsers" AS a
WHERE a."NormalizedEmail" = @__normalizedEmail_0
LIMIT 2 <s:Microsoft.EntityFrameworkCore.Database.Command>
[2024-04-28 13:50:39 +07:00 INF] Executed DbCommand (1ms) [Parameters=[@__normalizedEmail_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT a."Id", a."AccessFailedCount", a."ConcurrencyStamp", a."Discriminator", a."Email", a."EmailConfirmed", a."FullName", a."JoinedAt", a."LockoutEnabled", a."LockoutEnd", a."NormalizedEmail", a."NormalizedUserName", a."PasswordHash", a."PhoneNumber", a."PhoneNumberConfirmed", a."SecurityStamp", a."TwoFactorEnabled", a."UserName", a."CourseNumber", a."Group"
FROM "AspNetUsers" AS a
WHERE a."NormalizedEmail" = @__normalizedEmail_0
LIMIT 2 <s:Microsoft.EntityFrameworkCore.Database.Command>
[2024-04-28 13:50:39 +07:00 INF] Executed DbCommand (2ms) [Parameters=[@__normalizedRoleName_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT a."Id", a."ConcurrencyStamp", a."Name", a."NormalizedName", a."RoleType"
FROM "AspNetRoles" AS a
WHERE a."NormalizedName" = @__normalizedRoleName_0
LIMIT 2 <s:Microsoft.EntityFrameworkCore.Database.Command>
[2024-04-28 13:50:39 +07:00 INF] Executed DbCommand (5ms) [Parameters=[@__get_Item_0='?' (DbType = Guid), @__get_Item_1='?' (DbType = Guid)], CommandType='"Text"', CommandTimeout='30']
SELECT a."UserId", a."RoleId"
FROM "AspNetUserRoles" AS a
WHERE a."UserId" = @__get_Item_0 AND a."RoleId" = @__get_Item_1
LIMIT 1 <s:Microsoft.EntityFrameworkCore.Database.Command>
[2024-04-28 13:50:40 +07:00 INF] Now listening on: http://localhost:5105 <s:Microsoft.Hosting.Lifetime>
[2024-04-28 13:50:40 +07:00 INF] Application started. Press Ctrl+C to shut down. <s:Microsoft.Hosting.Lifetime>
[2024-04-28 13:50:40 +07:00 INF] Hosting environment: Development <s:Microsoft.Hosting.Lifetime>
[2024-04-28 13:50:40 +07:00 INF] Content root path: D:\prog\a_projects\back\Internship\Internship-system.API <s:Microsoft.Hosting.Lifetime>
[2024-04-28 13:50:45 +07:00 INF] Request starting HTTP/1.1 GET http://localhost:5105/swagger/index.html - null null <s:Microsoft.AspNetCore.Hosting.Diagnostics>
[2024-04-28 13:50:45 +07:00 INF] Request finished HTTP/1.1 GET http://localhost:5105/swagger/index.html - 200 null text/html;charset=utf-8 255.532ms <s:Microsoft.AspNetCore.Hosting.Diagnostics>
[2024-04-28 13:50:45 +07:00 INF] Request starting HTTP/1.1 GET http://localhost:5105/swagger/v1/swagger.json - null null <s:Microsoft.AspNetCore.Hosting.Diagnostics>
[2024-04-28 13:50:45 +07:00 INF] Request starting HTTP/1.1 GET http://localhost:5105/swagger/favicon-32x32.png - null null <s:Microsoft.AspNetCore.Hosting.Diagnostics>
[2024-04-28 13:50:45 +07:00 INF] Sending file. Request path: '/favicon-32x32.png'. Physical path: 'N/A' <s:Microsoft.AspNetCore.StaticFiles.StaticFileMiddleware>
[2024-04-28 13:50:45 +07:00 INF] Request finished HTTP/1.1 GET http://localhost:5105/swagger/favicon-32x32.png - 200 628 image/png 41.4306ms <s:Microsoft.AspNetCore.Hosting.Diagnostics>
[2024-04-28 13:50:46 +07:00 INF] Request finished HTTP/1.1 GET http://localhost:5105/swagger/v1/swagger.json - 200 null application/json;charset=utf-8 362.777ms <s:Microsoft.AspNetCore.Hosting.Diagnostics>
[2024-04-28 13:51:41 +07:00 INF] Executed DbCommand (88ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT EXISTS (
    SELECT 1 FROM pg_catalog.pg_class c
    JOIN pg_catalog.pg_namespace n ON n.oid=c.relnamespace
    WHERE n.nspname='public' AND
          c.relname='__EFMigrationsHistory'
) <s:Microsoft.EntityFrameworkCore.Database.Command>
[2024-04-28 13:51:41 +07:00 INF] Executed DbCommand (8ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT "MigrationId", "ProductVersion"
FROM "__EFMigrationsHistory"
ORDER BY "MigrationId"; <s:Microsoft.EntityFrameworkCore.Database.Command>
[2024-04-28 13:51:41 +07:00 INF] Executed DbCommand (3ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT EXISTS (
    SELECT 1 FROM pg_catalog.pg_class c
    JOIN pg_catalog.pg_namespace n ON n.oid=c.relnamespace
    WHERE n.nspname='public' AND
          c.relname='__EFMigrationsHistory'
) <s:Microsoft.EntityFrameworkCore.Database.Command>
[2024-04-28 13:51:41 +07:00 INF] Executed DbCommand (2ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT EXISTS (
    SELECT 1 FROM pg_catalog.pg_class c
    JOIN pg_catalog.pg_namespace n ON n.oid=c.relnamespace
    WHERE n.nspname='public' AND
          c.relname='__EFMigrationsHistory'
) <s:Microsoft.EntityFrameworkCore.Database.Command>
[2024-04-28 13:51:41 +07:00 INF] Executed DbCommand (1ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT "MigrationId", "ProductVersion"
FROM "__EFMigrationsHistory"
ORDER BY "MigrationId"; <s:Microsoft.EntityFrameworkCore.Database.Command>
[2024-04-28 13:51:41 +07:00 INF] No migrations were applied. The database is already up to date. <s:Microsoft.EntityFrameworkCore.Migrations>
[2024-04-28 13:51:41 +07:00 INF] User profile is available. Using 'C:\Users\danka\AppData\Local\ASP.NET\DataProtection-Keys' as key repository and Windows DPAPI to encrypt keys at rest. <s:Microsoft.AspNetCore.DataProtection.KeyManagement.XmlKeyManager>
[2024-04-28 13:51:42 +07:00 INF] Executed DbCommand (23ms) [Parameters=[@__normalizedName_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT a."Id", a."ConcurrencyStamp", a."Name", a."NormalizedName", a."RoleType"
FROM "AspNetRoles" AS a
WHERE a."NormalizedName" = @__normalizedName_0
LIMIT 1 <s:Microsoft.EntityFrameworkCore.Database.Command>
[2024-04-28 13:51:42 +07:00 INF] Executed DbCommand (1ms) [Parameters=[@__normalizedName_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT a."Id", a."ConcurrencyStamp", a."Name", a."NormalizedName", a."RoleType"
FROM "AspNetRoles" AS a
WHERE a."NormalizedName" = @__normalizedName_0
LIMIT 1 <s:Microsoft.EntityFrameworkCore.Database.Command>
[2024-04-28 13:51:42 +07:00 INF] Executed DbCommand (3ms) [Parameters=[@__normalizedEmail_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT a."Id", a."AccessFailedCount", a."ConcurrencyStamp", a."Discriminator", a."Email", a."EmailConfirmed", a."FullName", a."JoinedAt", a."LockoutEnabled", a."LockoutEnd", a."NormalizedEmail", a."NormalizedUserName", a."PasswordHash", a."PhoneNumber", a."PhoneNumberConfirmed", a."SecurityStamp", a."TwoFactorEnabled", a."UserName", a."CourseNumber", a."Group"
FROM "AspNetUsers" AS a
WHERE a."NormalizedEmail" = @__normalizedEmail_0
LIMIT 2 <s:Microsoft.EntityFrameworkCore.Database.Command>
[2024-04-28 13:51:42 +07:00 INF] Executed DbCommand (1ms) [Parameters=[@__normalizedEmail_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT a."Id", a."AccessFailedCount", a."ConcurrencyStamp", a."Discriminator", a."Email", a."EmailConfirmed", a."FullName", a."JoinedAt", a."LockoutEnabled", a."LockoutEnd", a."NormalizedEmail", a."NormalizedUserName", a."PasswordHash", a."PhoneNumber", a."PhoneNumberConfirmed", a."SecurityStamp", a."TwoFactorEnabled", a."UserName", a."CourseNumber", a."Group"
FROM "AspNetUsers" AS a
WHERE a."NormalizedEmail" = @__normalizedEmail_0
LIMIT 2 <s:Microsoft.EntityFrameworkCore.Database.Command>
[2024-04-28 13:51:42 +07:00 INF] Executed DbCommand (1ms) [Parameters=[@__normalizedRoleName_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT a."Id", a."ConcurrencyStamp", a."Name", a."NormalizedName", a."RoleType"
FROM "AspNetRoles" AS a
WHERE a."NormalizedName" = @__normalizedRoleName_0
LIMIT 2 <s:Microsoft.EntityFrameworkCore.Database.Command>
[2024-04-28 13:51:42 +07:00 INF] Executed DbCommand (5ms) [Parameters=[@__get_Item_0='?' (DbType = Guid), @__get_Item_1='?' (DbType = Guid)], CommandType='"Text"', CommandTimeout='30']
SELECT a."UserId", a."RoleId"
FROM "AspNetUserRoles" AS a
WHERE a."UserId" = @__get_Item_0 AND a."RoleId" = @__get_Item_1
LIMIT 1 <s:Microsoft.EntityFrameworkCore.Database.Command>
[2024-04-28 13:51:42 +07:00 INF] Now listening on: http://localhost:5105 <s:Microsoft.Hosting.Lifetime>
[2024-04-28 13:51:42 +07:00 INF] Application started. Press Ctrl+C to shut down. <s:Microsoft.Hosting.Lifetime>
[2024-04-28 13:51:42 +07:00 INF] Hosting environment: Development <s:Microsoft.Hosting.Lifetime>
[2024-04-28 13:51:42 +07:00 INF] Content root path: D:\prog\a_projects\back\Internship\Internship-system.API <s:Microsoft.Hosting.Lifetime>
[2024-04-28 13:51:43 +07:00 INF] Request starting HTTP/1.1 GET http://localhost:5105/swagger/index.html - null null <s:Microsoft.AspNetCore.Hosting.Diagnostics>
[2024-04-28 13:51:43 +07:00 INF] Request finished HTTP/1.1 GET http://localhost:5105/swagger/index.html - 200 null text/html;charset=utf-8 252.9665ms <s:Microsoft.AspNetCore.Hosting.Diagnostics>
[2024-04-28 13:51:43 +07:00 INF] Request starting HTTP/1.1 GET http://localhost:5105/swagger/v1/swagger.json - null null <s:Microsoft.AspNetCore.Hosting.Diagnostics>
[2024-04-28 13:51:44 +07:00 INF] Request finished HTTP/1.1 GET http://localhost:5105/swagger/v1/swagger.json - 200 null application/json;charset=utf-8 406.5304ms <s:Microsoft.AspNetCore.Hosting.Diagnostics>
[2024-04-28 13:51:59 +07:00 INF] Request starting HTTP/1.1 POST http://localhost:5105/admin/internship/students - multipart/form-data; boundary=----WebKitFormBoundaryNF4gggPx2uIJpjJj 5000 <s:Microsoft.AspNetCore.Hosting.Diagnostics>
[2024-04-28 13:51:59 +07:00 WRN] Failed to determine the https port for redirect. <s:Microsoft.AspNetCore.HttpsPolicy.HttpsRedirectionMiddleware>
[2024-04-28 13:51:59 +07:00 INF] CORS policy execution successful. <s:Microsoft.AspNetCore.Cors.Infrastructure.CorsService>
[2024-04-28 13:51:59 +07:00 INF] Executing endpoint 'Internship_system.Controllers.InternshipAdminController.UploadStudents (Internship-system.API)' <s:Microsoft.AspNetCore.Routing.EndpointMiddleware>
[2024-04-28 13:51:59 +07:00 INF] Route matched with {action = "UploadStudents", controller = "InternshipAdmin"}. Executing controller action with signature System.Threading.Tasks.Task UploadStudents(Microsoft.AspNetCore.Http.IFormFile) on controller Internship_system.Controllers.InternshipAdminController (Internship-system.API). <s:Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker>
[2024-04-28 14:06:29 +07:00 INF] Executed DbCommand (90ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT EXISTS (
    SELECT 1 FROM pg_catalog.pg_class c
    JOIN pg_catalog.pg_namespace n ON n.oid=c.relnamespace
    WHERE n.nspname='public' AND
          c.relname='__EFMigrationsHistory'
) <s:Microsoft.EntityFrameworkCore.Database.Command>
[2024-04-28 14:06:29 +07:00 INF] Executed DbCommand (8ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT "MigrationId", "ProductVersion"
FROM "__EFMigrationsHistory"
ORDER BY "MigrationId"; <s:Microsoft.EntityFrameworkCore.Database.Command>
[2024-04-28 14:06:29 +07:00 INF] Executed DbCommand (4ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT EXISTS (
    SELECT 1 FROM pg_catalog.pg_class c
    JOIN pg_catalog.pg_namespace n ON n.oid=c.relnamespace
    WHERE n.nspname='public' AND
          c.relname='__EFMigrationsHistory'
) <s:Microsoft.EntityFrameworkCore.Database.Command>
[2024-04-28 14:06:29 +07:00 INF] Executed DbCommand (1ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT EXISTS (
    SELECT 1 FROM pg_catalog.pg_class c
    JOIN pg_catalog.pg_namespace n ON n.oid=c.relnamespace
    WHERE n.nspname='public' AND
          c.relname='__EFMigrationsHistory'
) <s:Microsoft.EntityFrameworkCore.Database.Command>
[2024-04-28 14:06:29 +07:00 INF] Executed DbCommand (1ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT "MigrationId", "ProductVersion"
FROM "__EFMigrationsHistory"
ORDER BY "MigrationId"; <s:Microsoft.EntityFrameworkCore.Database.Command>
[2024-04-28 14:06:29 +07:00 INF] No migrations were applied. The database is already up to date. <s:Microsoft.EntityFrameworkCore.Migrations>
[2024-04-28 14:06:29 +07:00 INF] User profile is available. Using 'C:\Users\danka\AppData\Local\ASP.NET\DataProtection-Keys' as key repository and Windows DPAPI to encrypt keys at rest. <s:Microsoft.AspNetCore.DataProtection.KeyManagement.XmlKeyManager>
[2024-04-28 14:06:30 +07:00 INF] Executed DbCommand (27ms) [Parameters=[@__normalizedName_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT a."Id", a."ConcurrencyStamp", a."Name", a."NormalizedName", a."RoleType"
FROM "AspNetRoles" AS a
WHERE a."NormalizedName" = @__normalizedName_0
LIMIT 1 <s:Microsoft.EntityFrameworkCore.Database.Command>
[2024-04-28 14:06:30 +07:00 INF] Executed DbCommand (1ms) [Parameters=[@__normalizedName_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT a."Id", a."ConcurrencyStamp", a."Name", a."NormalizedName", a."RoleType"
FROM "AspNetRoles" AS a
WHERE a."NormalizedName" = @__normalizedName_0
LIMIT 1 <s:Microsoft.EntityFrameworkCore.Database.Command>
[2024-04-28 14:06:30 +07:00 INF] Executed DbCommand (5ms) [Parameters=[@__normalizedEmail_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT a."Id", a."AccessFailedCount", a."ConcurrencyStamp", a."Discriminator", a."Email", a."EmailConfirmed", a."FullName", a."JoinedAt", a."LockoutEnabled", a."LockoutEnd", a."NormalizedEmail", a."NormalizedUserName", a."PasswordHash", a."PhoneNumber", a."PhoneNumberConfirmed", a."SecurityStamp", a."TwoFactorEnabled", a."UserName", a."CourseNumber", a."Group"
FROM "AspNetUsers" AS a
WHERE a."NormalizedEmail" = @__normalizedEmail_0
LIMIT 2 <s:Microsoft.EntityFrameworkCore.Database.Command>
[2024-04-28 14:06:30 +07:00 INF] Executed DbCommand (1ms) [Parameters=[@__normalizedEmail_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT a."Id", a."AccessFailedCount", a."ConcurrencyStamp", a."Discriminator", a."Email", a."EmailConfirmed", a."FullName", a."JoinedAt", a."LockoutEnabled", a."LockoutEnd", a."NormalizedEmail", a."NormalizedUserName", a."PasswordHash", a."PhoneNumber", a."PhoneNumberConfirmed", a."SecurityStamp", a."TwoFactorEnabled", a."UserName", a."CourseNumber", a."Group"
FROM "AspNetUsers" AS a
WHERE a."NormalizedEmail" = @__normalizedEmail_0
LIMIT 2 <s:Microsoft.EntityFrameworkCore.Database.Command>
[2024-04-28 14:06:30 +07:00 INF] Executed DbCommand (2ms) [Parameters=[@__normalizedRoleName_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT a."Id", a."ConcurrencyStamp", a."Name", a."NormalizedName", a."RoleType"
FROM "AspNetRoles" AS a
WHERE a."NormalizedName" = @__normalizedRoleName_0
LIMIT 2 <s:Microsoft.EntityFrameworkCore.Database.Command>
[2024-04-28 14:06:30 +07:00 INF] Executed DbCommand (8ms) [Parameters=[@__get_Item_0='?' (DbType = Guid), @__get_Item_1='?' (DbType = Guid)], CommandType='"Text"', CommandTimeout='30']
SELECT a."UserId", a."RoleId"
FROM "AspNetUserRoles" AS a
WHERE a."UserId" = @__get_Item_0 AND a."RoleId" = @__get_Item_1
LIMIT 1 <s:Microsoft.EntityFrameworkCore.Database.Command>
[2024-04-28 14:06:31 +07:00 INF] Now listening on: http://localhost:5105 <s:Microsoft.Hosting.Lifetime>
[2024-04-28 14:06:31 +07:00 INF] Application started. Press Ctrl+C to shut down. <s:Microsoft.Hosting.Lifetime>
[2024-04-28 14:06:31 +07:00 INF] Hosting environment: Development <s:Microsoft.Hosting.Lifetime>
[2024-04-28 14:06:31 +07:00 INF] Content root path: D:\prog\a_projects\back\Internship\Internship-system.API <s:Microsoft.Hosting.Lifetime>
[2024-04-28 14:06:31 +07:00 INF] Request starting HTTP/1.1 GET http://localhost:5105/swagger/index.html - null null <s:Microsoft.AspNetCore.Hosting.Diagnostics>
[2024-04-28 14:06:32 +07:00 INF] Request finished HTTP/1.1 GET http://localhost:5105/swagger/index.html - 200 null text/html;charset=utf-8 266.2168ms <s:Microsoft.AspNetCore.Hosting.Diagnostics>
[2024-04-28 14:06:32 +07:00 INF] Request starting HTTP/1.1 GET http://localhost:5105/swagger/v1/swagger.json - null null <s:Microsoft.AspNetCore.Hosting.Diagnostics>
[2024-04-28 14:06:32 +07:00 INF] Request finished HTTP/1.1 GET http://localhost:5105/swagger/v1/swagger.json - 200 null application/json;charset=utf-8 252.7291ms <s:Microsoft.AspNetCore.Hosting.Diagnostics>
[2024-04-28 14:06:41 +07:00 INF] Request starting HTTP/1.1 POST http://localhost:5105/admin/internship/students - multipart/form-data; boundary=----WebKitFormBoundaryisSLexq1TMu4l98m 5093 <s:Microsoft.AspNetCore.Hosting.Diagnostics>
[2024-04-28 14:06:41 +07:00 WRN] Failed to determine the https port for redirect. <s:Microsoft.AspNetCore.HttpsPolicy.HttpsRedirectionMiddleware>
[2024-04-28 14:06:41 +07:00 INF] CORS policy execution successful. <s:Microsoft.AspNetCore.Cors.Infrastructure.CorsService>
[2024-04-28 14:06:41 +07:00 INF] Executing endpoint 'Internship_system.Controllers.InternshipAdminController.UploadStudents (Internship-system.API)' <s:Microsoft.AspNetCore.Routing.EndpointMiddleware>
[2024-04-28 14:06:41 +07:00 INF] Route matched with {action = "UploadStudents", controller = "InternshipAdmin"}. Executing controller action with signature System.Threading.Tasks.Task UploadStudents(Microsoft.AspNetCore.Http.IFormFile) on controller Internship_system.Controllers.InternshipAdminController (Internship-system.API). <s:Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker>
[2024-04-28 14:06:41 +07:00 INF] Executed action Internship_system.Controllers.InternshipAdminController.UploadStudents (Internship-system.API) in 314.7371ms <s:Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker>
[2024-04-28 14:06:41 +07:00 INF] Executed endpoint 'Internship_system.Controllers.InternshipAdminController.UploadStudents (Internship-system.API)' <s:Microsoft.AspNetCore.Routing.EndpointMiddleware>
[2024-04-28 14:06:41 +07:00 ERR] {"StatusCode":500,"Message":"Something went wrong","TraceId":"00-dc5389f71acf29a06e1b929e01795cdf-6b4201f31739bbca-00"} <s:Internship_system.BLL.Exceptions.ExceptionHandlerMiddleware>
System.IO.IOException: Синтаксическая ошибка в имени файла, имени папки или метке тома. : 'D:\prog\a_projects\back\Internship\D:\prog\a_projects\back\Internship\Internship-system.API\Uploads'
   at System.IO.FileSystem.CreateDirectory(String fullPath, Byte[] securityDescriptor)
   at System.IO.Directory.CreateDirectory(String path)
   at Internship_system.BLL.Services.InternshipAdminService.UploadStudents(IFormFile studentsTable) in D:\prog\a_projects\back\Internship\Internship-system.BLL\Services\InternshipAdminService.cs:line 43
   at Internship_system.Controllers.InternshipAdminController.UploadStudents(IFormFile studentsTable) in D:\prog\a_projects\back\Internship\Internship-system.API\Controllers\InternshipAdminController.cs:line 39
   at Microsoft.AspNetCore.Mvc.Infrastructure.ActionMethodExecutor.TaskResultExecutor.Execute(ActionContext actionContext, IActionResultTypeMapper mapper, ObjectMethodExecutor executor, Object controller, Object[] arguments)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.<InvokeActionMethodAsync>g__Awaited|12_0(ControllerActionInvoker invoker, ValueTask`1 actionResultValueTask)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.<InvokeNextActionFilterAsync>g__Awaited|10_0(ControllerActionInvoker invoker, Task lastTask, State next, Scope scope, Object state, Boolean isCompleted)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.Rethrow(ActionExecutedContextSealed context)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.Next(State& next, Scope& scope, Object& state, Boolean& isCompleted)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.InvokeInnerFilterAsync()
--- End of stack trace from previous location ---
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.<InvokeNextResourceFilter>g__Awaited|25_0(ResourceInvoker invoker, Task lastTask, State next, Scope scope, Object state, Boolean isCompleted)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.Rethrow(ResourceExecutedContextSealed context)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.Next(State& next, Scope& scope, Object& state, Boolean& isCompleted)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.InvokeFilterPipelineAsync()
--- End of stack trace from previous location ---
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.<InvokeAsync>g__Logged|17_1(ResourceInvoker invoker)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.<InvokeAsync>g__Logged|17_1(ResourceInvoker invoker)
   at Microsoft.AspNetCore.Routing.EndpointMiddleware.<Invoke>g__AwaitRequestTask|7_0(Endpoint endpoint, Task requestTask, ILogger logger)
   at Microsoft.AspNetCore.Authentication.AuthenticationMiddleware.Invoke(HttpContext context)
   at Microsoft.AspNetCore.Authorization.AuthorizationMiddleware.Invoke(HttpContext context)
   at Internship_system.BLL.Exceptions.ExceptionHandlerMiddleware.InvokeAsync(HttpContext context) in D:\prog\a_projects\back\Internship\Internship-system.BLL\Exceptions\ExceptionHandlerMiddleware.cs:line 27
[2024-04-28 14:06:41 +07:00 INF] Request finished HTTP/1.1 POST http://localhost:5105/admin/internship/students - 500 null application/json 581.017ms <s:Microsoft.AspNetCore.Hosting.Diagnostics>
[2024-04-28 14:07:10 +07:00 INF] Executed DbCommand (111ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT EXISTS (
    SELECT 1 FROM pg_catalog.pg_class c
    JOIN pg_catalog.pg_namespace n ON n.oid=c.relnamespace
    WHERE n.nspname='public' AND
          c.relname='__EFMigrationsHistory'
) <s:Microsoft.EntityFrameworkCore.Database.Command>
[2024-04-28 14:07:11 +07:00 INF] Executed DbCommand (9ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT "MigrationId", "ProductVersion"
FROM "__EFMigrationsHistory"
ORDER BY "MigrationId"; <s:Microsoft.EntityFrameworkCore.Database.Command>
[2024-04-28 14:07:11 +07:00 INF] Executed DbCommand (4ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT EXISTS (
    SELECT 1 FROM pg_catalog.pg_class c
    JOIN pg_catalog.pg_namespace n ON n.oid=c.relnamespace
    WHERE n.nspname='public' AND
          c.relname='__EFMigrationsHistory'
) <s:Microsoft.EntityFrameworkCore.Database.Command>
[2024-04-28 14:07:11 +07:00 INF] Executed DbCommand (1ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT EXISTS (
    SELECT 1 FROM pg_catalog.pg_class c
    JOIN pg_catalog.pg_namespace n ON n.oid=c.relnamespace
    WHERE n.nspname='public' AND
          c.relname='__EFMigrationsHistory'
) <s:Microsoft.EntityFrameworkCore.Database.Command>
[2024-04-28 14:07:11 +07:00 INF] Executed DbCommand (1ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT "MigrationId", "ProductVersion"
FROM "__EFMigrationsHistory"
ORDER BY "MigrationId"; <s:Microsoft.EntityFrameworkCore.Database.Command>
[2024-04-28 14:07:11 +07:00 INF] No migrations were applied. The database is already up to date. <s:Microsoft.EntityFrameworkCore.Migrations>
[2024-04-28 14:07:11 +07:00 INF] User profile is available. Using 'C:\Users\danka\AppData\Local\ASP.NET\DataProtection-Keys' as key repository and Windows DPAPI to encrypt keys at rest. <s:Microsoft.AspNetCore.DataProtection.KeyManagement.XmlKeyManager>
[2024-04-28 14:07:11 +07:00 INF] Executed DbCommand (15ms) [Parameters=[@__normalizedName_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT a."Id", a."ConcurrencyStamp", a."Name", a."NormalizedName", a."RoleType"
FROM "AspNetRoles" AS a
WHERE a."NormalizedName" = @__normalizedName_0
LIMIT 1 <s:Microsoft.EntityFrameworkCore.Database.Command>
[2024-04-28 14:07:11 +07:00 INF] Executed DbCommand (1ms) [Parameters=[@__normalizedName_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT a."Id", a."ConcurrencyStamp", a."Name", a."NormalizedName", a."RoleType"
FROM "AspNetRoles" AS a
WHERE a."NormalizedName" = @__normalizedName_0
LIMIT 1 <s:Microsoft.EntityFrameworkCore.Database.Command>
[2024-04-28 14:07:11 +07:00 INF] Executed DbCommand (3ms) [Parameters=[@__normalizedEmail_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT a."Id", a."AccessFailedCount", a."ConcurrencyStamp", a."Discriminator", a."Email", a."EmailConfirmed", a."FullName", a."JoinedAt", a."LockoutEnabled", a."LockoutEnd", a."NormalizedEmail", a."NormalizedUserName", a."PasswordHash", a."PhoneNumber", a."PhoneNumberConfirmed", a."SecurityStamp", a."TwoFactorEnabled", a."UserName", a."CourseNumber", a."Group"
FROM "AspNetUsers" AS a
WHERE a."NormalizedEmail" = @__normalizedEmail_0
LIMIT 2 <s:Microsoft.EntityFrameworkCore.Database.Command>
[2024-04-28 14:07:11 +07:00 INF] Executed DbCommand (1ms) [Parameters=[@__normalizedEmail_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT a."Id", a."AccessFailedCount", a."ConcurrencyStamp", a."Discriminator", a."Email", a."EmailConfirmed", a."FullName", a."JoinedAt", a."LockoutEnabled", a."LockoutEnd", a."NormalizedEmail", a."NormalizedUserName", a."PasswordHash", a."PhoneNumber", a."PhoneNumberConfirmed", a."SecurityStamp", a."TwoFactorEnabled", a."UserName", a."CourseNumber", a."Group"
FROM "AspNetUsers" AS a
WHERE a."NormalizedEmail" = @__normalizedEmail_0
LIMIT 2 <s:Microsoft.EntityFrameworkCore.Database.Command>
[2024-04-28 14:07:11 +07:00 INF] Executed DbCommand (1ms) [Parameters=[@__normalizedRoleName_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT a."Id", a."ConcurrencyStamp", a."Name", a."NormalizedName", a."RoleType"
FROM "AspNetRoles" AS a
WHERE a."NormalizedName" = @__normalizedRoleName_0
LIMIT 2 <s:Microsoft.EntityFrameworkCore.Database.Command>
[2024-04-28 14:07:12 +07:00 INF] Executed DbCommand (4ms) [Parameters=[@__get_Item_0='?' (DbType = Guid), @__get_Item_1='?' (DbType = Guid)], CommandType='"Text"', CommandTimeout='30']
SELECT a."UserId", a."RoleId"
FROM "AspNetUserRoles" AS a
WHERE a."UserId" = @__get_Item_0 AND a."RoleId" = @__get_Item_1
LIMIT 1 <s:Microsoft.EntityFrameworkCore.Database.Command>
[2024-04-28 14:07:12 +07:00 INF] Now listening on: http://localhost:5105 <s:Microsoft.Hosting.Lifetime>
[2024-04-28 14:07:12 +07:00 INF] Application started. Press Ctrl+C to shut down. <s:Microsoft.Hosting.Lifetime>
[2024-04-28 14:07:12 +07:00 INF] Hosting environment: Development <s:Microsoft.Hosting.Lifetime>
[2024-04-28 14:07:12 +07:00 INF] Content root path: D:\prog\a_projects\back\Internship\Internship-system.API <s:Microsoft.Hosting.Lifetime>
[2024-04-28 14:07:12 +07:00 INF] Request starting HTTP/1.1 GET http://localhost:5105/swagger/index.html - null null <s:Microsoft.AspNetCore.Hosting.Diagnostics>
[2024-04-28 14:07:12 +07:00 INF] Request finished HTTP/1.1 GET http://localhost:5105/swagger/index.html - 200 null text/html;charset=utf-8 215.1195ms <s:Microsoft.AspNetCore.Hosting.Diagnostics>
[2024-04-28 14:07:13 +07:00 INF] Request starting HTTP/1.1 GET http://localhost:5105/swagger/v1/swagger.json - null null <s:Microsoft.AspNetCore.Hosting.Diagnostics>
[2024-04-28 14:07:13 +07:00 INF] Request finished HTTP/1.1 GET http://localhost:5105/swagger/v1/swagger.json - 200 null application/json;charset=utf-8 231.6122ms <s:Microsoft.AspNetCore.Hosting.Diagnostics>
[2024-04-28 14:07:14 +07:00 INF] Request starting HTTP/1.1 POST http://localhost:5105/admin/internship/students - multipart/form-data; boundary=----WebKitFormBoundaryV82Ct3HBSj5VAQWg 5093 <s:Microsoft.AspNetCore.Hosting.Diagnostics>
[2024-04-28 14:07:14 +07:00 WRN] Failed to determine the https port for redirect. <s:Microsoft.AspNetCore.HttpsPolicy.HttpsRedirectionMiddleware>
[2024-04-28 14:07:14 +07:00 INF] CORS policy execution successful. <s:Microsoft.AspNetCore.Cors.Infrastructure.CorsService>
[2024-04-28 14:07:14 +07:00 INF] Executing endpoint 'Internship_system.Controllers.InternshipAdminController.UploadStudents (Internship-system.API)' <s:Microsoft.AspNetCore.Routing.EndpointMiddleware>
[2024-04-28 14:07:14 +07:00 INF] Route matched with {action = "UploadStudents", controller = "InternshipAdmin"}. Executing controller action with signature System.Threading.Tasks.Task UploadStudents(Microsoft.AspNetCore.Http.IFormFile) on controller Internship_system.Controllers.InternshipAdminController (Internship-system.API). <s:Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker>
[2024-04-28 14:07:15 +07:00 INF] Executed action Internship_system.Controllers.InternshipAdminController.UploadStudents (Internship-system.API) in 153.5957ms <s:Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker>
[2024-04-28 14:07:15 +07:00 INF] Executed endpoint 'Internship_system.Controllers.InternshipAdminController.UploadStudents (Internship-system.API)' <s:Microsoft.AspNetCore.Routing.EndpointMiddleware>
[2024-04-28 14:07:15 +07:00 ERR] {"StatusCode":500,"Message":"Something went wrong","TraceId":"00-e6a1a7709b076684eec8826a0a9803f7-465eadec92e91158-00"} <s:Internship_system.BLL.Exceptions.ExceptionHandlerMiddleware>
System.NotSupportedException: No data is available for encoding 1252. For information on defining a custom encoding, see the documentation for the Encoding.RegisterProvider method.
   at System.Text.Encoding.GetEncoding(Int32 codepage)
   at ExcelDataReader.ExcelReaderConfiguration..ctor()
   at ExcelDataReader.ExcelReaderFactory.CreateReader(Stream fileStream, ExcelReaderConfiguration configuration)
   at Internship_system.BLL.Services.InternshipAdminService.UploadStudents(IFormFile studentsTable) in D:\prog\a_projects\back\Internship\Internship-system.BLL\Services\InternshipAdminService.cs:line 56
   at Internship_system.Controllers.InternshipAdminController.UploadStudents(IFormFile studentsTable) in D:\prog\a_projects\back\Internship\Internship-system.API\Controllers\InternshipAdminController.cs:line 39
   at Microsoft.AspNetCore.Mvc.Infrastructure.ActionMethodExecutor.TaskResultExecutor.Execute(ActionContext actionContext, IActionResultTypeMapper mapper, ObjectMethodExecutor executor, Object controller, Object[] arguments)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.<InvokeActionMethodAsync>g__Awaited|12_0(ControllerActionInvoker invoker, ValueTask`1 actionResultValueTask)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.<InvokeNextActionFilterAsync>g__Awaited|10_0(ControllerActionInvoker invoker, Task lastTask, State next, Scope scope, Object state, Boolean isCompleted)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.Rethrow(ActionExecutedContextSealed context)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.Next(State& next, Scope& scope, Object& state, Boolean& isCompleted)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.<InvokeInnerFilterAsync>g__Awaited|13_0(ControllerActionInvoker invoker, Task lastTask, State next, Scope scope, Object state, Boolean isCompleted)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.<InvokeNextResourceFilter>g__Awaited|25_0(ResourceInvoker invoker, Task lastTask, State next, Scope scope, Object state, Boolean isCompleted)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.Rethrow(ResourceExecutedContextSealed context)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.Next(State& next, Scope& scope, Object& state, Boolean& isCompleted)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.<InvokeFilterPipelineAsync>g__Awaited|20_0(ResourceInvoker invoker, Task lastTask, State next, Scope scope, Object state, Boolean isCompleted)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.<InvokeAsync>g__Logged|17_1(ResourceInvoker invoker)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.<InvokeAsync>g__Logged|17_1(ResourceInvoker invoker)
   at Microsoft.AspNetCore.Routing.EndpointMiddleware.<Invoke>g__AwaitRequestTask|7_0(Endpoint endpoint, Task requestTask, ILogger logger)
   at Microsoft.AspNetCore.Authentication.AuthenticationMiddleware.Invoke(HttpContext context)
   at Microsoft.AspNetCore.Authorization.AuthorizationMiddleware.Invoke(HttpContext context)
   at Internship_system.BLL.Exceptions.ExceptionHandlerMiddleware.InvokeAsync(HttpContext context) in D:\prog\a_projects\back\Internship\Internship-system.BLL\Exceptions\ExceptionHandlerMiddleware.cs:line 27
[2024-04-28 14:07:15 +07:00 INF] Request finished HTTP/1.1 POST http://localhost:5105/admin/internship/students - 500 null application/json 301.3171ms <s:Microsoft.AspNetCore.Hosting.Diagnostics>
[2024-04-28 14:07:32 +07:00 INF] Request starting HTTP/1.1 POST http://localhost:5105/admin/internship/students - multipart/form-data; boundary=----WebKitFormBoundaryqXQTeASPwRwhXC4X 5093 <s:Microsoft.AspNetCore.Hosting.Diagnostics>
[2024-04-28 14:07:32 +07:00 INF] CORS policy execution successful. <s:Microsoft.AspNetCore.Cors.Infrastructure.CorsService>
[2024-04-28 14:07:32 +07:00 INF] Executing endpoint 'Internship_system.Controllers.InternshipAdminController.UploadStudents (Internship-system.API)' <s:Microsoft.AspNetCore.Routing.EndpointMiddleware>
[2024-04-28 14:07:32 +07:00 INF] Route matched with {action = "UploadStudents", controller = "InternshipAdmin"}. Executing controller action with signature System.Threading.Tasks.Task UploadStudents(Microsoft.AspNetCore.Http.IFormFile) on controller Internship_system.Controllers.InternshipAdminController (Internship-system.API). <s:Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker>
[2024-04-28 14:08:31 +07:00 INF] Executed action Internship_system.Controllers.InternshipAdminController.UploadStudents (Internship-system.API) in 58438.4825ms <s:Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker>
[2024-04-28 14:08:31 +07:00 INF] Executed endpoint 'Internship_system.Controllers.InternshipAdminController.UploadStudents (Internship-system.API)' <s:Microsoft.AspNetCore.Routing.EndpointMiddleware>
[2024-04-28 14:08:31 +07:00 ERR] {"StatusCode":500,"Message":"Something went wrong","TraceId":"00-55ec899b928609688fdd959e0b77a25f-64eee68525139d5d-00"} <s:Internship_system.BLL.Exceptions.ExceptionHandlerMiddleware>
System.NotSupportedException: No data is available for encoding 1252. For information on defining a custom encoding, see the documentation for the Encoding.RegisterProvider method.
   at System.Text.Encoding.GetEncoding(Int32 codepage)
   at ExcelDataReader.ExcelReaderConfiguration..ctor()
   at ExcelDataReader.ExcelReaderFactory.CreateReader(Stream fileStream, ExcelReaderConfiguration configuration)
   at Internship_system.BLL.Services.InternshipAdminService.UploadStudents(IFormFile studentsTable) in D:\prog\a_projects\back\Internship\Internship-system.BLL\Services\InternshipAdminService.cs:line 56
   at Internship_system.Controllers.InternshipAdminController.UploadStudents(IFormFile studentsTable) in D:\prog\a_projects\back\Internship\Internship-system.API\Controllers\InternshipAdminController.cs:line 39
   at Microsoft.AspNetCore.Mvc.Infrastructure.ActionMethodExecutor.TaskResultExecutor.Execute(ActionContext actionContext, IActionResultTypeMapper mapper, ObjectMethodExecutor executor, Object controller, Object[] arguments)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.<InvokeActionMethodAsync>g__Awaited|12_0(ControllerActionInvoker invoker, ValueTask`1 actionResultValueTask)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.<InvokeNextActionFilterAsync>g__Awaited|10_0(ControllerActionInvoker invoker, Task lastTask, State next, Scope scope, Object state, Boolean isCompleted)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.Rethrow(ActionExecutedContextSealed context)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.Next(State& next, Scope& scope, Object& state, Boolean& isCompleted)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.InvokeInnerFilterAsync()
--- End of stack trace from previous location ---
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.<InvokeNextResourceFilter>g__Awaited|25_0(ResourceInvoker invoker, Task lastTask, State next, Scope scope, Object state, Boolean isCompleted)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.Rethrow(ResourceExecutedContextSealed context)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.Next(State& next, Scope& scope, Object& state, Boolean& isCompleted)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.InvokeFilterPipelineAsync()
--- End of stack trace from previous location ---
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.<InvokeAsync>g__Logged|17_1(ResourceInvoker invoker)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.<InvokeAsync>g__Logged|17_1(ResourceInvoker invoker)
   at Microsoft.AspNetCore.Routing.EndpointMiddleware.<Invoke>g__AwaitRequestTask|7_0(Endpoint endpoint, Task requestTask, ILogger logger)
   at Microsoft.AspNetCore.Authentication.AuthenticationMiddleware.Invoke(HttpContext context)
   at Microsoft.AspNetCore.Authorization.AuthorizationMiddleware.Invoke(HttpContext context)
   at Internship_system.BLL.Exceptions.ExceptionHandlerMiddleware.InvokeAsync(HttpContext context) in D:\prog\a_projects\back\Internship\Internship-system.BLL\Exceptions\ExceptionHandlerMiddleware.cs:line 27
[2024-04-28 14:08:31 +07:00 INF] Request finished HTTP/1.1 POST http://localhost:5105/admin/internship/students - 500 null application/json 58462.8991ms <s:Microsoft.AspNetCore.Hosting.Diagnostics>
[2024-04-28 14:08:45 +07:00 INF] Request starting HTTP/1.1 POST http://localhost:5105/admin/internship/students - multipart/form-data; boundary=----WebKitFormBoundaryeC2yToUeUNLVBVrX 5093 <s:Microsoft.AspNetCore.Hosting.Diagnostics>
[2024-04-28 14:08:45 +07:00 INF] CORS policy execution successful. <s:Microsoft.AspNetCore.Cors.Infrastructure.CorsService>
[2024-04-28 14:08:45 +07:00 INF] Executing endpoint 'Internship_system.Controllers.InternshipAdminController.UploadStudents (Internship-system.API)' <s:Microsoft.AspNetCore.Routing.EndpointMiddleware>
[2024-04-28 14:08:45 +07:00 INF] Route matched with {action = "UploadStudents", controller = "InternshipAdmin"}. Executing controller action with signature System.Threading.Tasks.Task UploadStudents(Microsoft.AspNetCore.Http.IFormFile) on controller Internship_system.Controllers.InternshipAdminController (Internship-system.API). <s:Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker>
[2024-04-28 14:09:17 +07:00 INF] Executed action Internship_system.Controllers.InternshipAdminController.UploadStudents (Internship-system.API) in 31515.3736ms <s:Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker>
[2024-04-28 14:09:17 +07:00 INF] Executed endpoint 'Internship_system.Controllers.InternshipAdminController.UploadStudents (Internship-system.API)' <s:Microsoft.AspNetCore.Routing.EndpointMiddleware>
[2024-04-28 14:09:17 +07:00 ERR] {"StatusCode":500,"Message":"Something went wrong","TraceId":"00-1bdf4b06c27f61a8aaf8d024ab39d902-f95d2124da6ebb2e-00"} <s:Internship_system.BLL.Exceptions.ExceptionHandlerMiddleware>
System.NotSupportedException: No data is available for encoding 1252. For information on defining a custom encoding, see the documentation for the Encoding.RegisterProvider method.
   at System.Text.Encoding.GetEncoding(Int32 codepage)
   at ExcelDataReader.ExcelReaderConfiguration..ctor()
   at ExcelDataReader.ExcelReaderFactory.CreateReader(Stream fileStream, ExcelReaderConfiguration configuration)
   at Internship_system.BLL.Services.InternshipAdminService.UploadStudents(IFormFile studentsTable) in D:\prog\a_projects\back\Internship\Internship-system.BLL\Services\InternshipAdminService.cs:line 56
   at Internship_system.Controllers.InternshipAdminController.UploadStudents(IFormFile studentsTable) in D:\prog\a_projects\back\Internship\Internship-system.API\Controllers\InternshipAdminController.cs:line 39
   at Microsoft.AspNetCore.Mvc.Infrastructure.ActionMethodExecutor.TaskResultExecutor.Execute(ActionContext actionContext, IActionResultTypeMapper mapper, ObjectMethodExecutor executor, Object controller, Object[] arguments)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.<InvokeActionMethodAsync>g__Awaited|12_0(ControllerActionInvoker invoker, ValueTask`1 actionResultValueTask)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.<InvokeNextActionFilterAsync>g__Awaited|10_0(ControllerActionInvoker invoker, Task lastTask, State next, Scope scope, Object state, Boolean isCompleted)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.Rethrow(ActionExecutedContextSealed context)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.Next(State& next, Scope& scope, Object& state, Boolean& isCompleted)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.<InvokeInnerFilterAsync>g__Awaited|13_0(ControllerActionInvoker invoker, Task lastTask, State next, Scope scope, Object state, Boolean isCompleted)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.<InvokeNextResourceFilter>g__Awaited|25_0(ResourceInvoker invoker, Task lastTask, State next, Scope scope, Object state, Boolean isCompleted)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.Rethrow(ResourceExecutedContextSealed context)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.Next(State& next, Scope& scope, Object& state, Boolean& isCompleted)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.<InvokeFilterPipelineAsync>g__Awaited|20_0(ResourceInvoker invoker, Task lastTask, State next, Scope scope, Object state, Boolean isCompleted)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.<InvokeAsync>g__Logged|17_1(ResourceInvoker invoker)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.<InvokeAsync>g__Logged|17_1(ResourceInvoker invoker)
   at Microsoft.AspNetCore.Routing.EndpointMiddleware.<Invoke>g__AwaitRequestTask|7_0(Endpoint endpoint, Task requestTask, ILogger logger)
   at Microsoft.AspNetCore.Authentication.AuthenticationMiddleware.Invoke(HttpContext context)
   at Microsoft.AspNetCore.Authorization.AuthorizationMiddleware.Invoke(HttpContext context)
   at Internship_system.BLL.Exceptions.ExceptionHandlerMiddleware.InvokeAsync(HttpContext context) in D:\prog\a_projects\back\Internship\Internship-system.BLL\Exceptions\ExceptionHandlerMiddleware.cs:line 27
[2024-04-28 14:09:17 +07:00 INF] Request finished HTTP/1.1 POST http://localhost:5105/admin/internship/students - 500 null application/json 31562.2897ms <s:Microsoft.AspNetCore.Hosting.Diagnostics>
[2024-04-28 14:09:59 +07:00 INF] Request starting HTTP/1.1 POST http://localhost:5105/admin/internship/students - multipart/form-data; boundary=----WebKitFormBoundarymLbxbxeZPKteFcGA 5077 <s:Microsoft.AspNetCore.Hosting.Diagnostics>
[2024-04-28 14:09:59 +07:00 INF] CORS policy execution successful. <s:Microsoft.AspNetCore.Cors.Infrastructure.CorsService>
[2024-04-28 14:09:59 +07:00 INF] Executing endpoint 'Internship_system.Controllers.InternshipAdminController.UploadStudents (Internship-system.API)' <s:Microsoft.AspNetCore.Routing.EndpointMiddleware>
[2024-04-28 14:09:59 +07:00 INF] Route matched with {action = "UploadStudents", controller = "InternshipAdmin"}. Executing controller action with signature System.Threading.Tasks.Task UploadStudents(Microsoft.AspNetCore.Http.IFormFile) on controller Internship_system.Controllers.InternshipAdminController (Internship-system.API). <s:Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker>
[2024-04-28 14:10:26 +07:00 INF] Executed action Internship_system.Controllers.InternshipAdminController.UploadStudents (Internship-system.API) in 26911.5885ms <s:Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker>
[2024-04-28 14:10:26 +07:00 INF] Executed endpoint 'Internship_system.Controllers.InternshipAdminController.UploadStudents (Internship-system.API)' <s:Microsoft.AspNetCore.Routing.EndpointMiddleware>
[2024-04-28 14:10:26 +07:00 ERR] {"StatusCode":500,"Message":"Something went wrong","TraceId":"00-aa25ac1fb0f722f4612276e78e0bad46-6fa709c87222a5a9-00"} <s:Internship_system.BLL.Exceptions.ExceptionHandlerMiddleware>
System.NotSupportedException: No data is available for encoding 1252. For information on defining a custom encoding, see the documentation for the Encoding.RegisterProvider method.
   at System.Text.Encoding.GetEncoding(Int32 codepage)
   at ExcelDataReader.ExcelReaderConfiguration..ctor()
   at ExcelDataReader.ExcelReaderFactory.CreateReader(Stream fileStream, ExcelReaderConfiguration configuration)
   at Internship_system.BLL.Services.InternshipAdminService.UploadStudents(IFormFile studentsTable) in D:\prog\a_projects\back\Internship\Internship-system.BLL\Services\InternshipAdminService.cs:line 56
   at Internship_system.Controllers.InternshipAdminController.UploadStudents(IFormFile studentsTable) in D:\prog\a_projects\back\Internship\Internship-system.API\Controllers\InternshipAdminController.cs:line 39
   at Microsoft.AspNetCore.Mvc.Infrastructure.ActionMethodExecutor.TaskResultExecutor.Execute(ActionContext actionContext, IActionResultTypeMapper mapper, ObjectMethodExecutor executor, Object controller, Object[] arguments)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.<InvokeActionMethodAsync>g__Awaited|12_0(ControllerActionInvoker invoker, ValueTask`1 actionResultValueTask)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.<InvokeNextActionFilterAsync>g__Awaited|10_0(ControllerActionInvoker invoker, Task lastTask, State next, Scope scope, Object state, Boolean isCompleted)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.Rethrow(ActionExecutedContextSealed context)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.Next(State& next, Scope& scope, Object& state, Boolean& isCompleted)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.<InvokeInnerFilterAsync>g__Awaited|13_0(ControllerActionInvoker invoker, Task lastTask, State next, Scope scope, Object state, Boolean isCompleted)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.<InvokeNextResourceFilter>g__Awaited|25_0(ResourceInvoker invoker, Task lastTask, State next, Scope scope, Object state, Boolean isCompleted)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.Rethrow(ResourceExecutedContextSealed context)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.Next(State& next, Scope& scope, Object& state, Boolean& isCompleted)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.<InvokeFilterPipelineAsync>g__Awaited|20_0(ResourceInvoker invoker, Task lastTask, State next, Scope scope, Object state, Boolean isCompleted)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.<InvokeAsync>g__Logged|17_1(ResourceInvoker invoker)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.<InvokeAsync>g__Logged|17_1(ResourceInvoker invoker)
   at Microsoft.AspNetCore.Routing.EndpointMiddleware.<Invoke>g__AwaitRequestTask|7_0(Endpoint endpoint, Task requestTask, ILogger logger)
   at Microsoft.AspNetCore.Authentication.AuthenticationMiddleware.Invoke(HttpContext context)
   at Microsoft.AspNetCore.Authorization.AuthorizationMiddleware.Invoke(HttpContext context)
   at Internship_system.BLL.Exceptions.ExceptionHandlerMiddleware.InvokeAsync(HttpContext context) in D:\prog\a_projects\back\Internship\Internship-system.BLL\Exceptions\ExceptionHandlerMiddleware.cs:line 27
[2024-04-28 14:10:26 +07:00 INF] Request finished HTTP/1.1 POST http://localhost:5105/admin/internship/students - 500 null application/json 26960.1158ms <s:Microsoft.AspNetCore.Hosting.Diagnostics>
[2024-04-28 14:10:52 +07:00 INF] Executed DbCommand (94ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT EXISTS (
    SELECT 1 FROM pg_catalog.pg_class c
    JOIN pg_catalog.pg_namespace n ON n.oid=c.relnamespace
    WHERE n.nspname='public' AND
          c.relname='__EFMigrationsHistory'
) <s:Microsoft.EntityFrameworkCore.Database.Command>
[2024-04-28 14:10:52 +07:00 INF] Executed DbCommand (14ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT "MigrationId", "ProductVersion"
FROM "__EFMigrationsHistory"
ORDER BY "MigrationId"; <s:Microsoft.EntityFrameworkCore.Database.Command>
[2024-04-28 14:10:52 +07:00 INF] Executed DbCommand (3ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT EXISTS (
    SELECT 1 FROM pg_catalog.pg_class c
    JOIN pg_catalog.pg_namespace n ON n.oid=c.relnamespace
    WHERE n.nspname='public' AND
          c.relname='__EFMigrationsHistory'
) <s:Microsoft.EntityFrameworkCore.Database.Command>
[2024-04-28 14:10:52 +07:00 INF] Executed DbCommand (1ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT EXISTS (
    SELECT 1 FROM pg_catalog.pg_class c
    JOIN pg_catalog.pg_namespace n ON n.oid=c.relnamespace
    WHERE n.nspname='public' AND
          c.relname='__EFMigrationsHistory'
) <s:Microsoft.EntityFrameworkCore.Database.Command>
[2024-04-28 14:10:52 +07:00 INF] Executed DbCommand (1ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT "MigrationId", "ProductVersion"
FROM "__EFMigrationsHistory"
ORDER BY "MigrationId"; <s:Microsoft.EntityFrameworkCore.Database.Command>
[2024-04-28 14:10:52 +07:00 INF] No migrations were applied. The database is already up to date. <s:Microsoft.EntityFrameworkCore.Migrations>
[2024-04-28 14:10:52 +07:00 INF] User profile is available. Using 'C:\Users\danka\AppData\Local\ASP.NET\DataProtection-Keys' as key repository and Windows DPAPI to encrypt keys at rest. <s:Microsoft.AspNetCore.DataProtection.KeyManagement.XmlKeyManager>
[2024-04-28 14:10:52 +07:00 INF] Executed DbCommand (13ms) [Parameters=[@__normalizedName_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT a."Id", a."ConcurrencyStamp", a."Name", a."NormalizedName", a."RoleType"
FROM "AspNetRoles" AS a
WHERE a."NormalizedName" = @__normalizedName_0
LIMIT 1 <s:Microsoft.EntityFrameworkCore.Database.Command>
[2024-04-28 14:10:53 +07:00 INF] Executed DbCommand (1ms) [Parameters=[@__normalizedName_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT a."Id", a."ConcurrencyStamp", a."Name", a."NormalizedName", a."RoleType"
FROM "AspNetRoles" AS a
WHERE a."NormalizedName" = @__normalizedName_0
LIMIT 1 <s:Microsoft.EntityFrameworkCore.Database.Command>
[2024-04-28 14:10:53 +07:00 INF] Executed DbCommand (3ms) [Parameters=[@__normalizedEmail_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT a."Id", a."AccessFailedCount", a."ConcurrencyStamp", a."Discriminator", a."Email", a."EmailConfirmed", a."FullName", a."JoinedAt", a."LockoutEnabled", a."LockoutEnd", a."NormalizedEmail", a."NormalizedUserName", a."PasswordHash", a."PhoneNumber", a."PhoneNumberConfirmed", a."SecurityStamp", a."TwoFactorEnabled", a."UserName", a."CourseNumber", a."Group"
FROM "AspNetUsers" AS a
WHERE a."NormalizedEmail" = @__normalizedEmail_0
LIMIT 2 <s:Microsoft.EntityFrameworkCore.Database.Command>
[2024-04-28 14:10:53 +07:00 INF] Executed DbCommand (1ms) [Parameters=[@__normalizedEmail_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT a."Id", a."AccessFailedCount", a."ConcurrencyStamp", a."Discriminator", a."Email", a."EmailConfirmed", a."FullName", a."JoinedAt", a."LockoutEnabled", a."LockoutEnd", a."NormalizedEmail", a."NormalizedUserName", a."PasswordHash", a."PhoneNumber", a."PhoneNumberConfirmed", a."SecurityStamp", a."TwoFactorEnabled", a."UserName", a."CourseNumber", a."Group"
FROM "AspNetUsers" AS a
WHERE a."NormalizedEmail" = @__normalizedEmail_0
LIMIT 2 <s:Microsoft.EntityFrameworkCore.Database.Command>
[2024-04-28 14:10:53 +07:00 INF] Executed DbCommand (3ms) [Parameters=[@__normalizedRoleName_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT a."Id", a."ConcurrencyStamp", a."Name", a."NormalizedName", a."RoleType"
FROM "AspNetRoles" AS a
WHERE a."NormalizedName" = @__normalizedRoleName_0
LIMIT 2 <s:Microsoft.EntityFrameworkCore.Database.Command>
[2024-04-28 14:10:53 +07:00 INF] Executed DbCommand (3ms) [Parameters=[@__get_Item_0='?' (DbType = Guid), @__get_Item_1='?' (DbType = Guid)], CommandType='"Text"', CommandTimeout='30']
SELECT a."UserId", a."RoleId"
FROM "AspNetUserRoles" AS a
WHERE a."UserId" = @__get_Item_0 AND a."RoleId" = @__get_Item_1
LIMIT 1 <s:Microsoft.EntityFrameworkCore.Database.Command>
[2024-04-28 14:10:53 +07:00 INF] Now listening on: http://localhost:5105 <s:Microsoft.Hosting.Lifetime>
[2024-04-28 14:10:53 +07:00 INF] Application started. Press Ctrl+C to shut down. <s:Microsoft.Hosting.Lifetime>
[2024-04-28 14:10:53 +07:00 INF] Hosting environment: Development <s:Microsoft.Hosting.Lifetime>
[2024-04-28 14:10:53 +07:00 INF] Content root path: D:\prog\a_projects\back\Internship\Internship-system.API <s:Microsoft.Hosting.Lifetime>
[2024-04-28 14:10:53 +07:00 INF] Request starting HTTP/1.1 GET http://localhost:5105/swagger/index.html - null null <s:Microsoft.AspNetCore.Hosting.Diagnostics>
[2024-04-28 14:10:54 +07:00 INF] Request finished HTTP/1.1 GET http://localhost:5105/swagger/index.html - 200 null text/html;charset=utf-8 215.0995ms <s:Microsoft.AspNetCore.Hosting.Diagnostics>
[2024-04-28 14:10:54 +07:00 INF] Request starting HTTP/1.1 GET http://localhost:5105/swagger/v1/swagger.json - null null <s:Microsoft.AspNetCore.Hosting.Diagnostics>
[2024-04-28 14:10:54 +07:00 INF] Request finished HTTP/1.1 GET http://localhost:5105/swagger/v1/swagger.json - 200 null application/json;charset=utf-8 289.8765ms <s:Microsoft.AspNetCore.Hosting.Diagnostics>
[2024-04-28 14:11:06 +07:00 INF] Request starting HTTP/1.1 POST http://localhost:5105/admin/internship/students - multipart/form-data; boundary=----WebKitFormBoundaryJvFcnMw3ABeiNIWr 5077 <s:Microsoft.AspNetCore.Hosting.Diagnostics>
[2024-04-28 14:11:06 +07:00 WRN] Failed to determine the https port for redirect. <s:Microsoft.AspNetCore.HttpsPolicy.HttpsRedirectionMiddleware>
[2024-04-28 14:11:06 +07:00 INF] CORS policy execution successful. <s:Microsoft.AspNetCore.Cors.Infrastructure.CorsService>
[2024-04-28 14:11:06 +07:00 INF] Executing endpoint 'Internship_system.Controllers.InternshipAdminController.UploadStudents (Internship-system.API)' <s:Microsoft.AspNetCore.Routing.EndpointMiddleware>
[2024-04-28 14:11:06 +07:00 INF] Route matched with {action = "UploadStudents", controller = "InternshipAdmin"}. Executing controller action with signature System.Threading.Tasks.Task UploadStudents(Microsoft.AspNetCore.Http.IFormFile) on controller Internship_system.Controllers.InternshipAdminController (Internship-system.API). <s:Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker>
[2024-04-28 14:11:06 +07:00 INF] Executed action Internship_system.Controllers.InternshipAdminController.UploadStudents (Internship-system.API) in 135.9268ms <s:Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker>
[2024-04-28 14:11:06 +07:00 INF] Executed endpoint 'Internship_system.Controllers.InternshipAdminController.UploadStudents (Internship-system.API)' <s:Microsoft.AspNetCore.Routing.EndpointMiddleware>
[2024-04-28 14:11:06 +07:00 ERR] {"StatusCode":500,"Message":"Something went wrong","TraceId":"00-918429c538549a2ad2f3f4308e800985-7710e5d7227fde2e-00"} <s:Internship_system.BLL.Exceptions.ExceptionHandlerMiddleware>
System.NotSupportedException: No data is available for encoding 1252. For information on defining a custom encoding, see the documentation for the Encoding.RegisterProvider method.
   at System.Text.Encoding.GetEncoding(Int32 codepage)
   at ExcelDataReader.ExcelReaderConfiguration..ctor()
   at ExcelDataReader.ExcelReaderFactory.CreateReader(Stream fileStream, ExcelReaderConfiguration configuration)
   at Internship_system.BLL.Services.InternshipAdminService.UploadStudents(IFormFile studentsTable) in D:\prog\a_projects\back\Internship\Internship-system.BLL\Services\InternshipAdminService.cs:line 56
   at Internship_system.Controllers.InternshipAdminController.UploadStudents(IFormFile studentsTable) in D:\prog\a_projects\back\Internship\Internship-system.API\Controllers\InternshipAdminController.cs:line 39
   at Microsoft.AspNetCore.Mvc.Infrastructure.ActionMethodExecutor.TaskResultExecutor.Execute(ActionContext actionContext, IActionResultTypeMapper mapper, ObjectMethodExecutor executor, Object controller, Object[] arguments)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.<InvokeActionMethodAsync>g__Awaited|12_0(ControllerActionInvoker invoker, ValueTask`1 actionResultValueTask)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.<InvokeNextActionFilterAsync>g__Awaited|10_0(ControllerActionInvoker invoker, Task lastTask, State next, Scope scope, Object state, Boolean isCompleted)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.Rethrow(ActionExecutedContextSealed context)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.Next(State& next, Scope& scope, Object& state, Boolean& isCompleted)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.<InvokeInnerFilterAsync>g__Awaited|13_0(ControllerActionInvoker invoker, Task lastTask, State next, Scope scope, Object state, Boolean isCompleted)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.<InvokeNextResourceFilter>g__Awaited|25_0(ResourceInvoker invoker, Task lastTask, State next, Scope scope, Object state, Boolean isCompleted)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.Rethrow(ResourceExecutedContextSealed context)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.Next(State& next, Scope& scope, Object& state, Boolean& isCompleted)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.<InvokeFilterPipelineAsync>g__Awaited|20_0(ResourceInvoker invoker, Task lastTask, State next, Scope scope, Object state, Boolean isCompleted)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.<InvokeAsync>g__Logged|17_1(ResourceInvoker invoker)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.<InvokeAsync>g__Logged|17_1(ResourceInvoker invoker)
   at Microsoft.AspNetCore.Routing.EndpointMiddleware.<Invoke>g__AwaitRequestTask|7_0(Endpoint endpoint, Task requestTask, ILogger logger)
   at Microsoft.AspNetCore.Authentication.AuthenticationMiddleware.Invoke(HttpContext context)
   at Microsoft.AspNetCore.Authorization.AuthorizationMiddleware.Invoke(HttpContext context)
   at Internship_system.BLL.Exceptions.ExceptionHandlerMiddleware.InvokeAsync(HttpContext context) in D:\prog\a_projects\back\Internship\Internship-system.BLL\Exceptions\ExceptionHandlerMiddleware.cs:line 27
[2024-04-28 14:11:06 +07:00 INF] Request finished HTTP/1.1 POST http://localhost:5105/admin/internship/students - 500 null application/json 247.5533ms <s:Microsoft.AspNetCore.Hosting.Diagnostics>
[2024-04-28 14:11:17 +07:00 INF] Request starting HTTP/1.1 POST http://localhost:5105/admin/internship/students - multipart/form-data; boundary=----WebKitFormBoundaryYOAYog08KFpftJ1z 5077 <s:Microsoft.AspNetCore.Hosting.Diagnostics>
[2024-04-28 14:11:17 +07:00 INF] CORS policy execution successful. <s:Microsoft.AspNetCore.Cors.Infrastructure.CorsService>
[2024-04-28 14:11:17 +07:00 INF] Executing endpoint 'Internship_system.Controllers.InternshipAdminController.UploadStudents (Internship-system.API)' <s:Microsoft.AspNetCore.Routing.EndpointMiddleware>
[2024-04-28 14:11:17 +07:00 INF] Route matched with {action = "UploadStudents", controller = "InternshipAdmin"}. Executing controller action with signature System.Threading.Tasks.Task UploadStudents(Microsoft.AspNetCore.Http.IFormFile) on controller Internship_system.Controllers.InternshipAdminController (Internship-system.API). <s:Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker>
[2024-04-28 14:12:30 +07:00 INF] Executed action Internship_system.Controllers.InternshipAdminController.UploadStudents (Internship-system.API) in 73743.6581ms <s:Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker>
[2024-04-28 14:12:30 +07:00 INF] Executed endpoint 'Internship_system.Controllers.InternshipAdminController.UploadStudents (Internship-system.API)' <s:Microsoft.AspNetCore.Routing.EndpointMiddleware>
[2024-04-28 14:12:30 +07:00 ERR] {"StatusCode":500,"Message":"Something went wrong","TraceId":"00-b8e0d25e819d2cde094c7265be9857ce-ba9001f0ddc67e92-00"} <s:Internship_system.BLL.Exceptions.ExceptionHandlerMiddleware>
System.NotSupportedException: No data is available for encoding 1252. For information on defining a custom encoding, see the documentation for the Encoding.RegisterProvider method.
   at System.Text.Encoding.GetEncoding(Int32 codepage)
   at ExcelDataReader.ExcelReaderConfiguration..ctor()
   at ExcelDataReader.ExcelReaderFactory.CreateReader(Stream fileStream, ExcelReaderConfiguration configuration)
   at Internship_system.BLL.Services.InternshipAdminService.UploadStudents(IFormFile studentsTable) in D:\prog\a_projects\back\Internship\Internship-system.BLL\Services\InternshipAdminService.cs:line 56
   at Internship_system.Controllers.InternshipAdminController.UploadStudents(IFormFile studentsTable) in D:\prog\a_projects\back\Internship\Internship-system.API\Controllers\InternshipAdminController.cs:line 39
   at Microsoft.AspNetCore.Mvc.Infrastructure.ActionMethodExecutor.TaskResultExecutor.Execute(ActionContext actionContext, IActionResultTypeMapper mapper, ObjectMethodExecutor executor, Object controller, Object[] arguments)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.<InvokeActionMethodAsync>g__Awaited|12_0(ControllerActionInvoker invoker, ValueTask`1 actionResultValueTask)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.<InvokeNextActionFilterAsync>g__Awaited|10_0(ControllerActionInvoker invoker, Task lastTask, State next, Scope scope, Object state, Boolean isCompleted)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.Rethrow(ActionExecutedContextSealed context)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.Next(State& next, Scope& scope, Object& state, Boolean& isCompleted)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.<InvokeInnerFilterAsync>g__Awaited|13_0(ControllerActionInvoker invoker, Task lastTask, State next, Scope scope, Object state, Boolean isCompleted)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.<InvokeNextResourceFilter>g__Awaited|25_0(ResourceInvoker invoker, Task lastTask, State next, Scope scope, Object state, Boolean isCompleted)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.Rethrow(ResourceExecutedContextSealed context)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.Next(State& next, Scope& scope, Object& state, Boolean& isCompleted)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.<InvokeFilterPipelineAsync>g__Awaited|20_0(ResourceInvoker invoker, Task lastTask, State next, Scope scope, Object state, Boolean isCompleted)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.<InvokeAsync>g__Logged|17_1(ResourceInvoker invoker)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.<InvokeAsync>g__Logged|17_1(ResourceInvoker invoker)
   at Microsoft.AspNetCore.Routing.EndpointMiddleware.<Invoke>g__AwaitRequestTask|7_0(Endpoint endpoint, Task requestTask, ILogger logger)
   at Microsoft.AspNetCore.Authentication.AuthenticationMiddleware.Invoke(HttpContext context)
   at Microsoft.AspNetCore.Authorization.AuthorizationMiddleware.Invoke(HttpContext context)
   at Internship_system.BLL.Exceptions.ExceptionHandlerMiddleware.InvokeAsync(HttpContext context) in D:\prog\a_projects\back\Internship\Internship-system.BLL\Exceptions\ExceptionHandlerMiddleware.cs:line 27
[2024-04-28 14:12:30 +07:00 INF] Request finished HTTP/1.1 POST http://localhost:5105/admin/internship/students - 500 null application/json 73808.1191ms <s:Microsoft.AspNetCore.Hosting.Diagnostics>
[2024-04-28 14:32:22 +07:00 INF] Executed DbCommand (87ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT EXISTS (
    SELECT 1 FROM pg_catalog.pg_class c
    JOIN pg_catalog.pg_namespace n ON n.oid=c.relnamespace
    WHERE n.nspname='public' AND
          c.relname='__EFMigrationsHistory'
) <s:Microsoft.EntityFrameworkCore.Database.Command>
[2024-04-28 14:32:22 +07:00 INF] Executed DbCommand (8ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT "MigrationId", "ProductVersion"
FROM "__EFMigrationsHistory"
ORDER BY "MigrationId"; <s:Microsoft.EntityFrameworkCore.Database.Command>
[2024-04-28 14:32:23 +07:00 INF] Executed DbCommand (4ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT EXISTS (
    SELECT 1 FROM pg_catalog.pg_class c
    JOIN pg_catalog.pg_namespace n ON n.oid=c.relnamespace
    WHERE n.nspname='public' AND
          c.relname='__EFMigrationsHistory'
) <s:Microsoft.EntityFrameworkCore.Database.Command>
[2024-04-28 14:32:23 +07:00 INF] Executed DbCommand (5ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT EXISTS (
    SELECT 1 FROM pg_catalog.pg_class c
    JOIN pg_catalog.pg_namespace n ON n.oid=c.relnamespace
    WHERE n.nspname='public' AND
          c.relname='__EFMigrationsHistory'
) <s:Microsoft.EntityFrameworkCore.Database.Command>
[2024-04-28 14:32:23 +07:00 INF] Executed DbCommand (1ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT "MigrationId", "ProductVersion"
FROM "__EFMigrationsHistory"
ORDER BY "MigrationId"; <s:Microsoft.EntityFrameworkCore.Database.Command>
[2024-04-28 14:32:23 +07:00 INF] No migrations were applied. The database is already up to date. <s:Microsoft.EntityFrameworkCore.Migrations>
[2024-04-28 14:32:23 +07:00 INF] User profile is available. Using 'C:\Users\danka\AppData\Local\ASP.NET\DataProtection-Keys' as key repository and Windows DPAPI to encrypt keys at rest. <s:Microsoft.AspNetCore.DataProtection.KeyManagement.XmlKeyManager>
[2024-04-28 14:32:23 +07:00 INF] Executed DbCommand (18ms) [Parameters=[@__normalizedName_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT a."Id", a."ConcurrencyStamp", a."Name", a."NormalizedName", a."RoleType"
FROM "AspNetRoles" AS a
WHERE a."NormalizedName" = @__normalizedName_0
LIMIT 1 <s:Microsoft.EntityFrameworkCore.Database.Command>
[2024-04-28 14:32:23 +07:00 INF] Executed DbCommand (1ms) [Parameters=[@__normalizedName_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT a."Id", a."ConcurrencyStamp", a."Name", a."NormalizedName", a."RoleType"
FROM "AspNetRoles" AS a
WHERE a."NormalizedName" = @__normalizedName_0
LIMIT 1 <s:Microsoft.EntityFrameworkCore.Database.Command>
[2024-04-28 14:32:23 +07:00 INF] Executed DbCommand (4ms) [Parameters=[@__normalizedEmail_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT a."Id", a."AccessFailedCount", a."ConcurrencyStamp", a."Discriminator", a."Email", a."EmailConfirmed", a."FullName", a."JoinedAt", a."LockoutEnabled", a."LockoutEnd", a."NormalizedEmail", a."NormalizedUserName", a."PasswordHash", a."PhoneNumber", a."PhoneNumberConfirmed", a."SecurityStamp", a."TwoFactorEnabled", a."UserName", a."CourseNumber", a."Group"
FROM "AspNetUsers" AS a
WHERE a."NormalizedEmail" = @__normalizedEmail_0
LIMIT 2 <s:Microsoft.EntityFrameworkCore.Database.Command>
[2024-04-28 14:32:23 +07:00 INF] Executed DbCommand (1ms) [Parameters=[@__normalizedEmail_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT a."Id", a."AccessFailedCount", a."ConcurrencyStamp", a."Discriminator", a."Email", a."EmailConfirmed", a."FullName", a."JoinedAt", a."LockoutEnabled", a."LockoutEnd", a."NormalizedEmail", a."NormalizedUserName", a."PasswordHash", a."PhoneNumber", a."PhoneNumberConfirmed", a."SecurityStamp", a."TwoFactorEnabled", a."UserName", a."CourseNumber", a."Group"
FROM "AspNetUsers" AS a
WHERE a."NormalizedEmail" = @__normalizedEmail_0
LIMIT 2 <s:Microsoft.EntityFrameworkCore.Database.Command>
[2024-04-28 14:32:23 +07:00 INF] Executed DbCommand (1ms) [Parameters=[@__normalizedRoleName_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT a."Id", a."ConcurrencyStamp", a."Name", a."NormalizedName", a."RoleType"
FROM "AspNetRoles" AS a
WHERE a."NormalizedName" = @__normalizedRoleName_0
LIMIT 2 <s:Microsoft.EntityFrameworkCore.Database.Command>
[2024-04-28 14:32:23 +07:00 INF] Executed DbCommand (8ms) [Parameters=[@__get_Item_0='?' (DbType = Guid), @__get_Item_1='?' (DbType = Guid)], CommandType='"Text"', CommandTimeout='30']
SELECT a."UserId", a."RoleId"
FROM "AspNetUserRoles" AS a
WHERE a."UserId" = @__get_Item_0 AND a."RoleId" = @__get_Item_1
LIMIT 1 <s:Microsoft.EntityFrameworkCore.Database.Command>
[2024-04-28 14:32:24 +07:00 INF] Now listening on: http://localhost:5105 <s:Microsoft.Hosting.Lifetime>
[2024-04-28 14:32:24 +07:00 INF] Application started. Press Ctrl+C to shut down. <s:Microsoft.Hosting.Lifetime>
[2024-04-28 14:32:24 +07:00 INF] Hosting environment: Development <s:Microsoft.Hosting.Lifetime>
[2024-04-28 14:32:24 +07:00 INF] Content root path: D:\prog\a_projects\back\Internship\Internship-system.API <s:Microsoft.Hosting.Lifetime>
[2024-04-28 14:32:24 +07:00 INF] Request starting HTTP/1.1 GET http://localhost:5105/swagger/index.html - null null <s:Microsoft.AspNetCore.Hosting.Diagnostics>
[2024-04-28 14:32:25 +07:00 INF] Request finished HTTP/1.1 GET http://localhost:5105/swagger/index.html - 200 null text/html;charset=utf-8 200.3705ms <s:Microsoft.AspNetCore.Hosting.Diagnostics>
[2024-04-28 14:32:25 +07:00 INF] Request starting HTTP/1.1 GET http://localhost:5105/swagger/v1/swagger.json - null null <s:Microsoft.AspNetCore.Hosting.Diagnostics>
[2024-04-28 14:32:25 +07:00 INF] Request finished HTTP/1.1 GET http://localhost:5105/swagger/v1/swagger.json - 200 null application/json;charset=utf-8 254.15ms <s:Microsoft.AspNetCore.Hosting.Diagnostics>
[2024-04-28 14:32:35 +07:00 INF] Request starting HTTP/1.1 POST http://localhost:5105/admin/internship/students - multipart/form-data; boundary=----WebKitFormBoundarypYY1sAvLAsWegblq 5077 <s:Microsoft.AspNetCore.Hosting.Diagnostics>
[2024-04-28 14:32:35 +07:00 WRN] Failed to determine the https port for redirect. <s:Microsoft.AspNetCore.HttpsPolicy.HttpsRedirectionMiddleware>
[2024-04-28 14:32:35 +07:00 INF] CORS policy execution successful. <s:Microsoft.AspNetCore.Cors.Infrastructure.CorsService>
[2024-04-28 14:32:35 +07:00 INF] Executing endpoint 'Internship_system.Controllers.InternshipAdminController.UploadStudents (Internship-system.API)' <s:Microsoft.AspNetCore.Routing.EndpointMiddleware>
[2024-04-28 14:32:35 +07:00 INF] Route matched with {action = "UploadStudents", controller = "InternshipAdmin"}. Executing controller action with signature System.Threading.Tasks.Task UploadStudents(Microsoft.AspNetCore.Http.IFormFile) on controller Internship_system.Controllers.InternshipAdminController (Internship-system.API). <s:Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker>
[2024-04-28 14:32:36 +07:00 INF] Executed action Internship_system.Controllers.InternshipAdminController.UploadStudents (Internship-system.API) in 846.1228ms <s:Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker>
[2024-04-28 14:32:36 +07:00 INF] Executed endpoint 'Internship_system.Controllers.InternshipAdminController.UploadStudents (Internship-system.API)' <s:Microsoft.AspNetCore.Routing.EndpointMiddleware>
[2024-04-28 14:33:19 +07:00 INF] Executed DbCommand (101ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT EXISTS (
    SELECT 1 FROM pg_catalog.pg_class c
    JOIN pg_catalog.pg_namespace n ON n.oid=c.relnamespace
    WHERE n.nspname='public' AND
          c.relname='__EFMigrationsHistory'
) <s:Microsoft.EntityFrameworkCore.Database.Command>
[2024-04-28 14:33:19 +07:00 INF] Executed DbCommand (11ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT "MigrationId", "ProductVersion"
FROM "__EFMigrationsHistory"
ORDER BY "MigrationId"; <s:Microsoft.EntityFrameworkCore.Database.Command>
[2024-04-28 14:33:19 +07:00 INF] Executed DbCommand (2ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT EXISTS (
    SELECT 1 FROM pg_catalog.pg_class c
    JOIN pg_catalog.pg_namespace n ON n.oid=c.relnamespace
    WHERE n.nspname='public' AND
          c.relname='__EFMigrationsHistory'
) <s:Microsoft.EntityFrameworkCore.Database.Command>
[2024-04-28 14:33:19 +07:00 INF] Executed DbCommand (1ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT EXISTS (
    SELECT 1 FROM pg_catalog.pg_class c
    JOIN pg_catalog.pg_namespace n ON n.oid=c.relnamespace
    WHERE n.nspname='public' AND
          c.relname='__EFMigrationsHistory'
) <s:Microsoft.EntityFrameworkCore.Database.Command>
[2024-04-28 14:33:19 +07:00 INF] Executed DbCommand (1ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT "MigrationId", "ProductVersion"
FROM "__EFMigrationsHistory"
ORDER BY "MigrationId"; <s:Microsoft.EntityFrameworkCore.Database.Command>
[2024-04-28 14:33:19 +07:00 INF] No migrations were applied. The database is already up to date. <s:Microsoft.EntityFrameworkCore.Migrations>
[2024-04-28 14:33:19 +07:00 INF] User profile is available. Using 'C:\Users\danka\AppData\Local\ASP.NET\DataProtection-Keys' as key repository and Windows DPAPI to encrypt keys at rest. <s:Microsoft.AspNetCore.DataProtection.KeyManagement.XmlKeyManager>
[2024-04-28 14:33:19 +07:00 INF] Executed DbCommand (16ms) [Parameters=[@__normalizedName_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT a."Id", a."ConcurrencyStamp", a."Name", a."NormalizedName", a."RoleType"
FROM "AspNetRoles" AS a
WHERE a."NormalizedName" = @__normalizedName_0
LIMIT 1 <s:Microsoft.EntityFrameworkCore.Database.Command>
[2024-04-28 14:33:19 +07:00 INF] Executed DbCommand (1ms) [Parameters=[@__normalizedName_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT a."Id", a."ConcurrencyStamp", a."Name", a."NormalizedName", a."RoleType"
FROM "AspNetRoles" AS a
WHERE a."NormalizedName" = @__normalizedName_0
LIMIT 1 <s:Microsoft.EntityFrameworkCore.Database.Command>
[2024-04-28 14:33:19 +07:00 INF] Executed DbCommand (3ms) [Parameters=[@__normalizedEmail_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT a."Id", a."AccessFailedCount", a."ConcurrencyStamp", a."Discriminator", a."Email", a."EmailConfirmed", a."FullName", a."JoinedAt", a."LockoutEnabled", a."LockoutEnd", a."NormalizedEmail", a."NormalizedUserName", a."PasswordHash", a."PhoneNumber", a."PhoneNumberConfirmed", a."SecurityStamp", a."TwoFactorEnabled", a."UserName", a."CourseNumber", a."Group"
FROM "AspNetUsers" AS a
WHERE a."NormalizedEmail" = @__normalizedEmail_0
LIMIT 2 <s:Microsoft.EntityFrameworkCore.Database.Command>
[2024-04-28 14:33:19 +07:00 INF] Executed DbCommand (1ms) [Parameters=[@__normalizedEmail_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT a."Id", a."AccessFailedCount", a."ConcurrencyStamp", a."Discriminator", a."Email", a."EmailConfirmed", a."FullName", a."JoinedAt", a."LockoutEnabled", a."LockoutEnd", a."NormalizedEmail", a."NormalizedUserName", a."PasswordHash", a."PhoneNumber", a."PhoneNumberConfirmed", a."SecurityStamp", a."TwoFactorEnabled", a."UserName", a."CourseNumber", a."Group"
FROM "AspNetUsers" AS a
WHERE a."NormalizedEmail" = @__normalizedEmail_0
LIMIT 2 <s:Microsoft.EntityFrameworkCore.Database.Command>
[2024-04-28 14:33:19 +07:00 INF] Executed DbCommand (1ms) [Parameters=[@__normalizedRoleName_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT a."Id", a."ConcurrencyStamp", a."Name", a."NormalizedName", a."RoleType"
FROM "AspNetRoles" AS a
WHERE a."NormalizedName" = @__normalizedRoleName_0
LIMIT 2 <s:Microsoft.EntityFrameworkCore.Database.Command>
[2024-04-28 14:33:19 +07:00 INF] Executed DbCommand (4ms) [Parameters=[@__get_Item_0='?' (DbType = Guid), @__get_Item_1='?' (DbType = Guid)], CommandType='"Text"', CommandTimeout='30']
SELECT a."UserId", a."RoleId"
FROM "AspNetUserRoles" AS a
WHERE a."UserId" = @__get_Item_0 AND a."RoleId" = @__get_Item_1
LIMIT 1 <s:Microsoft.EntityFrameworkCore.Database.Command>
[2024-04-28 14:33:20 +07:00 INF] Now listening on: http://localhost:5105 <s:Microsoft.Hosting.Lifetime>
[2024-04-28 14:33:20 +07:00 INF] Application started. Press Ctrl+C to shut down. <s:Microsoft.Hosting.Lifetime>
[2024-04-28 14:33:20 +07:00 INF] Hosting environment: Development <s:Microsoft.Hosting.Lifetime>
[2024-04-28 14:33:20 +07:00 INF] Content root path: D:\prog\a_projects\back\Internship\Internship-system.API <s:Microsoft.Hosting.Lifetime>
[2024-04-28 14:33:20 +07:00 INF] Request starting HTTP/1.1 GET http://localhost:5105/swagger/index.html - null null <s:Microsoft.AspNetCore.Hosting.Diagnostics>
[2024-04-28 14:33:20 +07:00 INF] Request finished HTTP/1.1 GET http://localhost:5105/swagger/index.html - 200 null text/html;charset=utf-8 160.3213ms <s:Microsoft.AspNetCore.Hosting.Diagnostics>
[2024-04-28 14:33:21 +07:00 INF] Request starting HTTP/1.1 GET http://localhost:5105/swagger/v1/swagger.json - null null <s:Microsoft.AspNetCore.Hosting.Diagnostics>
[2024-04-28 14:33:21 +07:00 INF] Request finished HTTP/1.1 GET http://localhost:5105/swagger/v1/swagger.json - 200 null application/json;charset=utf-8 183.9941ms <s:Microsoft.AspNetCore.Hosting.Diagnostics>
[2024-04-28 14:33:35 +07:00 INF] Request starting HTTP/1.1 POST http://localhost:5105/admin/internship/students - multipart/form-data; boundary=----WebKitFormBoundaryeGWdGxhuTIPFCoBt 5077 <s:Microsoft.AspNetCore.Hosting.Diagnostics>
[2024-04-28 14:33:35 +07:00 WRN] Failed to determine the https port for redirect. <s:Microsoft.AspNetCore.HttpsPolicy.HttpsRedirectionMiddleware>
[2024-04-28 14:33:35 +07:00 INF] CORS policy execution successful. <s:Microsoft.AspNetCore.Cors.Infrastructure.CorsService>
[2024-04-28 14:33:35 +07:00 INF] Executing endpoint 'Internship_system.Controllers.InternshipAdminController.UploadStudents (Internship-system.API)' <s:Microsoft.AspNetCore.Routing.EndpointMiddleware>
[2024-04-28 14:33:35 +07:00 INF] Route matched with {action = "UploadStudents", controller = "InternshipAdmin"}. Executing controller action with signature System.Threading.Tasks.Task UploadStudents(Microsoft.AspNetCore.Http.IFormFile) on controller Internship_system.Controllers.InternshipAdminController (Internship-system.API). <s:Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker>
[2024-04-28 14:33:35 +07:00 INF] Executed action Internship_system.Controllers.InternshipAdminController.UploadStudents (Internship-system.API) in 324.075ms <s:Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker>
[2024-04-28 14:33:35 +07:00 INF] Executed endpoint 'Internship_system.Controllers.InternshipAdminController.UploadStudents (Internship-system.API)' <s:Microsoft.AspNetCore.Routing.EndpointMiddleware>
[2024-04-28 14:33:35 +07:00 ERR] {"StatusCode":500,"Message":"Something went wrong","TraceId":"00-589da56d232422555342d14f4c2de309-650efece506180da-00"} <s:Internship_system.BLL.Exceptions.ExceptionHandlerMiddleware>
System.ArgumentException: Column out of range
   at OfficeOpenXml.ExcelRange.ValidateRowCol(Int32 Row, Int32 Col)
   at OfficeOpenXml.ExcelRange.get_Item(Int32 Row, Int32 Col)
   at Internship_system.BLL.Services.InternshipAdminService.UploadStudents(IFormFile studentsTable) in D:\prog\a_projects\back\Internship\Internship-system.BLL\Services\InternshipAdminService.cs:line 65
   at Internship_system.Controllers.InternshipAdminController.UploadStudents(IFormFile studentsTable) in D:\prog\a_projects\back\Internship\Internship-system.API\Controllers\InternshipAdminController.cs:line 39
   at Microsoft.AspNetCore.Mvc.Infrastructure.ActionMethodExecutor.TaskResultExecutor.Execute(ActionContext actionContext, IActionResultTypeMapper mapper, ObjectMethodExecutor executor, Object controller, Object[] arguments)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.<InvokeActionMethodAsync>g__Awaited|12_0(ControllerActionInvoker invoker, ValueTask`1 actionResultValueTask)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.<InvokeNextActionFilterAsync>g__Awaited|10_0(ControllerActionInvoker invoker, Task lastTask, State next, Scope scope, Object state, Boolean isCompleted)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.Rethrow(ActionExecutedContextSealed context)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.Next(State& next, Scope& scope, Object& state, Boolean& isCompleted)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.<InvokeInnerFilterAsync>g__Awaited|13_0(ControllerActionInvoker invoker, Task lastTask, State next, Scope scope, Object state, Boolean isCompleted)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.<InvokeNextResourceFilter>g__Awaited|25_0(ResourceInvoker invoker, Task lastTask, State next, Scope scope, Object state, Boolean isCompleted)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.Rethrow(ResourceExecutedContextSealed context)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.Next(State& next, Scope& scope, Object& state, Boolean& isCompleted)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.<InvokeFilterPipelineAsync>g__Awaited|20_0(ResourceInvoker invoker, Task lastTask, State next, Scope scope, Object state, Boolean isCompleted)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.<InvokeAsync>g__Logged|17_1(ResourceInvoker invoker)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.<InvokeAsync>g__Logged|17_1(ResourceInvoker invoker)
   at Microsoft.AspNetCore.Routing.EndpointMiddleware.<Invoke>g__AwaitRequestTask|7_0(Endpoint endpoint, Task requestTask, ILogger logger)
   at Microsoft.AspNetCore.Authentication.AuthenticationMiddleware.Invoke(HttpContext context)
   at Microsoft.AspNetCore.Authorization.AuthorizationMiddleware.Invoke(HttpContext context)
   at Internship_system.BLL.Exceptions.ExceptionHandlerMiddleware.InvokeAsync(HttpContext context) in D:\prog\a_projects\back\Internship\Internship-system.BLL\Exceptions\ExceptionHandlerMiddleware.cs:line 27
[2024-04-28 14:33:35 +07:00 INF] Request finished HTTP/1.1 POST http://localhost:5105/admin/internship/students - 500 null application/json 409.8588ms <s:Microsoft.AspNetCore.Hosting.Diagnostics>
[2024-04-28 14:33:42 +07:00 INF] Application is shutting down... <s:Microsoft.Hosting.Lifetime>
[2024-04-28 14:33:53 +07:00 INF] Executed DbCommand (85ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT EXISTS (
    SELECT 1 FROM pg_catalog.pg_class c
    JOIN pg_catalog.pg_namespace n ON n.oid=c.relnamespace
    WHERE n.nspname='public' AND
          c.relname='__EFMigrationsHistory'
) <s:Microsoft.EntityFrameworkCore.Database.Command>
[2024-04-28 14:33:53 +07:00 INF] Executed DbCommand (8ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT "MigrationId", "ProductVersion"
FROM "__EFMigrationsHistory"
ORDER BY "MigrationId"; <s:Microsoft.EntityFrameworkCore.Database.Command>
[2024-04-28 14:33:54 +07:00 INF] Executed DbCommand (3ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT EXISTS (
    SELECT 1 FROM pg_catalog.pg_class c
    JOIN pg_catalog.pg_namespace n ON n.oid=c.relnamespace
    WHERE n.nspname='public' AND
          c.relname='__EFMigrationsHistory'
) <s:Microsoft.EntityFrameworkCore.Database.Command>
[2024-04-28 14:33:54 +07:00 INF] Executed DbCommand (1ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT EXISTS (
    SELECT 1 FROM pg_catalog.pg_class c
    JOIN pg_catalog.pg_namespace n ON n.oid=c.relnamespace
    WHERE n.nspname='public' AND
          c.relname='__EFMigrationsHistory'
) <s:Microsoft.EntityFrameworkCore.Database.Command>
[2024-04-28 14:33:54 +07:00 INF] Executed DbCommand (2ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT "MigrationId", "ProductVersion"
FROM "__EFMigrationsHistory"
ORDER BY "MigrationId"; <s:Microsoft.EntityFrameworkCore.Database.Command>
[2024-04-28 14:33:54 +07:00 INF] No migrations were applied. The database is already up to date. <s:Microsoft.EntityFrameworkCore.Migrations>
[2024-04-28 14:33:54 +07:00 INF] User profile is available. Using 'C:\Users\danka\AppData\Local\ASP.NET\DataProtection-Keys' as key repository and Windows DPAPI to encrypt keys at rest. <s:Microsoft.AspNetCore.DataProtection.KeyManagement.XmlKeyManager>
[2024-04-28 14:33:54 +07:00 INF] Executed DbCommand (13ms) [Parameters=[@__normalizedName_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT a."Id", a."ConcurrencyStamp", a."Name", a."NormalizedName", a."RoleType"
FROM "AspNetRoles" AS a
WHERE a."NormalizedName" = @__normalizedName_0
LIMIT 1 <s:Microsoft.EntityFrameworkCore.Database.Command>
[2024-04-28 14:33:54 +07:00 INF] Executed DbCommand (1ms) [Parameters=[@__normalizedName_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT a."Id", a."ConcurrencyStamp", a."Name", a."NormalizedName", a."RoleType"
FROM "AspNetRoles" AS a
WHERE a."NormalizedName" = @__normalizedName_0
LIMIT 1 <s:Microsoft.EntityFrameworkCore.Database.Command>
[2024-04-28 14:33:54 +07:00 INF] Executed DbCommand (3ms) [Parameters=[@__normalizedEmail_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT a."Id", a."AccessFailedCount", a."ConcurrencyStamp", a."Discriminator", a."Email", a."EmailConfirmed", a."FullName", a."JoinedAt", a."LockoutEnabled", a."LockoutEnd", a."NormalizedEmail", a."NormalizedUserName", a."PasswordHash", a."PhoneNumber", a."PhoneNumberConfirmed", a."SecurityStamp", a."TwoFactorEnabled", a."UserName", a."CourseNumber", a."Group"
FROM "AspNetUsers" AS a
WHERE a."NormalizedEmail" = @__normalizedEmail_0
LIMIT 2 <s:Microsoft.EntityFrameworkCore.Database.Command>
[2024-04-28 14:33:54 +07:00 INF] Executed DbCommand (1ms) [Parameters=[@__normalizedEmail_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT a."Id", a."AccessFailedCount", a."ConcurrencyStamp", a."Discriminator", a."Email", a."EmailConfirmed", a."FullName", a."JoinedAt", a."LockoutEnabled", a."LockoutEnd", a."NormalizedEmail", a."NormalizedUserName", a."PasswordHash", a."PhoneNumber", a."PhoneNumberConfirmed", a."SecurityStamp", a."TwoFactorEnabled", a."UserName", a."CourseNumber", a."Group"
FROM "AspNetUsers" AS a
WHERE a."NormalizedEmail" = @__normalizedEmail_0
LIMIT 2 <s:Microsoft.EntityFrameworkCore.Database.Command>
[2024-04-28 14:33:54 +07:00 INF] Executed DbCommand (1ms) [Parameters=[@__normalizedRoleName_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT a."Id", a."ConcurrencyStamp", a."Name", a."NormalizedName", a."RoleType"
FROM "AspNetRoles" AS a
WHERE a."NormalizedName" = @__normalizedRoleName_0
LIMIT 2 <s:Microsoft.EntityFrameworkCore.Database.Command>
[2024-04-28 14:33:54 +07:00 INF] Executed DbCommand (3ms) [Parameters=[@__get_Item_0='?' (DbType = Guid), @__get_Item_1='?' (DbType = Guid)], CommandType='"Text"', CommandTimeout='30']
SELECT a."UserId", a."RoleId"
FROM "AspNetUserRoles" AS a
WHERE a."UserId" = @__get_Item_0 AND a."RoleId" = @__get_Item_1
LIMIT 1 <s:Microsoft.EntityFrameworkCore.Database.Command>
[2024-04-28 14:33:55 +07:00 INF] Now listening on: http://localhost:5105 <s:Microsoft.Hosting.Lifetime>
[2024-04-28 14:33:55 +07:00 INF] Application started. Press Ctrl+C to shut down. <s:Microsoft.Hosting.Lifetime>
[2024-04-28 14:33:55 +07:00 INF] Hosting environment: Development <s:Microsoft.Hosting.Lifetime>
[2024-04-28 14:33:55 +07:00 INF] Content root path: D:\prog\a_projects\back\Internship\Internship-system.API <s:Microsoft.Hosting.Lifetime>
[2024-04-28 14:33:55 +07:00 INF] Request starting HTTP/1.1 GET http://localhost:5105/swagger/index.html - null null <s:Microsoft.AspNetCore.Hosting.Diagnostics>
[2024-04-28 14:33:55 +07:00 INF] Request finished HTTP/1.1 GET http://localhost:5105/swagger/index.html - 200 null text/html;charset=utf-8 177.7509ms <s:Microsoft.AspNetCore.Hosting.Diagnostics>
[2024-04-28 14:33:55 +07:00 INF] Request starting HTTP/1.1 GET http://localhost:5105/swagger/v1/swagger.json - null null <s:Microsoft.AspNetCore.Hosting.Diagnostics>
[2024-04-28 14:33:55 +07:00 INF] Request finished HTTP/1.1 GET http://localhost:5105/swagger/v1/swagger.json - 200 null application/json;charset=utf-8 208.7922ms <s:Microsoft.AspNetCore.Hosting.Diagnostics>
[2024-04-28 14:33:59 +07:00 INF] Request starting HTTP/1.1 POST http://localhost:5105/admin/internship/students - multipart/form-data; boundary=----WebKitFormBoundaryye4rBitWZxgKARqv 5077 <s:Microsoft.AspNetCore.Hosting.Diagnostics>
[2024-04-28 14:33:59 +07:00 WRN] Failed to determine the https port for redirect. <s:Microsoft.AspNetCore.HttpsPolicy.HttpsRedirectionMiddleware>
[2024-04-28 14:33:59 +07:00 INF] CORS policy execution successful. <s:Microsoft.AspNetCore.Cors.Infrastructure.CorsService>
[2024-04-28 14:33:59 +07:00 INF] Executing endpoint 'Internship_system.Controllers.InternshipAdminController.UploadStudents (Internship-system.API)' <s:Microsoft.AspNetCore.Routing.EndpointMiddleware>
[2024-04-28 14:33:59 +07:00 INF] Route matched with {action = "UploadStudents", controller = "InternshipAdmin"}. Executing controller action with signature System.Threading.Tasks.Task UploadStudents(Microsoft.AspNetCore.Http.IFormFile) on controller Internship_system.Controllers.InternshipAdminController (Internship-system.API). <s:Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker>
[2024-04-28 14:34:22 +07:00 INF] Executed action Internship_system.Controllers.InternshipAdminController.UploadStudents (Internship-system.API) in 23198.4327ms <s:Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker>
[2024-04-28 14:34:22 +07:00 INF] Executed endpoint 'Internship_system.Controllers.InternshipAdminController.UploadStudents (Internship-system.API)' <s:Microsoft.AspNetCore.Routing.EndpointMiddleware>
[2024-04-28 14:34:22 +07:00 ERR] {"StatusCode":500,"Message":"Something went wrong","TraceId":"00-45b7e3e59aa6c097eccfc919c1d712a9-a8629fbf9e306ab5-00"} <s:Internship_system.BLL.Exceptions.ExceptionHandlerMiddleware>
OfficeOpenXml.LicenseException: Please set the ExcelPackage.LicenseContext property. See https://epplussoftware.com/developers/licenseexception
   at OfficeOpenXml.ExcelPackage.get_Workbook()
   at Internship_system.BLL.Services.InternshipAdminService.UploadStudents(IFormFile studentsTable) in D:\prog\a_projects\back\Internship\Internship-system.BLL\Services\InternshipAdminService.cs:line 56
   at Internship_system.Controllers.InternshipAdminController.UploadStudents(IFormFile studentsTable) in D:\prog\a_projects\back\Internship\Internship-system.API\Controllers\InternshipAdminController.cs:line 39
   at Microsoft.AspNetCore.Mvc.Infrastructure.ActionMethodExecutor.TaskResultExecutor.Execute(ActionContext actionContext, IActionResultTypeMapper mapper, ObjectMethodExecutor executor, Object controller, Object[] arguments)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.<InvokeActionMethodAsync>g__Awaited|12_0(ControllerActionInvoker invoker, ValueTask`1 actionResultValueTask)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.<InvokeNextActionFilterAsync>g__Awaited|10_0(ControllerActionInvoker invoker, Task lastTask, State next, Scope scope, Object state, Boolean isCompleted)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.Rethrow(ActionExecutedContextSealed context)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.Next(State& next, Scope& scope, Object& state, Boolean& isCompleted)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.<InvokeInnerFilterAsync>g__Awaited|13_0(ControllerActionInvoker invoker, Task lastTask, State next, Scope scope, Object state, Boolean isCompleted)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.<InvokeNextResourceFilter>g__Awaited|25_0(ResourceInvoker invoker, Task lastTask, State next, Scope scope, Object state, Boolean isCompleted)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.Rethrow(ResourceExecutedContextSealed context)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.Next(State& next, Scope& scope, Object& state, Boolean& isCompleted)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.<InvokeFilterPipelineAsync>g__Awaited|20_0(ResourceInvoker invoker, Task lastTask, State next, Scope scope, Object state, Boolean isCompleted)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.<InvokeAsync>g__Logged|17_1(ResourceInvoker invoker)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.<InvokeAsync>g__Logged|17_1(ResourceInvoker invoker)
   at Microsoft.AspNetCore.Routing.EndpointMiddleware.<Invoke>g__AwaitRequestTask|7_0(Endpoint endpoint, Task requestTask, ILogger logger)
   at Microsoft.AspNetCore.Authentication.AuthenticationMiddleware.Invoke(HttpContext context)
   at Microsoft.AspNetCore.Authorization.AuthorizationMiddleware.Invoke(HttpContext context)
   at Internship_system.BLL.Exceptions.ExceptionHandlerMiddleware.InvokeAsync(HttpContext context) in D:\prog\a_projects\back\Internship\Internship-system.BLL\Exceptions\ExceptionHandlerMiddleware.cs:line 27
[2024-04-28 14:34:22 +07:00 INF] Request finished HTTP/1.1 POST http://localhost:5105/admin/internship/students - 500 null application/json 23314.6378ms <s:Microsoft.AspNetCore.Hosting.Diagnostics>
[2024-04-28 14:34:27 +07:00 INF] Request starting HTTP/1.1 POST http://localhost:5105/admin/internship/students - multipart/form-data; boundary=----WebKitFormBoundaryHvQptHfjh285C1B2 5077 <s:Microsoft.AspNetCore.Hosting.Diagnostics>
[2024-04-28 14:34:27 +07:00 INF] CORS policy execution successful. <s:Microsoft.AspNetCore.Cors.Infrastructure.CorsService>
[2024-04-28 14:34:27 +07:00 INF] Executing endpoint 'Internship_system.Controllers.InternshipAdminController.UploadStudents (Internship-system.API)' <s:Microsoft.AspNetCore.Routing.EndpointMiddleware>
[2024-04-28 14:34:27 +07:00 INF] Route matched with {action = "UploadStudents", controller = "InternshipAdmin"}. Executing controller action with signature System.Threading.Tasks.Task UploadStudents(Microsoft.AspNetCore.Http.IFormFile) on controller Internship_system.Controllers.InternshipAdminController (Internship-system.API). <s:Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker>
[2024-04-28 14:37:08 +07:00 INF] Executed DbCommand (86ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT EXISTS (
    SELECT 1 FROM pg_catalog.pg_class c
    JOIN pg_catalog.pg_namespace n ON n.oid=c.relnamespace
    WHERE n.nspname='public' AND
          c.relname='__EFMigrationsHistory'
) <s:Microsoft.EntityFrameworkCore.Database.Command>
[2024-04-28 14:37:08 +07:00 INF] Executed DbCommand (9ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT "MigrationId", "ProductVersion"
FROM "__EFMigrationsHistory"
ORDER BY "MigrationId"; <s:Microsoft.EntityFrameworkCore.Database.Command>
[2024-04-28 14:37:08 +07:00 INF] Executed DbCommand (3ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT EXISTS (
    SELECT 1 FROM pg_catalog.pg_class c
    JOIN pg_catalog.pg_namespace n ON n.oid=c.relnamespace
    WHERE n.nspname='public' AND
          c.relname='__EFMigrationsHistory'
) <s:Microsoft.EntityFrameworkCore.Database.Command>
[2024-04-28 14:37:08 +07:00 INF] Executed DbCommand (2ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT EXISTS (
    SELECT 1 FROM pg_catalog.pg_class c
    JOIN pg_catalog.pg_namespace n ON n.oid=c.relnamespace
    WHERE n.nspname='public' AND
          c.relname='__EFMigrationsHistory'
) <s:Microsoft.EntityFrameworkCore.Database.Command>
[2024-04-28 14:37:08 +07:00 INF] Executed DbCommand (1ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT "MigrationId", "ProductVersion"
FROM "__EFMigrationsHistory"
ORDER BY "MigrationId"; <s:Microsoft.EntityFrameworkCore.Database.Command>
[2024-04-28 14:37:08 +07:00 INF] No migrations were applied. The database is already up to date. <s:Microsoft.EntityFrameworkCore.Migrations>
[2024-04-28 14:37:08 +07:00 INF] User profile is available. Using 'C:\Users\danka\AppData\Local\ASP.NET\DataProtection-Keys' as key repository and Windows DPAPI to encrypt keys at rest. <s:Microsoft.AspNetCore.DataProtection.KeyManagement.XmlKeyManager>
[2024-04-28 14:37:09 +07:00 INF] Executed DbCommand (14ms) [Parameters=[@__normalizedName_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT a."Id", a."ConcurrencyStamp", a."Name", a."NormalizedName", a."RoleType"
FROM "AspNetRoles" AS a
WHERE a."NormalizedName" = @__normalizedName_0
LIMIT 1 <s:Microsoft.EntityFrameworkCore.Database.Command>
[2024-04-28 14:37:09 +07:00 INF] Executed DbCommand (1ms) [Parameters=[@__normalizedName_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT a."Id", a."ConcurrencyStamp", a."Name", a."NormalizedName", a."RoleType"
FROM "AspNetRoles" AS a
WHERE a."NormalizedName" = @__normalizedName_0
LIMIT 1 <s:Microsoft.EntityFrameworkCore.Database.Command>
[2024-04-28 14:37:09 +07:00 INF] Executed DbCommand (4ms) [Parameters=[@__normalizedEmail_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT a."Id", a."AccessFailedCount", a."ConcurrencyStamp", a."Discriminator", a."Email", a."EmailConfirmed", a."FullName", a."JoinedAt", a."LockoutEnabled", a."LockoutEnd", a."NormalizedEmail", a."NormalizedUserName", a."PasswordHash", a."PhoneNumber", a."PhoneNumberConfirmed", a."SecurityStamp", a."TwoFactorEnabled", a."UserName", a."CourseNumber", a."Group"
FROM "AspNetUsers" AS a
WHERE a."NormalizedEmail" = @__normalizedEmail_0
LIMIT 2 <s:Microsoft.EntityFrameworkCore.Database.Command>
[2024-04-28 14:37:09 +07:00 INF] Executed DbCommand (2ms) [Parameters=[@__normalizedEmail_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT a."Id", a."AccessFailedCount", a."ConcurrencyStamp", a."Discriminator", a."Email", a."EmailConfirmed", a."FullName", a."JoinedAt", a."LockoutEnabled", a."LockoutEnd", a."NormalizedEmail", a."NormalizedUserName", a."PasswordHash", a."PhoneNumber", a."PhoneNumberConfirmed", a."SecurityStamp", a."TwoFactorEnabled", a."UserName", a."CourseNumber", a."Group"
FROM "AspNetUsers" AS a
WHERE a."NormalizedEmail" = @__normalizedEmail_0
LIMIT 2 <s:Microsoft.EntityFrameworkCore.Database.Command>
[2024-04-28 14:37:09 +07:00 INF] Executed DbCommand (1ms) [Parameters=[@__normalizedRoleName_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT a."Id", a."ConcurrencyStamp", a."Name", a."NormalizedName", a."RoleType"
FROM "AspNetRoles" AS a
WHERE a."NormalizedName" = @__normalizedRoleName_0
LIMIT 2 <s:Microsoft.EntityFrameworkCore.Database.Command>
[2024-04-28 14:37:09 +07:00 INF] Executed DbCommand (3ms) [Parameters=[@__get_Item_0='?' (DbType = Guid), @__get_Item_1='?' (DbType = Guid)], CommandType='"Text"', CommandTimeout='30']
SELECT a."UserId", a."RoleId"
FROM "AspNetUserRoles" AS a
WHERE a."UserId" = @__get_Item_0 AND a."RoleId" = @__get_Item_1
LIMIT 1 <s:Microsoft.EntityFrameworkCore.Database.Command>
[2024-04-28 14:37:09 +07:00 INF] Now listening on: http://localhost:5105 <s:Microsoft.Hosting.Lifetime>
[2024-04-28 14:37:09 +07:00 INF] Application started. Press Ctrl+C to shut down. <s:Microsoft.Hosting.Lifetime>
[2024-04-28 14:37:09 +07:00 INF] Hosting environment: Development <s:Microsoft.Hosting.Lifetime>
[2024-04-28 14:37:09 +07:00 INF] Content root path: D:\prog\a_projects\back\Internship\Internship-system.API <s:Microsoft.Hosting.Lifetime>
[2024-04-28 14:37:10 +07:00 INF] Request starting HTTP/1.1 GET http://localhost:5105/swagger/index.html - null null <s:Microsoft.AspNetCore.Hosting.Diagnostics>
[2024-04-28 14:37:10 +07:00 INF] Request finished HTTP/1.1 GET http://localhost:5105/swagger/index.html - 200 null text/html;charset=utf-8 180.4441ms <s:Microsoft.AspNetCore.Hosting.Diagnostics>
[2024-04-28 14:37:10 +07:00 INF] Request starting HTTP/1.1 GET http://localhost:5105/swagger/v1/swagger.json - null null <s:Microsoft.AspNetCore.Hosting.Diagnostics>
[2024-04-28 14:37:10 +07:00 INF] Request finished HTTP/1.1 GET http://localhost:5105/swagger/v1/swagger.json - 200 null application/json;charset=utf-8 241.6962ms <s:Microsoft.AspNetCore.Hosting.Diagnostics>
[2024-04-28 14:37:13 +07:00 INF] Request starting HTTP/1.1 POST http://localhost:5105/admin/internship/students - multipart/form-data; boundary=----WebKitFormBoundary6oQvOApR5BlIlh7A 5077 <s:Microsoft.AspNetCore.Hosting.Diagnostics>
[2024-04-28 14:37:13 +07:00 WRN] Failed to determine the https port for redirect. <s:Microsoft.AspNetCore.HttpsPolicy.HttpsRedirectionMiddleware>
[2024-04-28 14:37:13 +07:00 INF] CORS policy execution successful. <s:Microsoft.AspNetCore.Cors.Infrastructure.CorsService>
[2024-04-28 14:37:13 +07:00 INF] Executing endpoint 'Internship_system.Controllers.InternshipAdminController.UploadStudents (Internship-system.API)' <s:Microsoft.AspNetCore.Routing.EndpointMiddleware>
[2024-04-28 14:37:13 +07:00 INF] Route matched with {action = "UploadStudents", controller = "InternshipAdmin"}. Executing controller action with signature System.Threading.Tasks.Task UploadStudents(Microsoft.AspNetCore.Http.IFormFile) on controller Internship_system.Controllers.InternshipAdminController (Internship-system.API). <s:Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker>
[2024-04-28 14:37:28 +07:00 INF] Executed action Internship_system.Controllers.InternshipAdminController.UploadStudents (Internship-system.API) in 15131.4267ms <s:Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker>
[2024-04-28 14:37:28 +07:00 INF] Executed endpoint 'Internship_system.Controllers.InternshipAdminController.UploadStudents (Internship-system.API)' <s:Microsoft.AspNetCore.Routing.EndpointMiddleware>
[2024-04-28 14:37:28 +07:00 ERR] {"StatusCode":500,"Message":"Something went wrong","TraceId":"00-ba9e9b96330b9417c58fd2956fd4e92c-171975fbb22da8a3-00"} <s:Internship_system.BLL.Exceptions.ExceptionHandlerMiddleware>
System.ArgumentException: Column out of range
   at OfficeOpenXml.ExcelRange.ValidateRowCol(Int32 Row, Int32 Col)
   at OfficeOpenXml.ExcelRange.get_Item(Int32 Row, Int32 Col)
   at Internship_system.BLL.Services.InternshipAdminService.UploadStudents(IFormFile studentsTable) in D:\prog\a_projects\back\Internship\Internship-system.BLL\Services\InternshipAdminService.cs:line 66
   at Internship_system.Controllers.InternshipAdminController.UploadStudents(IFormFile studentsTable) in D:\prog\a_projects\back\Internship\Internship-system.API\Controllers\InternshipAdminController.cs:line 39
   at Microsoft.AspNetCore.Mvc.Infrastructure.ActionMethodExecutor.TaskResultExecutor.Execute(ActionContext actionContext, IActionResultTypeMapper mapper, ObjectMethodExecutor executor, Object controller, Object[] arguments)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.<InvokeActionMethodAsync>g__Awaited|12_0(ControllerActionInvoker invoker, ValueTask`1 actionResultValueTask)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.<InvokeNextActionFilterAsync>g__Awaited|10_0(ControllerActionInvoker invoker, Task lastTask, State next, Scope scope, Object state, Boolean isCompleted)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.Rethrow(ActionExecutedContextSealed context)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.Next(State& next, Scope& scope, Object& state, Boolean& isCompleted)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.<InvokeInnerFilterAsync>g__Awaited|13_0(ControllerActionInvoker invoker, Task lastTask, State next, Scope scope, Object state, Boolean isCompleted)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.<InvokeNextResourceFilter>g__Awaited|25_0(ResourceInvoker invoker, Task lastTask, State next, Scope scope, Object state, Boolean isCompleted)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.Rethrow(ResourceExecutedContextSealed context)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.Next(State& next, Scope& scope, Object& state, Boolean& isCompleted)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.<InvokeFilterPipelineAsync>g__Awaited|20_0(ResourceInvoker invoker, Task lastTask, State next, Scope scope, Object state, Boolean isCompleted)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.<InvokeAsync>g__Logged|17_1(ResourceInvoker invoker)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.<InvokeAsync>g__Logged|17_1(ResourceInvoker invoker)
   at Microsoft.AspNetCore.Routing.EndpointMiddleware.<Invoke>g__AwaitRequestTask|7_0(Endpoint endpoint, Task requestTask, ILogger logger)
   at Microsoft.AspNetCore.Authentication.AuthenticationMiddleware.Invoke(HttpContext context)
   at Microsoft.AspNetCore.Authorization.AuthorizationMiddleware.Invoke(HttpContext context)
   at Internship_system.BLL.Exceptions.ExceptionHandlerMiddleware.InvokeAsync(HttpContext context) in D:\prog\a_projects\back\Internship\Internship-system.BLL\Exceptions\ExceptionHandlerMiddleware.cs:line 27
[2024-04-28 14:37:28 +07:00 INF] Request finished HTTP/1.1 POST http://localhost:5105/admin/internship/students - 500 null application/json 15275.997ms <s:Microsoft.AspNetCore.Hosting.Diagnostics>
[2024-04-28 14:37:36 +07:00 INF] Request starting HTTP/1.1 POST http://localhost:5105/admin/internship/students - multipart/form-data; boundary=----WebKitFormBoundaryt4WQgXiBcOZ64SGk 5077 <s:Microsoft.AspNetCore.Hosting.Diagnostics>
[2024-04-28 14:37:36 +07:00 INF] CORS policy execution successful. <s:Microsoft.AspNetCore.Cors.Infrastructure.CorsService>
[2024-04-28 14:37:36 +07:00 INF] Executing endpoint 'Internship_system.Controllers.InternshipAdminController.UploadStudents (Internship-system.API)' <s:Microsoft.AspNetCore.Routing.EndpointMiddleware>
[2024-04-28 14:37:36 +07:00 INF] Route matched with {action = "UploadStudents", controller = "InternshipAdmin"}. Executing controller action with signature System.Threading.Tasks.Task UploadStudents(Microsoft.AspNetCore.Http.IFormFile) on controller Internship_system.Controllers.InternshipAdminController (Internship-system.API). <s:Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker>
[2024-04-28 14:38:55 +07:00 INF] Executed DbCommand (82ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT EXISTS (
    SELECT 1 FROM pg_catalog.pg_class c
    JOIN pg_catalog.pg_namespace n ON n.oid=c.relnamespace
    WHERE n.nspname='public' AND
          c.relname='__EFMigrationsHistory'
) <s:Microsoft.EntityFrameworkCore.Database.Command>
[2024-04-28 14:38:55 +07:00 INF] Executed DbCommand (8ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT "MigrationId", "ProductVersion"
FROM "__EFMigrationsHistory"
ORDER BY "MigrationId"; <s:Microsoft.EntityFrameworkCore.Database.Command>
[2024-04-28 14:38:55 +07:00 INF] Executed DbCommand (3ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT EXISTS (
    SELECT 1 FROM pg_catalog.pg_class c
    JOIN pg_catalog.pg_namespace n ON n.oid=c.relnamespace
    WHERE n.nspname='public' AND
          c.relname='__EFMigrationsHistory'
) <s:Microsoft.EntityFrameworkCore.Database.Command>
[2024-04-28 14:38:55 +07:00 INF] Executed DbCommand (1ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT EXISTS (
    SELECT 1 FROM pg_catalog.pg_class c
    JOIN pg_catalog.pg_namespace n ON n.oid=c.relnamespace
    WHERE n.nspname='public' AND
          c.relname='__EFMigrationsHistory'
) <s:Microsoft.EntityFrameworkCore.Database.Command>
[2024-04-28 14:38:55 +07:00 INF] Executed DbCommand (1ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT "MigrationId", "ProductVersion"
FROM "__EFMigrationsHistory"
ORDER BY "MigrationId"; <s:Microsoft.EntityFrameworkCore.Database.Command>
[2024-04-28 14:38:55 +07:00 INF] No migrations were applied. The database is already up to date. <s:Microsoft.EntityFrameworkCore.Migrations>
[2024-04-28 14:38:55 +07:00 INF] User profile is available. Using 'C:\Users\danka\AppData\Local\ASP.NET\DataProtection-Keys' as key repository and Windows DPAPI to encrypt keys at rest. <s:Microsoft.AspNetCore.DataProtection.KeyManagement.XmlKeyManager>
[2024-04-28 14:38:55 +07:00 INF] Executed DbCommand (13ms) [Parameters=[@__normalizedName_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT a."Id", a."ConcurrencyStamp", a."Name", a."NormalizedName", a."RoleType"
FROM "AspNetRoles" AS a
WHERE a."NormalizedName" = @__normalizedName_0
LIMIT 1 <s:Microsoft.EntityFrameworkCore.Database.Command>
[2024-04-28 14:38:55 +07:00 INF] Executed DbCommand (1ms) [Parameters=[@__normalizedName_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT a."Id", a."ConcurrencyStamp", a."Name", a."NormalizedName", a."RoleType"
FROM "AspNetRoles" AS a
WHERE a."NormalizedName" = @__normalizedName_0
LIMIT 1 <s:Microsoft.EntityFrameworkCore.Database.Command>
[2024-04-28 14:38:55 +07:00 INF] Executed DbCommand (3ms) [Parameters=[@__normalizedEmail_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT a."Id", a."AccessFailedCount", a."ConcurrencyStamp", a."Discriminator", a."Email", a."EmailConfirmed", a."FullName", a."JoinedAt", a."LockoutEnabled", a."LockoutEnd", a."NormalizedEmail", a."NormalizedUserName", a."PasswordHash", a."PhoneNumber", a."PhoneNumberConfirmed", a."SecurityStamp", a."TwoFactorEnabled", a."UserName", a."CourseNumber", a."Group"
FROM "AspNetUsers" AS a
WHERE a."NormalizedEmail" = @__normalizedEmail_0
LIMIT 2 <s:Microsoft.EntityFrameworkCore.Database.Command>
[2024-04-28 14:38:55 +07:00 INF] Executed DbCommand (2ms) [Parameters=[@__normalizedEmail_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT a."Id", a."AccessFailedCount", a."ConcurrencyStamp", a."Discriminator", a."Email", a."EmailConfirmed", a."FullName", a."JoinedAt", a."LockoutEnabled", a."LockoutEnd", a."NormalizedEmail", a."NormalizedUserName", a."PasswordHash", a."PhoneNumber", a."PhoneNumberConfirmed", a."SecurityStamp", a."TwoFactorEnabled", a."UserName", a."CourseNumber", a."Group"
FROM "AspNetUsers" AS a
WHERE a."NormalizedEmail" = @__normalizedEmail_0
LIMIT 2 <s:Microsoft.EntityFrameworkCore.Database.Command>
[2024-04-28 14:38:55 +07:00 INF] Executed DbCommand (1ms) [Parameters=[@__normalizedRoleName_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT a."Id", a."ConcurrencyStamp", a."Name", a."NormalizedName", a."RoleType"
FROM "AspNetRoles" AS a
WHERE a."NormalizedName" = @__normalizedRoleName_0
LIMIT 2 <s:Microsoft.EntityFrameworkCore.Database.Command>
[2024-04-28 14:38:55 +07:00 INF] Executed DbCommand (4ms) [Parameters=[@__get_Item_0='?' (DbType = Guid), @__get_Item_1='?' (DbType = Guid)], CommandType='"Text"', CommandTimeout='30']
SELECT a."UserId", a."RoleId"
FROM "AspNetUserRoles" AS a
WHERE a."UserId" = @__get_Item_0 AND a."RoleId" = @__get_Item_1
LIMIT 1 <s:Microsoft.EntityFrameworkCore.Database.Command>
[2024-04-28 14:38:56 +07:00 INF] Now listening on: http://localhost:5105 <s:Microsoft.Hosting.Lifetime>
[2024-04-28 14:38:56 +07:00 INF] Application started. Press Ctrl+C to shut down. <s:Microsoft.Hosting.Lifetime>
[2024-04-28 14:38:56 +07:00 INF] Hosting environment: Development <s:Microsoft.Hosting.Lifetime>
[2024-04-28 14:38:56 +07:00 INF] Content root path: D:\prog\a_projects\back\Internship\Internship-system.API <s:Microsoft.Hosting.Lifetime>
[2024-04-28 14:38:56 +07:00 INF] Request starting HTTP/1.1 GET http://localhost:5105/swagger/index.html - null null <s:Microsoft.AspNetCore.Hosting.Diagnostics>
[2024-04-28 14:38:57 +07:00 INF] Request finished HTTP/1.1 GET http://localhost:5105/swagger/index.html - 200 null text/html;charset=utf-8 200.9595ms <s:Microsoft.AspNetCore.Hosting.Diagnostics>
[2024-04-28 14:38:57 +07:00 INF] Request starting HTTP/1.1 GET http://localhost:5105/swagger/v1/swagger.json - null null <s:Microsoft.AspNetCore.Hosting.Diagnostics>
[2024-04-28 14:38:57 +07:00 INF] Request finished HTTP/1.1 GET http://localhost:5105/swagger/v1/swagger.json - 200 null application/json;charset=utf-8 271.7157ms <s:Microsoft.AspNetCore.Hosting.Diagnostics>
[2024-04-28 14:39:01 +07:00 INF] Request starting HTTP/1.1 POST http://localhost:5105/admin/internship/students - multipart/form-data; boundary=----WebKitFormBoundarynRmbMrkeWSDBl9vY 5077 <s:Microsoft.AspNetCore.Hosting.Diagnostics>
[2024-04-28 14:39:01 +07:00 WRN] Failed to determine the https port for redirect. <s:Microsoft.AspNetCore.HttpsPolicy.HttpsRedirectionMiddleware>
[2024-04-28 14:39:01 +07:00 INF] CORS policy execution successful. <s:Microsoft.AspNetCore.Cors.Infrastructure.CorsService>
[2024-04-28 14:39:01 +07:00 INF] Executing endpoint 'Internship_system.Controllers.InternshipAdminController.UploadStudents (Internship-system.API)' <s:Microsoft.AspNetCore.Routing.EndpointMiddleware>
[2024-04-28 14:39:01 +07:00 INF] Route matched with {action = "UploadStudents", controller = "InternshipAdmin"}. Executing controller action with signature System.Threading.Tasks.Task UploadStudents(Microsoft.AspNetCore.Http.IFormFile) on controller Internship_system.Controllers.InternshipAdminController (Internship-system.API). <s:Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker>
[2024-04-28 14:39:01 +07:00 INF] Executed action Internship_system.Controllers.InternshipAdminController.UploadStudents (Internship-system.API) in 318.7323ms <s:Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker>
[2024-04-28 14:39:01 +07:00 INF] Executed endpoint 'Internship_system.Controllers.InternshipAdminController.UploadStudents (Internship-system.API)' <s:Microsoft.AspNetCore.Routing.EndpointMiddleware>
[2024-04-28 14:39:01 +07:00 INF] Request finished HTTP/1.1 POST http://localhost:5105/admin/internship/students - 200 0 null 386.9036ms <s:Microsoft.AspNetCore.Hosting.Diagnostics>
[2024-04-28 18:55:04 +07:00 INF] Executed DbCommand (1,213ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT EXISTS (
    SELECT 1 FROM pg_catalog.pg_class c
    JOIN pg_catalog.pg_namespace n ON n.oid=c.relnamespace
    WHERE n.nspname='public' AND
          c.relname='__EFMigrationsHistory'
) <s:Microsoft.EntityFrameworkCore.Database.Command>
[2024-04-28 18:55:05 +07:00 INF] Executed DbCommand (53ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT "MigrationId", "ProductVersion"
FROM "__EFMigrationsHistory"
ORDER BY "MigrationId"; <s:Microsoft.EntityFrameworkCore.Database.Command>
[2024-04-28 18:55:05 +07:00 INF] Executed DbCommand (2ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT EXISTS (
    SELECT 1 FROM pg_catalog.pg_class c
    JOIN pg_catalog.pg_namespace n ON n.oid=c.relnamespace
    WHERE n.nspname='public' AND
          c.relname='__EFMigrationsHistory'
) <s:Microsoft.EntityFrameworkCore.Database.Command>
[2024-04-28 18:55:05 +07:00 INF] Executed DbCommand (7ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT EXISTS (
    SELECT 1 FROM pg_catalog.pg_class c
    JOIN pg_catalog.pg_namespace n ON n.oid=c.relnamespace
    WHERE n.nspname='public' AND
          c.relname='__EFMigrationsHistory'
) <s:Microsoft.EntityFrameworkCore.Database.Command>
[2024-04-28 18:55:05 +07:00 INF] Executed DbCommand (4ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT "MigrationId", "ProductVersion"
FROM "__EFMigrationsHistory"
ORDER BY "MigrationId"; <s:Microsoft.EntityFrameworkCore.Database.Command>
[2024-04-28 18:55:05 +07:00 INF] No migrations were applied. The database is already up to date. <s:Microsoft.EntityFrameworkCore.Migrations>
[2024-04-28 18:55:06 +07:00 INF] User profile is available. Using 'C:\Users\danka\AppData\Local\ASP.NET\DataProtection-Keys' as key repository and Windows DPAPI to encrypt keys at rest. <s:Microsoft.AspNetCore.DataProtection.KeyManagement.XmlKeyManager>
[2024-04-28 18:55:08 +07:00 INF] Executed DbCommand (83ms) [Parameters=[@__normalizedName_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT a."Id", a."ConcurrencyStamp", a."Name", a."NormalizedName", a."RoleType"
FROM "AspNetRoles" AS a
WHERE a."NormalizedName" = @__normalizedName_0
LIMIT 1 <s:Microsoft.EntityFrameworkCore.Database.Command>
[2024-04-28 18:55:08 +07:00 INF] Executed DbCommand (2ms) [Parameters=[@__normalizedName_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT a."Id", a."ConcurrencyStamp", a."Name", a."NormalizedName", a."RoleType"
FROM "AspNetRoles" AS a
WHERE a."NormalizedName" = @__normalizedName_0
LIMIT 1 <s:Microsoft.EntityFrameworkCore.Database.Command>
[2024-04-28 18:55:08 +07:00 INF] Executed DbCommand (15ms) [Parameters=[@__normalizedEmail_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT a."Id", a."AccessFailedCount", a."ConcurrencyStamp", a."Discriminator", a."Email", a."EmailConfirmed", a."FullName", a."JoinedAt", a."LockoutEnabled", a."LockoutEnd", a."NormalizedEmail", a."NormalizedUserName", a."PasswordHash", a."PhoneNumber", a."PhoneNumberConfirmed", a."SecurityStamp", a."TwoFactorEnabled", a."UserName", a."CourseNumber", a."Group"
FROM "AspNetUsers" AS a
WHERE a."NormalizedEmail" = @__normalizedEmail_0
LIMIT 2 <s:Microsoft.EntityFrameworkCore.Database.Command>
[2024-04-28 18:55:08 +07:00 INF] Executed DbCommand (4ms) [Parameters=[@__normalizedEmail_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT a."Id", a."AccessFailedCount", a."ConcurrencyStamp", a."Discriminator", a."Email", a."EmailConfirmed", a."FullName", a."JoinedAt", a."LockoutEnabled", a."LockoutEnd", a."NormalizedEmail", a."NormalizedUserName", a."PasswordHash", a."PhoneNumber", a."PhoneNumberConfirmed", a."SecurityStamp", a."TwoFactorEnabled", a."UserName", a."CourseNumber", a."Group"
FROM "AspNetUsers" AS a
WHERE a."NormalizedEmail" = @__normalizedEmail_0
LIMIT 2 <s:Microsoft.EntityFrameworkCore.Database.Command>
[2024-04-28 18:55:08 +07:00 INF] Executed DbCommand (2ms) [Parameters=[@__normalizedRoleName_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT a."Id", a."ConcurrencyStamp", a."Name", a."NormalizedName", a."RoleType"
FROM "AspNetRoles" AS a
WHERE a."NormalizedName" = @__normalizedRoleName_0
LIMIT 2 <s:Microsoft.EntityFrameworkCore.Database.Command>
[2024-04-28 18:55:08 +07:00 INF] Executed DbCommand (11ms) [Parameters=[@__get_Item_0='?' (DbType = Guid), @__get_Item_1='?' (DbType = Guid)], CommandType='"Text"', CommandTimeout='30']
SELECT a."UserId", a."RoleId"
FROM "AspNetUserRoles" AS a
WHERE a."UserId" = @__get_Item_0 AND a."RoleId" = @__get_Item_1
LIMIT 1 <s:Microsoft.EntityFrameworkCore.Database.Command>
[2024-04-28 18:55:09 +07:00 INF] Now listening on: http://localhost:5105 <s:Microsoft.Hosting.Lifetime>
[2024-04-28 18:55:09 +07:00 INF] Application started. Press Ctrl+C to shut down. <s:Microsoft.Hosting.Lifetime>
[2024-04-28 18:55:09 +07:00 INF] Hosting environment: Development <s:Microsoft.Hosting.Lifetime>
[2024-04-28 18:55:09 +07:00 INF] Content root path: D:\prog\a_projects\back\Internship\Internship-system.API <s:Microsoft.Hosting.Lifetime>
[2024-04-28 18:55:10 +07:00 INF] Request starting HTTP/1.1 GET http://localhost:5105/swagger/index.html - null null <s:Microsoft.AspNetCore.Hosting.Diagnostics>
[2024-04-28 18:55:11 +07:00 INF] Request finished HTTP/1.1 GET http://localhost:5105/swagger/index.html - 200 null text/html;charset=utf-8 1536.328ms <s:Microsoft.AspNetCore.Hosting.Diagnostics>
[2024-04-28 18:55:11 +07:00 INF] Request starting HTTP/1.1 GET http://localhost:5105/swagger/v1/swagger.json - null null <s:Microsoft.AspNetCore.Hosting.Diagnostics>
[2024-04-28 18:55:12 +07:00 INF] Request starting HTTP/1.1 GET http://localhost:5105/swagger/favicon-32x32.png - null null <s:Microsoft.AspNetCore.Hosting.Diagnostics>
[2024-04-28 18:55:12 +07:00 INF] Sending file. Request path: '/favicon-32x32.png'. Physical path: 'N/A' <s:Microsoft.AspNetCore.StaticFiles.StaticFileMiddleware>
[2024-04-28 18:55:12 +07:00 INF] Request finished HTTP/1.1 GET http://localhost:5105/swagger/favicon-32x32.png - 200 628 image/png 93.3737ms <s:Microsoft.AspNetCore.Hosting.Diagnostics>
[2024-04-28 18:55:12 +07:00 INF] Request finished HTTP/1.1 GET http://localhost:5105/swagger/v1/swagger.json - 200 null application/json;charset=utf-8 763.5772ms <s:Microsoft.AspNetCore.Hosting.Diagnostics>
[2024-04-28 18:55:34 +07:00 INF] Request starting HTTP/1.1 POST http://localhost:5105/admin/internship/students - multipart/form-data; boundary=----WebKitFormBoundaryV7HueglYSeuuEG7A 5077 <s:Microsoft.AspNetCore.Hosting.Diagnostics>
[2024-04-28 18:55:34 +07:00 WRN] Failed to determine the https port for redirect. <s:Microsoft.AspNetCore.HttpsPolicy.HttpsRedirectionMiddleware>
[2024-04-28 18:55:34 +07:00 INF] CORS policy execution successful. <s:Microsoft.AspNetCore.Cors.Infrastructure.CorsService>
[2024-04-28 18:55:34 +07:00 INF] Executing endpoint 'Internship_system.Controllers.InternshipAdminController.UploadStudents (Internship-system.API)' <s:Microsoft.AspNetCore.Routing.EndpointMiddleware>
[2024-04-28 18:55:34 +07:00 INF] Route matched with {action = "UploadStudents", controller = "InternshipAdmin"}. Executing controller action with signature System.Threading.Tasks.Task UploadStudents(Microsoft.AspNetCore.Http.IFormFile) on controller Internship_system.Controllers.InternshipAdminController (Internship-system.API). <s:Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker>
[2024-04-28 18:55:36 +07:00 INF] Executed action Internship_system.Controllers.InternshipAdminController.UploadStudents (Internship-system.API) in 1299.2975ms <s:Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker>
[2024-04-28 18:55:36 +07:00 INF] Executed endpoint 'Internship_system.Controllers.InternshipAdminController.UploadStudents (Internship-system.API)' <s:Microsoft.AspNetCore.Routing.EndpointMiddleware>
[2024-04-28 18:55:36 +07:00 INF] Request finished HTTP/1.1 POST http://localhost:5105/admin/internship/students - 200 0 null 1437.3633ms <s:Microsoft.AspNetCore.Hosting.Diagnostics>
[2024-04-28 18:56:56 +07:00 INF] Executed DbCommand (242ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT EXISTS (
    SELECT 1 FROM pg_catalog.pg_class c
    JOIN pg_catalog.pg_namespace n ON n.oid=c.relnamespace
    WHERE n.nspname='public' AND
          c.relname='__EFMigrationsHistory'
) <s:Microsoft.EntityFrameworkCore.Database.Command>
[2024-04-28 18:56:56 +07:00 INF] Executed DbCommand (39ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT "MigrationId", "ProductVersion"
FROM "__EFMigrationsHistory"
ORDER BY "MigrationId"; <s:Microsoft.EntityFrameworkCore.Database.Command>
[2024-04-28 18:56:56 +07:00 INF] Executed DbCommand (15ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT EXISTS (
    SELECT 1 FROM pg_catalog.pg_class c
    JOIN pg_catalog.pg_namespace n ON n.oid=c.relnamespace
    WHERE n.nspname='public' AND
          c.relname='__EFMigrationsHistory'
) <s:Microsoft.EntityFrameworkCore.Database.Command>
[2024-04-28 18:56:57 +07:00 INF] Executed DbCommand (5ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT EXISTS (
    SELECT 1 FROM pg_catalog.pg_class c
    JOIN pg_catalog.pg_namespace n ON n.oid=c.relnamespace
    WHERE n.nspname='public' AND
          c.relname='__EFMigrationsHistory'
) <s:Microsoft.EntityFrameworkCore.Database.Command>
[2024-04-28 18:56:57 +07:00 INF] Executed DbCommand (3ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT "MigrationId", "ProductVersion"
FROM "__EFMigrationsHistory"
ORDER BY "MigrationId"; <s:Microsoft.EntityFrameworkCore.Database.Command>
[2024-04-28 18:56:57 +07:00 INF] No migrations were applied. The database is already up to date. <s:Microsoft.EntityFrameworkCore.Migrations>
[2024-04-28 18:56:57 +07:00 INF] User profile is available. Using 'C:\Users\danka\AppData\Local\ASP.NET\DataProtection-Keys' as key repository and Windows DPAPI to encrypt keys at rest. <s:Microsoft.AspNetCore.DataProtection.KeyManagement.XmlKeyManager>
[2024-04-28 18:56:58 +07:00 INF] Executed DbCommand (67ms) [Parameters=[@__normalizedName_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT a."Id", a."ConcurrencyStamp", a."Name", a."NormalizedName", a."RoleType"
FROM "AspNetRoles" AS a
WHERE a."NormalizedName" = @__normalizedName_0
LIMIT 1 <s:Microsoft.EntityFrameworkCore.Database.Command>
[2024-04-28 18:56:59 +07:00 INF] Executed DbCommand (1ms) [Parameters=[@__normalizedName_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT a."Id", a."ConcurrencyStamp", a."Name", a."NormalizedName", a."RoleType"
FROM "AspNetRoles" AS a
WHERE a."NormalizedName" = @__normalizedName_0
LIMIT 1 <s:Microsoft.EntityFrameworkCore.Database.Command>
[2024-04-28 18:56:59 +07:00 INF] Executed DbCommand (6ms) [Parameters=[@__normalizedEmail_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT a."Id", a."AccessFailedCount", a."ConcurrencyStamp", a."Discriminator", a."Email", a."EmailConfirmed", a."FullName", a."JoinedAt", a."LockoutEnabled", a."LockoutEnd", a."NormalizedEmail", a."NormalizedUserName", a."PasswordHash", a."PhoneNumber", a."PhoneNumberConfirmed", a."SecurityStamp", a."TwoFactorEnabled", a."UserName", a."CourseNumber", a."Group"
FROM "AspNetUsers" AS a
WHERE a."NormalizedEmail" = @__normalizedEmail_0
LIMIT 2 <s:Microsoft.EntityFrameworkCore.Database.Command>
[2024-04-28 18:56:59 +07:00 INF] Executed DbCommand (8ms) [Parameters=[@__normalizedEmail_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT a."Id", a."AccessFailedCount", a."ConcurrencyStamp", a."Discriminator", a."Email", a."EmailConfirmed", a."FullName", a."JoinedAt", a."LockoutEnabled", a."LockoutEnd", a."NormalizedEmail", a."NormalizedUserName", a."PasswordHash", a."PhoneNumber", a."PhoneNumberConfirmed", a."SecurityStamp", a."TwoFactorEnabled", a."UserName", a."CourseNumber", a."Group"
FROM "AspNetUsers" AS a
WHERE a."NormalizedEmail" = @__normalizedEmail_0
LIMIT 2 <s:Microsoft.EntityFrameworkCore.Database.Command>
[2024-04-28 18:56:59 +07:00 INF] Executed DbCommand (3ms) [Parameters=[@__normalizedRoleName_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT a."Id", a."ConcurrencyStamp", a."Name", a."NormalizedName", a."RoleType"
FROM "AspNetRoles" AS a
WHERE a."NormalizedName" = @__normalizedRoleName_0
LIMIT 2 <s:Microsoft.EntityFrameworkCore.Database.Command>
[2024-04-28 18:56:59 +07:00 INF] Executed DbCommand (6ms) [Parameters=[@__get_Item_0='?' (DbType = Guid), @__get_Item_1='?' (DbType = Guid)], CommandType='"Text"', CommandTimeout='30']
SELECT a."UserId", a."RoleId"
FROM "AspNetUserRoles" AS a
WHERE a."UserId" = @__get_Item_0 AND a."RoleId" = @__get_Item_1
LIMIT 1 <s:Microsoft.EntityFrameworkCore.Database.Command>
[2024-04-28 18:57:00 +07:00 INF] Now listening on: http://localhost:5105 <s:Microsoft.Hosting.Lifetime>
[2024-04-28 18:57:00 +07:00 INF] Application started. Press Ctrl+C to shut down. <s:Microsoft.Hosting.Lifetime>
[2024-04-28 18:57:00 +07:00 INF] Hosting environment: Development <s:Microsoft.Hosting.Lifetime>
[2024-04-28 18:57:00 +07:00 INF] Content root path: D:\prog\a_projects\back\Internship\Internship-system.API <s:Microsoft.Hosting.Lifetime>
[2024-04-28 18:57:01 +07:00 INF] Request starting HTTP/1.1 POST http://localhost:5105/admin/internship/students - multipart/form-data; boundary=----WebKitFormBoundaryClzVvBuBBi1Pmxxz 5077 <s:Microsoft.AspNetCore.Hosting.Diagnostics>
[2024-04-28 18:57:01 +07:00 WRN] Failed to determine the https port for redirect. <s:Microsoft.AspNetCore.HttpsPolicy.HttpsRedirectionMiddleware>
[2024-04-28 18:57:01 +07:00 INF] CORS policy execution successful. <s:Microsoft.AspNetCore.Cors.Infrastructure.CorsService>
[2024-04-28 18:57:01 +07:00 INF] Executing endpoint 'Internship_system.Controllers.InternshipAdminController.UploadStudents (Internship-system.API)' <s:Microsoft.AspNetCore.Routing.EndpointMiddleware>
[2024-04-28 18:57:01 +07:00 INF] Route matched with {action = "UploadStudents", controller = "InternshipAdmin"}. Executing controller action with signature System.Threading.Tasks.Task UploadStudents(Microsoft.AspNetCore.Http.IFormFile) on controller Internship_system.Controllers.InternshipAdminController (Internship-system.API). <s:Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker>
[2024-04-28 18:57:03 +07:00 INF] Executed action Internship_system.Controllers.InternshipAdminController.UploadStudents (Internship-system.API) in 1431.2404ms <s:Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker>
[2024-04-28 18:57:03 +07:00 INF] Executed endpoint 'Internship_system.Controllers.InternshipAdminController.UploadStudents (Internship-system.API)' <s:Microsoft.AspNetCore.Routing.EndpointMiddleware>
[2024-04-28 18:57:03 +07:00 INF] Request finished HTTP/1.1 POST http://localhost:5105/admin/internship/students - 200 0 null 1726.2916ms <s:Microsoft.AspNetCore.Hosting.Diagnostics>
[2024-04-28 19:00:40 +07:00 INF] Request starting HTTP/1.1 POST http://localhost:5105/admin/internship/students - multipart/form-data; boundary=----WebKitFormBoundarym5wftXAbeM1BD0vX 5077 <s:Microsoft.AspNetCore.Hosting.Diagnostics>
[2024-04-28 19:00:40 +07:00 INF] CORS policy execution successful. <s:Microsoft.AspNetCore.Cors.Infrastructure.CorsService>
[2024-04-28 19:00:40 +07:00 INF] Executing endpoint 'Internship_system.Controllers.InternshipAdminController.UploadStudents (Internship-system.API)' <s:Microsoft.AspNetCore.Routing.EndpointMiddleware>
[2024-04-28 19:00:40 +07:00 INF] Route matched with {action = "UploadStudents", controller = "InternshipAdmin"}. Executing controller action with signature System.Threading.Tasks.Task UploadStudents(Microsoft.AspNetCore.Http.IFormFile) on controller Internship_system.Controllers.InternshipAdminController (Internship-system.API). <s:Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker>
[2024-04-28 19:01:00 +07:00 INF] Executed action Internship_system.Controllers.InternshipAdminController.UploadStudents (Internship-system.API) in 20795.307ms <s:Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker>
[2024-04-28 19:01:00 +07:00 INF] Executed endpoint 'Internship_system.Controllers.InternshipAdminController.UploadStudents (Internship-system.API)' <s:Microsoft.AspNetCore.Routing.EndpointMiddleware>
[2024-04-28 19:01:00 +07:00 INF] Request finished HTTP/1.1 POST http://localhost:5105/admin/internship/students - 200 0 null 20834.7494ms <s:Microsoft.AspNetCore.Hosting.Diagnostics>
[2024-04-28 19:01:06 +07:00 INF] Request starting HTTP/1.1 POST http://localhost:5105/admin/internship/students - multipart/form-data; boundary=----WebKitFormBoundarydprl9likmwVXVvKF 5077 <s:Microsoft.AspNetCore.Hosting.Diagnostics>
[2024-04-28 19:01:06 +07:00 INF] CORS policy execution successful. <s:Microsoft.AspNetCore.Cors.Infrastructure.CorsService>
[2024-04-28 19:01:06 +07:00 INF] Executing endpoint 'Internship_system.Controllers.InternshipAdminController.UploadStudents (Internship-system.API)' <s:Microsoft.AspNetCore.Routing.EndpointMiddleware>
[2024-04-28 19:01:06 +07:00 INF] Route matched with {action = "UploadStudents", controller = "InternshipAdmin"}. Executing controller action with signature System.Threading.Tasks.Task UploadStudents(Microsoft.AspNetCore.Http.IFormFile) on controller Internship_system.Controllers.InternshipAdminController (Internship-system.API). <s:Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker>
[2024-04-28 19:01:54 +07:00 INF] Executed DbCommand (326ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT EXISTS (
    SELECT 1 FROM pg_catalog.pg_class c
    JOIN pg_catalog.pg_namespace n ON n.oid=c.relnamespace
    WHERE n.nspname='public' AND
          c.relname='__EFMigrationsHistory'
) <s:Microsoft.EntityFrameworkCore.Database.Command>
[2024-04-28 19:01:55 +07:00 INF] Executed DbCommand (21ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT "MigrationId", "ProductVersion"
FROM "__EFMigrationsHistory"
ORDER BY "MigrationId"; <s:Microsoft.EntityFrameworkCore.Database.Command>
[2024-04-28 19:01:55 +07:00 INF] Executed DbCommand (8ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT EXISTS (
    SELECT 1 FROM pg_catalog.pg_class c
    JOIN pg_catalog.pg_namespace n ON n.oid=c.relnamespace
    WHERE n.nspname='public' AND
          c.relname='__EFMigrationsHistory'
) <s:Microsoft.EntityFrameworkCore.Database.Command>
[2024-04-28 19:01:55 +07:00 INF] Executed DbCommand (2ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT EXISTS (
    SELECT 1 FROM pg_catalog.pg_class c
    JOIN pg_catalog.pg_namespace n ON n.oid=c.relnamespace
    WHERE n.nspname='public' AND
          c.relname='__EFMigrationsHistory'
) <s:Microsoft.EntityFrameworkCore.Database.Command>
[2024-04-28 19:01:55 +07:00 INF] Executed DbCommand (2ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT "MigrationId", "ProductVersion"
FROM "__EFMigrationsHistory"
ORDER BY "MigrationId"; <s:Microsoft.EntityFrameworkCore.Database.Command>
[2024-04-28 19:01:55 +07:00 INF] No migrations were applied. The database is already up to date. <s:Microsoft.EntityFrameworkCore.Migrations>
[2024-04-28 19:01:55 +07:00 INF] User profile is available. Using 'C:\Users\danka\AppData\Local\ASP.NET\DataProtection-Keys' as key repository and Windows DPAPI to encrypt keys at rest. <s:Microsoft.AspNetCore.DataProtection.KeyManagement.XmlKeyManager>
[2024-04-28 19:01:56 +07:00 INF] Executed DbCommand (74ms) [Parameters=[@__normalizedName_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT a."Id", a."ConcurrencyStamp", a."Name", a."NormalizedName", a."RoleType"
FROM "AspNetRoles" AS a
WHERE a."NormalizedName" = @__normalizedName_0
LIMIT 1 <s:Microsoft.EntityFrameworkCore.Database.Command>
[2024-04-28 19:01:56 +07:00 INF] Executed DbCommand (1ms) [Parameters=[@__normalizedName_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT a."Id", a."ConcurrencyStamp", a."Name", a."NormalizedName", a."RoleType"
FROM "AspNetRoles" AS a
WHERE a."NormalizedName" = @__normalizedName_0
LIMIT 1 <s:Microsoft.EntityFrameworkCore.Database.Command>
[2024-04-28 19:01:56 +07:00 INF] Executed DbCommand (4ms) [Parameters=[@__normalizedEmail_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT a."Id", a."AccessFailedCount", a."ConcurrencyStamp", a."Discriminator", a."Email", a."EmailConfirmed", a."FullName", a."JoinedAt", a."LockoutEnabled", a."LockoutEnd", a."NormalizedEmail", a."NormalizedUserName", a."PasswordHash", a."PhoneNumber", a."PhoneNumberConfirmed", a."SecurityStamp", a."TwoFactorEnabled", a."UserName", a."CourseNumber", a."Group"
FROM "AspNetUsers" AS a
WHERE a."NormalizedEmail" = @__normalizedEmail_0
LIMIT 2 <s:Microsoft.EntityFrameworkCore.Database.Command>
[2024-04-28 19:01:57 +07:00 INF] Executed DbCommand (3ms) [Parameters=[@__normalizedEmail_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT a."Id", a."AccessFailedCount", a."ConcurrencyStamp", a."Discriminator", a."Email", a."EmailConfirmed", a."FullName", a."JoinedAt", a."LockoutEnabled", a."LockoutEnd", a."NormalizedEmail", a."NormalizedUserName", a."PasswordHash", a."PhoneNumber", a."PhoneNumberConfirmed", a."SecurityStamp", a."TwoFactorEnabled", a."UserName", a."CourseNumber", a."Group"
FROM "AspNetUsers" AS a
WHERE a."NormalizedEmail" = @__normalizedEmail_0
LIMIT 2 <s:Microsoft.EntityFrameworkCore.Database.Command>
[2024-04-28 19:01:57 +07:00 INF] Executed DbCommand (3ms) [Parameters=[@__normalizedRoleName_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT a."Id", a."ConcurrencyStamp", a."Name", a."NormalizedName", a."RoleType"
FROM "AspNetRoles" AS a
WHERE a."NormalizedName" = @__normalizedRoleName_0
LIMIT 2 <s:Microsoft.EntityFrameworkCore.Database.Command>
[2024-04-28 19:01:57 +07:00 INF] Executed DbCommand (5ms) [Parameters=[@__get_Item_0='?' (DbType = Guid), @__get_Item_1='?' (DbType = Guid)], CommandType='"Text"', CommandTimeout='30']
SELECT a."UserId", a."RoleId"
FROM "AspNetUserRoles" AS a
WHERE a."UserId" = @__get_Item_0 AND a."RoleId" = @__get_Item_1
LIMIT 1 <s:Microsoft.EntityFrameworkCore.Database.Command>
[2024-04-28 19:01:58 +07:00 INF] Now listening on: http://localhost:5105 <s:Microsoft.Hosting.Lifetime>
[2024-04-28 19:01:58 +07:00 INF] Application started. Press Ctrl+C to shut down. <s:Microsoft.Hosting.Lifetime>
[2024-04-28 19:01:58 +07:00 INF] Hosting environment: Development <s:Microsoft.Hosting.Lifetime>
[2024-04-28 19:01:58 +07:00 INF] Content root path: D:\prog\a_projects\back\Internship\Internship-system.API <s:Microsoft.Hosting.Lifetime>
[2024-04-28 19:02:11 +07:00 INF] Request starting HTTP/1.1 GET http://localhost:5105/swagger/index.html - null null <s:Microsoft.AspNetCore.Hosting.Diagnostics>
[2024-04-28 19:02:12 +07:00 INF] Request finished HTTP/1.1 GET http://localhost:5105/swagger/index.html - 200 null text/html;charset=utf-8 759.6864ms <s:Microsoft.AspNetCore.Hosting.Diagnostics>
[2024-04-28 19:02:12 +07:00 INF] Request starting HTTP/1.1 GET http://localhost:5105/swagger/v1/swagger.json - null null <s:Microsoft.AspNetCore.Hosting.Diagnostics>
[2024-04-28 19:02:13 +07:00 INF] Request finished HTTP/1.1 GET http://localhost:5105/swagger/v1/swagger.json - 200 null application/json;charset=utf-8 933.5542ms <s:Microsoft.AspNetCore.Hosting.Diagnostics>
[2024-04-28 19:02:26 +07:00 INF] Request starting HTTP/1.1 POST http://localhost:5105/admin/internship/students - multipart/form-data; boundary=----WebKitFormBoundaryVNsTd9D6SBThCRdw 5077 <s:Microsoft.AspNetCore.Hosting.Diagnostics>
[2024-04-28 19:02:26 +07:00 WRN] Failed to determine the https port for redirect. <s:Microsoft.AspNetCore.HttpsPolicy.HttpsRedirectionMiddleware>
[2024-04-28 19:02:26 +07:00 INF] CORS policy execution successful. <s:Microsoft.AspNetCore.Cors.Infrastructure.CorsService>
[2024-04-28 19:02:26 +07:00 INF] Executing endpoint 'Internship_system.Controllers.InternshipAdminController.UploadStudents (Internship-system.API)' <s:Microsoft.AspNetCore.Routing.EndpointMiddleware>
[2024-04-28 19:02:26 +07:00 INF] Route matched with {action = "UploadStudents", controller = "InternshipAdmin"}. Executing controller action with signature System.Threading.Tasks.Task UploadStudents(Microsoft.AspNetCore.Http.IFormFile) on controller Internship_system.Controllers.InternshipAdminController (Internship-system.API). <s:Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker>
[2024-04-28 19:04:10 +07:00 INF] Executed action Internship_system.Controllers.InternshipAdminController.UploadStudents (Internship-system.API) in 103831.8588ms <s:Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker>
[2024-04-28 19:04:10 +07:00 INF] Executed endpoint 'Internship_system.Controllers.InternshipAdminController.UploadStudents (Internship-system.API)' <s:Microsoft.AspNetCore.Routing.EndpointMiddleware>
[2024-04-28 19:04:10 +07:00 INF] Request finished HTTP/1.1 POST http://localhost:5105/admin/internship/students - 200 0 null 104056.6691ms <s:Microsoft.AspNetCore.Hosting.Diagnostics>
[2024-04-28 19:08:06 +07:00 INF] Executed DbCommand (183ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT EXISTS (
    SELECT 1 FROM pg_catalog.pg_class c
    JOIN pg_catalog.pg_namespace n ON n.oid=c.relnamespace
    WHERE n.nspname='public' AND
          c.relname='__EFMigrationsHistory'
) <s:Microsoft.EntityFrameworkCore.Database.Command>
[2024-04-28 19:08:06 +07:00 INF] Executed DbCommand (10ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT "MigrationId", "ProductVersion"
FROM "__EFMigrationsHistory"
ORDER BY "MigrationId"; <s:Microsoft.EntityFrameworkCore.Database.Command>
[2024-04-28 19:08:06 +07:00 INF] Executed DbCommand (4ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT EXISTS (
    SELECT 1 FROM pg_catalog.pg_class c
    JOIN pg_catalog.pg_namespace n ON n.oid=c.relnamespace
    WHERE n.nspname='public' AND
          c.relname='__EFMigrationsHistory'
) <s:Microsoft.EntityFrameworkCore.Database.Command>
[2024-04-28 19:08:06 +07:00 INF] Executed DbCommand (1ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT EXISTS (
    SELECT 1 FROM pg_catalog.pg_class c
    JOIN pg_catalog.pg_namespace n ON n.oid=c.relnamespace
    WHERE n.nspname='public' AND
          c.relname='__EFMigrationsHistory'
) <s:Microsoft.EntityFrameworkCore.Database.Command>
[2024-04-28 19:08:06 +07:00 INF] Executed DbCommand (1ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT "MigrationId", "ProductVersion"
FROM "__EFMigrationsHistory"
ORDER BY "MigrationId"; <s:Microsoft.EntityFrameworkCore.Database.Command>
[2024-04-28 19:08:06 +07:00 INF] No migrations were applied. The database is already up to date. <s:Microsoft.EntityFrameworkCore.Migrations>
[2024-04-28 19:08:07 +07:00 INF] User profile is available. Using 'C:\Users\danka\AppData\Local\ASP.NET\DataProtection-Keys' as key repository and Windows DPAPI to encrypt keys at rest. <s:Microsoft.AspNetCore.DataProtection.KeyManagement.XmlKeyManager>
[2024-04-28 19:08:07 +07:00 INF] Executed DbCommand (16ms) [Parameters=[@__normalizedName_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT a."Id", a."ConcurrencyStamp", a."Name", a."NormalizedName", a."RoleType"
FROM "AspNetRoles" AS a
WHERE a."NormalizedName" = @__normalizedName_0
LIMIT 1 <s:Microsoft.EntityFrameworkCore.Database.Command>
[2024-04-28 19:08:07 +07:00 INF] Executed DbCommand (2ms) [Parameters=[@__normalizedName_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT a."Id", a."ConcurrencyStamp", a."Name", a."NormalizedName", a."RoleType"
FROM "AspNetRoles" AS a
WHERE a."NormalizedName" = @__normalizedName_0
LIMIT 1 <s:Microsoft.EntityFrameworkCore.Database.Command>
[2024-04-28 19:08:07 +07:00 INF] Executed DbCommand (6ms) [Parameters=[@__normalizedEmail_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT a."Id", a."AccessFailedCount", a."ConcurrencyStamp", a."Discriminator", a."Email", a."EmailConfirmed", a."FullName", a."JoinedAt", a."LockoutEnabled", a."LockoutEnd", a."NormalizedEmail", a."NormalizedUserName", a."PasswordHash", a."PhoneNumber", a."PhoneNumberConfirmed", a."SecurityStamp", a."TwoFactorEnabled", a."UserName", a."CourseNumber", a."Group"
FROM "AspNetUsers" AS a
WHERE a."NormalizedEmail" = @__normalizedEmail_0
LIMIT 2 <s:Microsoft.EntityFrameworkCore.Database.Command>
[2024-04-28 19:08:07 +07:00 INF] Executed DbCommand (4ms) [Parameters=[@__normalizedEmail_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT a."Id", a."AccessFailedCount", a."ConcurrencyStamp", a."Discriminator", a."Email", a."EmailConfirmed", a."FullName", a."JoinedAt", a."LockoutEnabled", a."LockoutEnd", a."NormalizedEmail", a."NormalizedUserName", a."PasswordHash", a."PhoneNumber", a."PhoneNumberConfirmed", a."SecurityStamp", a."TwoFactorEnabled", a."UserName", a."CourseNumber", a."Group"
FROM "AspNetUsers" AS a
WHERE a."NormalizedEmail" = @__normalizedEmail_0
LIMIT 2 <s:Microsoft.EntityFrameworkCore.Database.Command>
[2024-04-28 19:08:07 +07:00 INF] Executed DbCommand (3ms) [Parameters=[@__normalizedRoleName_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT a."Id", a."ConcurrencyStamp", a."Name", a."NormalizedName", a."RoleType"
FROM "AspNetRoles" AS a
WHERE a."NormalizedName" = @__normalizedRoleName_0
LIMIT 2 <s:Microsoft.EntityFrameworkCore.Database.Command>
[2024-04-28 19:08:07 +07:00 INF] Executed DbCommand (5ms) [Parameters=[@__get_Item_0='?' (DbType = Guid), @__get_Item_1='?' (DbType = Guid)], CommandType='"Text"', CommandTimeout='30']
SELECT a."UserId", a."RoleId"
FROM "AspNetUserRoles" AS a
WHERE a."UserId" = @__get_Item_0 AND a."RoleId" = @__get_Item_1
LIMIT 1 <s:Microsoft.EntityFrameworkCore.Database.Command>
[2024-04-28 19:08:08 +07:00 INF] Now listening on: http://localhost:5105 <s:Microsoft.Hosting.Lifetime>
[2024-04-28 19:08:08 +07:00 INF] Application started. Press Ctrl+C to shut down. <s:Microsoft.Hosting.Lifetime>
[2024-04-28 19:08:08 +07:00 INF] Hosting environment: Development <s:Microsoft.Hosting.Lifetime>
[2024-04-28 19:08:08 +07:00 INF] Content root path: D:\prog\a_projects\back\Internship\Internship-system.API <s:Microsoft.Hosting.Lifetime>
[2024-04-28 19:08:08 +07:00 INF] Request starting HTTP/1.1 GET http://localhost:5105/swagger/index.html - null null <s:Microsoft.AspNetCore.Hosting.Diagnostics>
[2024-04-28 19:08:09 +07:00 INF] Request finished HTTP/1.1 GET http://localhost:5105/swagger/index.html - 200 null text/html;charset=utf-8 455.2452ms <s:Microsoft.AspNetCore.Hosting.Diagnostics>
[2024-04-28 19:08:09 +07:00 INF] Request starting HTTP/1.1 GET http://localhost:5105/swagger/v1/swagger.json - null null <s:Microsoft.AspNetCore.Hosting.Diagnostics>
[2024-04-28 19:08:09 +07:00 INF] Request finished HTTP/1.1 GET http://localhost:5105/swagger/v1/swagger.json - 200 null application/json;charset=utf-8 568.365ms <s:Microsoft.AspNetCore.Hosting.Diagnostics>
[2024-04-28 19:08:15 +07:00 INF] Request starting HTTP/1.1 POST http://localhost:5105/admin/internship/students - multipart/form-data; boundary=----WebKitFormBoundary1aNypYW2M9vcDOTZ 5077 <s:Microsoft.AspNetCore.Hosting.Diagnostics>
[2024-04-28 19:08:15 +07:00 WRN] Failed to determine the https port for redirect. <s:Microsoft.AspNetCore.HttpsPolicy.HttpsRedirectionMiddleware>
[2024-04-28 19:08:15 +07:00 INF] CORS policy execution successful. <s:Microsoft.AspNetCore.Cors.Infrastructure.CorsService>
[2024-04-28 19:08:15 +07:00 INF] Executing endpoint 'Internship_system.Controllers.InternshipAdminController.UploadStudents (Internship-system.API)' <s:Microsoft.AspNetCore.Routing.EndpointMiddleware>
[2024-04-28 19:08:15 +07:00 INF] Route matched with {action = "UploadStudents", controller = "InternshipAdmin"}. Executing controller action with signature System.Threading.Tasks.Task UploadStudents(Microsoft.AspNetCore.Http.IFormFile) on controller Internship_system.Controllers.InternshipAdminController (Internship-system.API). <s:Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker>
[2024-04-28 19:08:55 +07:00 INF] Executed action Internship_system.Controllers.InternshipAdminController.UploadStudents (Internship-system.API) in 39904.9732ms <s:Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker>
[2024-04-28 19:08:55 +07:00 INF] Executed endpoint 'Internship_system.Controllers.InternshipAdminController.UploadStudents (Internship-system.API)' <s:Microsoft.AspNetCore.Routing.EndpointMiddleware>
[2024-04-28 19:08:55 +07:00 INF] Request finished HTTP/1.1 POST http://localhost:5105/admin/internship/students - 200 0 null 39984.4023ms <s:Microsoft.AspNetCore.Hosting.Diagnostics>
[2024-04-28 19:13:50 +07:00 INF] Executed DbCommand (214ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT EXISTS (
    SELECT 1 FROM pg_catalog.pg_class c
    JOIN pg_catalog.pg_namespace n ON n.oid=c.relnamespace
    WHERE n.nspname='public' AND
          c.relname='__EFMigrationsHistory'
) <s:Microsoft.EntityFrameworkCore.Database.Command>
[2024-04-28 19:13:50 +07:00 INF] Executed DbCommand (15ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT "MigrationId", "ProductVersion"
FROM "__EFMigrationsHistory"
ORDER BY "MigrationId"; <s:Microsoft.EntityFrameworkCore.Database.Command>
[2024-04-28 19:13:50 +07:00 INF] Executed DbCommand (9ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT EXISTS (
    SELECT 1 FROM pg_catalog.pg_class c
    JOIN pg_catalog.pg_namespace n ON n.oid=c.relnamespace
    WHERE n.nspname='public' AND
          c.relname='__EFMigrationsHistory'
) <s:Microsoft.EntityFrameworkCore.Database.Command>
[2024-04-28 19:13:50 +07:00 INF] Executed DbCommand (3ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT EXISTS (
    SELECT 1 FROM pg_catalog.pg_class c
    JOIN pg_catalog.pg_namespace n ON n.oid=c.relnamespace
    WHERE n.nspname='public' AND
          c.relname='__EFMigrationsHistory'
) <s:Microsoft.EntityFrameworkCore.Database.Command>
[2024-04-28 19:13:50 +07:00 INF] Executed DbCommand (3ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT "MigrationId", "ProductVersion"
FROM "__EFMigrationsHistory"
ORDER BY "MigrationId"; <s:Microsoft.EntityFrameworkCore.Database.Command>
[2024-04-28 19:13:50 +07:00 INF] No migrations were applied. The database is already up to date. <s:Microsoft.EntityFrameworkCore.Migrations>
[2024-04-28 19:13:50 +07:00 INF] User profile is available. Using 'C:\Users\danka\AppData\Local\ASP.NET\DataProtection-Keys' as key repository and Windows DPAPI to encrypt keys at rest. <s:Microsoft.AspNetCore.DataProtection.KeyManagement.XmlKeyManager>
[2024-04-28 19:13:51 +07:00 INF] Executed DbCommand (15ms) [Parameters=[@__normalizedName_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT a."Id", a."ConcurrencyStamp", a."Name", a."NormalizedName", a."RoleType"
FROM "AspNetRoles" AS a
WHERE a."NormalizedName" = @__normalizedName_0
LIMIT 1 <s:Microsoft.EntityFrameworkCore.Database.Command>
[2024-04-28 19:13:51 +07:00 INF] Executed DbCommand (2ms) [Parameters=[@__normalizedName_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT a."Id", a."ConcurrencyStamp", a."Name", a."NormalizedName", a."RoleType"
FROM "AspNetRoles" AS a
WHERE a."NormalizedName" = @__normalizedName_0
LIMIT 1 <s:Microsoft.EntityFrameworkCore.Database.Command>
[2024-04-28 19:13:51 +07:00 INF] Executed DbCommand (6ms) [Parameters=[@__normalizedEmail_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT a."Id", a."AccessFailedCount", a."ConcurrencyStamp", a."Discriminator", a."Email", a."EmailConfirmed", a."FullName", a."JoinedAt", a."LockoutEnabled", a."LockoutEnd", a."NormalizedEmail", a."NormalizedUserName", a."PasswordHash", a."PhoneNumber", a."PhoneNumberConfirmed", a."SecurityStamp", a."TwoFactorEnabled", a."UserName", a."CourseNumber", a."Group"
FROM "AspNetUsers" AS a
WHERE a."NormalizedEmail" = @__normalizedEmail_0
LIMIT 2 <s:Microsoft.EntityFrameworkCore.Database.Command>
[2024-04-28 19:13:51 +07:00 INF] Executed DbCommand (4ms) [Parameters=[@__normalizedEmail_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT a."Id", a."AccessFailedCount", a."ConcurrencyStamp", a."Discriminator", a."Email", a."EmailConfirmed", a."FullName", a."JoinedAt", a."LockoutEnabled", a."LockoutEnd", a."NormalizedEmail", a."NormalizedUserName", a."PasswordHash", a."PhoneNumber", a."PhoneNumberConfirmed", a."SecurityStamp", a."TwoFactorEnabled", a."UserName", a."CourseNumber", a."Group"
FROM "AspNetUsers" AS a
WHERE a."NormalizedEmail" = @__normalizedEmail_0
LIMIT 2 <s:Microsoft.EntityFrameworkCore.Database.Command>
[2024-04-28 19:13:51 +07:00 INF] Executed DbCommand (2ms) [Parameters=[@__normalizedRoleName_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT a."Id", a."ConcurrencyStamp", a."Name", a."NormalizedName", a."RoleType"
FROM "AspNetRoles" AS a
WHERE a."NormalizedName" = @__normalizedRoleName_0
LIMIT 2 <s:Microsoft.EntityFrameworkCore.Database.Command>
[2024-04-28 19:13:51 +07:00 INF] Executed DbCommand (7ms) [Parameters=[@__get_Item_0='?' (DbType = Guid), @__get_Item_1='?' (DbType = Guid)], CommandType='"Text"', CommandTimeout='30']
SELECT a."UserId", a."RoleId"
FROM "AspNetUserRoles" AS a
WHERE a."UserId" = @__get_Item_0 AND a."RoleId" = @__get_Item_1
LIMIT 1 <s:Microsoft.EntityFrameworkCore.Database.Command>
[2024-04-28 19:13:52 +07:00 INF] Now listening on: http://localhost:5105 <s:Microsoft.Hosting.Lifetime>
[2024-04-28 19:13:52 +07:00 INF] Application started. Press Ctrl+C to shut down. <s:Microsoft.Hosting.Lifetime>
[2024-04-28 19:13:52 +07:00 INF] Hosting environment: Development <s:Microsoft.Hosting.Lifetime>
[2024-04-28 19:13:52 +07:00 INF] Content root path: D:\prog\a_projects\back\Internship\Internship-system.API <s:Microsoft.Hosting.Lifetime>
[2024-04-28 19:13:53 +07:00 INF] Request starting HTTP/1.1 GET http://localhost:5105/swagger/index.html - null null <s:Microsoft.AspNetCore.Hosting.Diagnostics>
[2024-04-28 19:13:53 +07:00 INF] Request finished HTTP/1.1 GET http://localhost:5105/swagger/index.html - 200 null text/html;charset=utf-8 536.7587ms <s:Microsoft.AspNetCore.Hosting.Diagnostics>
[2024-04-28 19:13:53 +07:00 INF] Request starting HTTP/1.1 GET http://localhost:5105/swagger/v1/swagger.json - null null <s:Microsoft.AspNetCore.Hosting.Diagnostics>
[2024-04-28 19:13:54 +07:00 INF] Request finished HTTP/1.1 GET http://localhost:5105/swagger/v1/swagger.json - 200 null application/json;charset=utf-8 545.6203ms <s:Microsoft.AspNetCore.Hosting.Diagnostics>
[2024-04-28 19:13:58 +07:00 INF] Request starting HTTP/1.1 POST http://localhost:5105/admin/internship/students - multipart/form-data; boundary=----WebKitFormBoundary3vETbpa2liMUoEUq 5077 <s:Microsoft.AspNetCore.Hosting.Diagnostics>
[2024-04-28 19:13:58 +07:00 WRN] Failed to determine the https port for redirect. <s:Microsoft.AspNetCore.HttpsPolicy.HttpsRedirectionMiddleware>
[2024-04-28 19:13:58 +07:00 INF] CORS policy execution successful. <s:Microsoft.AspNetCore.Cors.Infrastructure.CorsService>
[2024-04-28 19:13:58 +07:00 INF] Executing endpoint 'Internship_system.Controllers.InternshipAdminController.UploadStudents (Internship-system.API)' <s:Microsoft.AspNetCore.Routing.EndpointMiddleware>
[2024-04-28 19:13:58 +07:00 INF] Route matched with {action = "UploadStudents", controller = "InternshipAdmin"}. Executing controller action with signature System.Threading.Tasks.Task UploadStudents(Microsoft.AspNetCore.Http.IFormFile) on controller Internship_system.Controllers.InternshipAdminController (Internship-system.API). <s:Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker>
[2024-04-28 19:13:59 +07:00 INF] Executed DbCommand (1ms) [Parameters=[@__normalizedUserName_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT a."Id", a."AccessFailedCount", a."ConcurrencyStamp", a."Discriminator", a."Email", a."EmailConfirmed", a."FullName", a."JoinedAt", a."LockoutEnabled", a."LockoutEnd", a."NormalizedEmail", a."NormalizedUserName", a."PasswordHash", a."PhoneNumber", a."PhoneNumberConfirmed", a."SecurityStamp", a."TwoFactorEnabled", a."UserName", a."CourseNumber", a."Group"
FROM "AspNetUsers" AS a
WHERE a."NormalizedUserName" = @__normalizedUserName_0
LIMIT 1 <s:Microsoft.EntityFrameworkCore.Database.Command>
[2024-04-28 19:14:00 +07:00 INF] Executed DbCommand (17ms) [Parameters=[@p0='?' (DbType = Guid), @p1='?' (DbType = Int32), @p2='?', @p3='?' (DbType = Int32), @p4='?', @p5='?', @p6='?' (DbType = Boolean), @p7='?', @p8='?', @p9='?' (DbType = DateTime), @p10='?' (DbType = Boolean), @p11='?' (DbType = DateTime), @p12='?', @p13='?', @p14='?', @p15='?', @p16='?' (DbType = Boolean), @p17='?', @p18='?' (DbType = Boolean), @p19='?'], CommandType='"Text"', CommandTimeout='30']
INSERT INTO "AspNetUsers" ("Id", "AccessFailedCount", "ConcurrencyStamp", "CourseNumber", "Discriminator", "Email", "EmailConfirmed", "FullName", "Group", "JoinedAt", "LockoutEnabled", "LockoutEnd", "NormalizedEmail", "NormalizedUserName", "PasswordHash", "PhoneNumber", "PhoneNumberConfirmed", "SecurityStamp", "TwoFactorEnabled", "UserName")
VALUES (@p0, @p1, @p2, @p3, @p4, @p5, @p6, @p7, @p8, @p9, @p10, @p11, @p12, @p13, @p14, @p15, @p16, @p17, @p18, @p19); <s:Microsoft.EntityFrameworkCore.Database.Command>
[2024-04-28 19:14:00 +07:00 INF] Executed DbCommand (3ms) [Parameters=[@__normalizedRoleName_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT a."Id", a."ConcurrencyStamp", a."Name", a."NormalizedName", a."RoleType"
FROM "AspNetRoles" AS a
WHERE a."NormalizedName" = @__normalizedRoleName_0
LIMIT 2 <s:Microsoft.EntityFrameworkCore.Database.Command>
[2024-04-28 19:14:00 +07:00 INF] Executed DbCommand (2ms) [Parameters=[@__get_Item_0='?' (DbType = Guid), @__get_Item_1='?' (DbType = Guid)], CommandType='"Text"', CommandTimeout='30']
SELECT a."UserId", a."RoleId"
FROM "AspNetUserRoles" AS a
WHERE a."UserId" = @__get_Item_0 AND a."RoleId" = @__get_Item_1
LIMIT 1 <s:Microsoft.EntityFrameworkCore.Database.Command>
[2024-04-28 19:14:00 +07:00 INF] Executed DbCommand (1ms) [Parameters=[@__normalizedRoleName_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT a."Id", a."ConcurrencyStamp", a."Name", a."NormalizedName", a."RoleType"
FROM "AspNetRoles" AS a
WHERE a."NormalizedName" = @__normalizedRoleName_0
LIMIT 2 <s:Microsoft.EntityFrameworkCore.Database.Command>
[2024-04-28 19:14:00 +07:00 INF] Executed DbCommand (1ms) [Parameters=[@__normalizedUserName_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT a."Id", a."AccessFailedCount", a."ConcurrencyStamp", a."Discriminator", a."Email", a."EmailConfirmed", a."FullName", a."JoinedAt", a."LockoutEnabled", a."LockoutEnd", a."NormalizedEmail", a."NormalizedUserName", a."PasswordHash", a."PhoneNumber", a."PhoneNumberConfirmed", a."SecurityStamp", a."TwoFactorEnabled", a."UserName", a."CourseNumber", a."Group"
FROM "AspNetUsers" AS a
WHERE a."NormalizedUserName" = @__normalizedUserName_0
LIMIT 1 <s:Microsoft.EntityFrameworkCore.Database.Command>
[2024-04-28 19:14:00 +07:00 INF] Executed DbCommand (4ms) [Parameters=[@p0='?' (DbType = Guid), @p1='?' (DbType = Guid), @p20='?' (DbType = Guid), @p2='?' (DbType = Int32), @p3='?', @p21='?', @p4='?' (DbType = Int32), @p5='?', @p6='?' (DbType = Boolean), @p7='?', @p8='?', @p9='?' (DbType = DateTime), @p10='?' (DbType = Boolean), @p11='?' (DbType = DateTime), @p12='?', @p13='?', @p14='?', @p15='?', @p16='?' (DbType = Boolean), @p17='?', @p18='?' (DbType = Boolean), @p19='?'], CommandType='"Text"', CommandTimeout='30']
INSERT INTO "AspNetUserRoles" ("RoleId", "UserId")
VALUES (@p0, @p1);
UPDATE "AspNetUsers" SET "AccessFailedCount" = @p2, "ConcurrencyStamp" = @p3, "CourseNumber" = @p4, "Email" = @p5, "EmailConfirmed" = @p6, "FullName" = @p7, "Group" = @p8, "JoinedAt" = @p9, "LockoutEnabled" = @p10, "LockoutEnd" = @p11, "NormalizedEmail" = @p12, "NormalizedUserName" = @p13, "PasswordHash" = @p14, "PhoneNumber" = @p15, "PhoneNumberConfirmed" = @p16, "SecurityStamp" = @p17, "TwoFactorEnabled" = @p18, "UserName" = @p19
WHERE "Id" = @p20 AND "ConcurrencyStamp" = @p21; <s:Microsoft.EntityFrameworkCore.Database.Command>
[2024-04-28 19:14:00 +07:00 INF] Executed DbCommand (2ms) [Parameters=[@__normalizedUserName_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT a."Id", a."AccessFailedCount", a."ConcurrencyStamp", a."Discriminator", a."Email", a."EmailConfirmed", a."FullName", a."JoinedAt", a."LockoutEnabled", a."LockoutEnd", a."NormalizedEmail", a."NormalizedUserName", a."PasswordHash", a."PhoneNumber", a."PhoneNumberConfirmed", a."SecurityStamp", a."TwoFactorEnabled", a."UserName", a."CourseNumber", a."Group"
FROM "AspNetUsers" AS a
WHERE a."NormalizedUserName" = @__normalizedUserName_0
LIMIT 1 <s:Microsoft.EntityFrameworkCore.Database.Command>
[2024-04-28 19:14:00 +07:00 INF] Executed DbCommand (35ms) [Parameters=[@p0='?' (DbType = Guid), @p1='?' (DbType = Int32), @p2='?', @p3='?' (DbType = Int32), @p4='?', @p5='?', @p6='?' (DbType = Boolean), @p7='?', @p8='?', @p9='?' (DbType = DateTime), @p10='?' (DbType = Boolean), @p11='?' (DbType = DateTime), @p12='?', @p13='?', @p14='?', @p15='?', @p16='?' (DbType = Boolean), @p17='?', @p18='?' (DbType = Boolean), @p19='?'], CommandType='"Text"', CommandTimeout='30']
INSERT INTO "AspNetUsers" ("Id", "AccessFailedCount", "ConcurrencyStamp", "CourseNumber", "Discriminator", "Email", "EmailConfirmed", "FullName", "Group", "JoinedAt", "LockoutEnabled", "LockoutEnd", "NormalizedEmail", "NormalizedUserName", "PasswordHash", "PhoneNumber", "PhoneNumberConfirmed", "SecurityStamp", "TwoFactorEnabled", "UserName")
VALUES (@p0, @p1, @p2, @p3, @p4, @p5, @p6, @p7, @p8, @p9, @p10, @p11, @p12, @p13, @p14, @p15, @p16, @p17, @p18, @p19); <s:Microsoft.EntityFrameworkCore.Database.Command>
[2024-04-28 19:14:00 +07:00 INF] Executed DbCommand (1ms) [Parameters=[@__normalizedRoleName_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT a."Id", a."ConcurrencyStamp", a."Name", a."NormalizedName", a."RoleType"
FROM "AspNetRoles" AS a
WHERE a."NormalizedName" = @__normalizedRoleName_0
LIMIT 2 <s:Microsoft.EntityFrameworkCore.Database.Command>
[2024-04-28 19:14:00 +07:00 INF] Executed DbCommand (2ms) [Parameters=[@__get_Item_0='?' (DbType = Guid), @__get_Item_1='?' (DbType = Guid)], CommandType='"Text"', CommandTimeout='30']
SELECT a."UserId", a."RoleId"
FROM "AspNetUserRoles" AS a
WHERE a."UserId" = @__get_Item_0 AND a."RoleId" = @__get_Item_1
LIMIT 1 <s:Microsoft.EntityFrameworkCore.Database.Command>
[2024-04-28 19:14:00 +07:00 INF] Executed DbCommand (1ms) [Parameters=[@__normalizedRoleName_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT a."Id", a."ConcurrencyStamp", a."Name", a."NormalizedName", a."RoleType"
FROM "AspNetRoles" AS a
WHERE a."NormalizedName" = @__normalizedRoleName_0
LIMIT 2 <s:Microsoft.EntityFrameworkCore.Database.Command>
[2024-04-28 19:14:00 +07:00 INF] Executed DbCommand (2ms) [Parameters=[@__normalizedUserName_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT a."Id", a."AccessFailedCount", a."ConcurrencyStamp", a."Discriminator", a."Email", a."EmailConfirmed", a."FullName", a."JoinedAt", a."LockoutEnabled", a."LockoutEnd", a."NormalizedEmail", a."NormalizedUserName", a."PasswordHash", a."PhoneNumber", a."PhoneNumberConfirmed", a."SecurityStamp", a."TwoFactorEnabled", a."UserName", a."CourseNumber", a."Group"
FROM "AspNetUsers" AS a
WHERE a."NormalizedUserName" = @__normalizedUserName_0
LIMIT 1 <s:Microsoft.EntityFrameworkCore.Database.Command>
[2024-04-28 19:14:00 +07:00 INF] Executed DbCommand (1ms) [Parameters=[@p0='?' (DbType = Guid), @p1='?' (DbType = Guid), @p20='?' (DbType = Guid), @p2='?' (DbType = Int32), @p3='?', @p21='?', @p4='?' (DbType = Int32), @p5='?', @p6='?' (DbType = Boolean), @p7='?', @p8='?', @p9='?' (DbType = DateTime), @p10='?' (DbType = Boolean), @p11='?' (DbType = DateTime), @p12='?', @p13='?', @p14='?', @p15='?', @p16='?' (DbType = Boolean), @p17='?', @p18='?' (DbType = Boolean), @p19='?'], CommandType='"Text"', CommandTimeout='30']
INSERT INTO "AspNetUserRoles" ("RoleId", "UserId")
VALUES (@p0, @p1);
UPDATE "AspNetUsers" SET "AccessFailedCount" = @p2, "ConcurrencyStamp" = @p3, "CourseNumber" = @p4, "Email" = @p5, "EmailConfirmed" = @p6, "FullName" = @p7, "Group" = @p8, "JoinedAt" = @p9, "LockoutEnabled" = @p10, "LockoutEnd" = @p11, "NormalizedEmail" = @p12, "NormalizedUserName" = @p13, "PasswordHash" = @p14, "PhoneNumber" = @p15, "PhoneNumberConfirmed" = @p16, "SecurityStamp" = @p17, "TwoFactorEnabled" = @p18, "UserName" = @p19
WHERE "Id" = @p20 AND "ConcurrencyStamp" = @p21; <s:Microsoft.EntityFrameworkCore.Database.Command>
[2024-04-28 19:14:00 +07:00 INF] Executed action Internship_system.Controllers.InternshipAdminController.UploadStudents (Internship-system.API) in 2190.002ms <s:Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker>
[2024-04-28 19:14:00 +07:00 INF] Executed endpoint 'Internship_system.Controllers.InternshipAdminController.UploadStudents (Internship-system.API)' <s:Microsoft.AspNetCore.Routing.EndpointMiddleware>
[2024-04-28 19:14:00 +07:00 INF] Request finished HTTP/1.1 POST http://localhost:5105/admin/internship/students - 200 0 null 2294.2214ms <s:Microsoft.AspNetCore.Hosting.Diagnostics>
[2024-04-28 19:16:07 +07:00 INF] Executed DbCommand (228ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT EXISTS (
    SELECT 1 FROM pg_catalog.pg_class c
    JOIN pg_catalog.pg_namespace n ON n.oid=c.relnamespace
    WHERE n.nspname='public' AND
          c.relname='__EFMigrationsHistory'
) <s:Microsoft.EntityFrameworkCore.Database.Command>
[2024-04-28 19:16:07 +07:00 INF] Executed DbCommand (23ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT "MigrationId", "ProductVersion"
FROM "__EFMigrationsHistory"
ORDER BY "MigrationId"; <s:Microsoft.EntityFrameworkCore.Database.Command>
[2024-04-28 19:16:08 +07:00 INF] Executed DbCommand (7ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT EXISTS (
    SELECT 1 FROM pg_catalog.pg_class c
    JOIN pg_catalog.pg_namespace n ON n.oid=c.relnamespace
    WHERE n.nspname='public' AND
          c.relname='__EFMigrationsHistory'
) <s:Microsoft.EntityFrameworkCore.Database.Command>
[2024-04-28 19:16:08 +07:00 INF] Executed DbCommand (3ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT EXISTS (
    SELECT 1 FROM pg_catalog.pg_class c
    JOIN pg_catalog.pg_namespace n ON n.oid=c.relnamespace
    WHERE n.nspname='public' AND
          c.relname='__EFMigrationsHistory'
) <s:Microsoft.EntityFrameworkCore.Database.Command>
[2024-04-28 19:16:08 +07:00 INF] Executed DbCommand (2ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT "MigrationId", "ProductVersion"
FROM "__EFMigrationsHistory"
ORDER BY "MigrationId"; <s:Microsoft.EntityFrameworkCore.Database.Command>
[2024-04-28 19:16:08 +07:00 INF] No migrations were applied. The database is already up to date. <s:Microsoft.EntityFrameworkCore.Migrations>
[2024-04-28 19:16:08 +07:00 INF] User profile is available. Using 'C:\Users\danka\AppData\Local\ASP.NET\DataProtection-Keys' as key repository and Windows DPAPI to encrypt keys at rest. <s:Microsoft.AspNetCore.DataProtection.KeyManagement.XmlKeyManager>
[2024-04-28 19:16:08 +07:00 INF] Executed DbCommand (14ms) [Parameters=[@__normalizedName_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT a."Id", a."ConcurrencyStamp", a."Name", a."NormalizedName", a."RoleType"
FROM "AspNetRoles" AS a
WHERE a."NormalizedName" = @__normalizedName_0
LIMIT 1 <s:Microsoft.EntityFrameworkCore.Database.Command>
[2024-04-28 19:16:08 +07:00 INF] Executed DbCommand (2ms) [Parameters=[@__normalizedName_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT a."Id", a."ConcurrencyStamp", a."Name", a."NormalizedName", a."RoleType"
FROM "AspNetRoles" AS a
WHERE a."NormalizedName" = @__normalizedName_0
LIMIT 1 <s:Microsoft.EntityFrameworkCore.Database.Command>
[2024-04-28 19:16:09 +07:00 INF] Executed DbCommand (5ms) [Parameters=[@__normalizedEmail_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT a."Id", a."AccessFailedCount", a."ConcurrencyStamp", a."Discriminator", a."Email", a."EmailConfirmed", a."FullName", a."JoinedAt", a."LockoutEnabled", a."LockoutEnd", a."NormalizedEmail", a."NormalizedUserName", a."PasswordHash", a."PhoneNumber", a."PhoneNumberConfirmed", a."SecurityStamp", a."TwoFactorEnabled", a."UserName", a."CourseNumber", a."Group"
FROM "AspNetUsers" AS a
WHERE a."NormalizedEmail" = @__normalizedEmail_0
LIMIT 2 <s:Microsoft.EntityFrameworkCore.Database.Command>
[2024-04-28 19:16:09 +07:00 INF] Executed DbCommand (2ms) [Parameters=[@__normalizedEmail_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT a."Id", a."AccessFailedCount", a."ConcurrencyStamp", a."Discriminator", a."Email", a."EmailConfirmed", a."FullName", a."JoinedAt", a."LockoutEnabled", a."LockoutEnd", a."NormalizedEmail", a."NormalizedUserName", a."PasswordHash", a."PhoneNumber", a."PhoneNumberConfirmed", a."SecurityStamp", a."TwoFactorEnabled", a."UserName", a."CourseNumber", a."Group"
FROM "AspNetUsers" AS a
WHERE a."NormalizedEmail" = @__normalizedEmail_0
LIMIT 2 <s:Microsoft.EntityFrameworkCore.Database.Command>
[2024-04-28 19:16:09 +07:00 INF] Executed DbCommand (2ms) [Parameters=[@__normalizedRoleName_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT a."Id", a."ConcurrencyStamp", a."Name", a."NormalizedName", a."RoleType"
FROM "AspNetRoles" AS a
WHERE a."NormalizedName" = @__normalizedRoleName_0
LIMIT 2 <s:Microsoft.EntityFrameworkCore.Database.Command>
[2024-04-28 19:16:09 +07:00 INF] Executed DbCommand (4ms) [Parameters=[@__get_Item_0='?' (DbType = Guid), @__get_Item_1='?' (DbType = Guid)], CommandType='"Text"', CommandTimeout='30']
SELECT a."UserId", a."RoleId"
FROM "AspNetUserRoles" AS a
WHERE a."UserId" = @__get_Item_0 AND a."RoleId" = @__get_Item_1
LIMIT 1 <s:Microsoft.EntityFrameworkCore.Database.Command>
[2024-04-28 19:16:09 +07:00 INF] Now listening on: http://localhost:5105 <s:Microsoft.Hosting.Lifetime>
[2024-04-28 19:16:09 +07:00 INF] Application started. Press Ctrl+C to shut down. <s:Microsoft.Hosting.Lifetime>
[2024-04-28 19:16:09 +07:00 INF] Hosting environment: Development <s:Microsoft.Hosting.Lifetime>
[2024-04-28 19:16:09 +07:00 INF] Content root path: D:\prog\a_projects\back\Internship\Internship-system.API <s:Microsoft.Hosting.Lifetime>
[2024-04-28 19:16:10 +07:00 INF] Request starting HTTP/1.1 GET http://localhost:5105/swagger/index.html - null null <s:Microsoft.AspNetCore.Hosting.Diagnostics>
[2024-04-28 19:16:10 +07:00 INF] Request finished HTTP/1.1 GET http://localhost:5105/swagger/index.html - 200 null text/html;charset=utf-8 438.7801ms <s:Microsoft.AspNetCore.Hosting.Diagnostics>
[2024-04-28 19:16:10 +07:00 INF] Request starting HTTP/1.1 GET http://localhost:5105/swagger/v1/swagger.json - null null <s:Microsoft.AspNetCore.Hosting.Diagnostics>
[2024-04-28 19:16:11 +07:00 INF] Request finished HTTP/1.1 GET http://localhost:5105/swagger/v1/swagger.json - 200 null application/json;charset=utf-8 476.1834ms <s:Microsoft.AspNetCore.Hosting.Diagnostics>
[2024-04-28 19:16:23 +07:00 INF] Request starting HTTP/1.1 POST http://localhost:5105/admin/internship/students - multipart/form-data; boundary=----WebKitFormBoundaryUA3SX2i8g1oV8cMr 5077 <s:Microsoft.AspNetCore.Hosting.Diagnostics>
[2024-04-28 19:16:23 +07:00 WRN] Failed to determine the https port for redirect. <s:Microsoft.AspNetCore.HttpsPolicy.HttpsRedirectionMiddleware>
[2024-04-28 19:16:23 +07:00 INF] CORS policy execution successful. <s:Microsoft.AspNetCore.Cors.Infrastructure.CorsService>
[2024-04-28 19:16:23 +07:00 INF] Executing endpoint 'Internship_system.Controllers.InternshipAdminController.UploadStudents (Internship-system.API)' <s:Microsoft.AspNetCore.Routing.EndpointMiddleware>
[2024-04-28 19:16:24 +07:00 INF] Route matched with {action = "UploadStudents", controller = "InternshipAdmin"}. Executing controller action with signature System.Threading.Tasks.Task UploadStudents(Microsoft.AspNetCore.Http.IFormFile) on controller Internship_system.Controllers.InternshipAdminController (Internship-system.API). <s:Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker>
[2024-04-28 19:16:24 +07:00 INF] Executed DbCommand (3ms) [Parameters=[@__normalizedEmail_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT a."Id", a."AccessFailedCount", a."ConcurrencyStamp", a."Discriminator", a."Email", a."EmailConfirmed", a."FullName", a."JoinedAt", a."LockoutEnabled", a."LockoutEnd", a."NormalizedEmail", a."NormalizedUserName", a."PasswordHash", a."PhoneNumber", a."PhoneNumberConfirmed", a."SecurityStamp", a."TwoFactorEnabled", a."UserName", a."CourseNumber", a."Group"
FROM "AspNetUsers" AS a
WHERE a."NormalizedEmail" = @__normalizedEmail_0
LIMIT 2 <s:Microsoft.EntityFrameworkCore.Database.Command>
[2024-04-28 19:16:24 +07:00 INF] Executed DbCommand (3ms) [Parameters=[@__normalizedEmail_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT a."Id", a."AccessFailedCount", a."ConcurrencyStamp", a."Discriminator", a."Email", a."EmailConfirmed", a."FullName", a."JoinedAt", a."LockoutEnabled", a."LockoutEnd", a."NormalizedEmail", a."NormalizedUserName", a."PasswordHash", a."PhoneNumber", a."PhoneNumberConfirmed", a."SecurityStamp", a."TwoFactorEnabled", a."UserName", a."CourseNumber", a."Group"
FROM "AspNetUsers" AS a
WHERE a."NormalizedEmail" = @__normalizedEmail_0
LIMIT 2 <s:Microsoft.EntityFrameworkCore.Database.Command>
[2024-04-28 19:16:25 +07:00 INF] Executed DbCommand (3ms) [Parameters=[@__normalizedUserName_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT a."Id", a."AccessFailedCount", a."ConcurrencyStamp", a."Discriminator", a."Email", a."EmailConfirmed", a."FullName", a."JoinedAt", a."LockoutEnabled", a."LockoutEnd", a."NormalizedEmail", a."NormalizedUserName", a."PasswordHash", a."PhoneNumber", a."PhoneNumberConfirmed", a."SecurityStamp", a."TwoFactorEnabled", a."UserName", a."CourseNumber", a."Group"
FROM "AspNetUsers" AS a
WHERE a."NormalizedUserName" = @__normalizedUserName_0
LIMIT 1 <s:Microsoft.EntityFrameworkCore.Database.Command>
[2024-04-28 19:16:25 +07:00 INF] Executed DbCommand (41ms) [Parameters=[@p0='?' (DbType = Guid), @p1='?' (DbType = Int32), @p2='?', @p3='?' (DbType = Int32), @p4='?', @p5='?', @p6='?' (DbType = Boolean), @p7='?', @p8='?', @p9='?' (DbType = DateTime), @p10='?' (DbType = Boolean), @p11='?' (DbType = DateTime), @p12='?', @p13='?', @p14='?', @p15='?', @p16='?' (DbType = Boolean), @p17='?', @p18='?' (DbType = Boolean), @p19='?'], CommandType='"Text"', CommandTimeout='30']
INSERT INTO "AspNetUsers" ("Id", "AccessFailedCount", "ConcurrencyStamp", "CourseNumber", "Discriminator", "Email", "EmailConfirmed", "FullName", "Group", "JoinedAt", "LockoutEnabled", "LockoutEnd", "NormalizedEmail", "NormalizedUserName", "PasswordHash", "PhoneNumber", "PhoneNumberConfirmed", "SecurityStamp", "TwoFactorEnabled", "UserName")
VALUES (@p0, @p1, @p2, @p3, @p4, @p5, @p6, @p7, @p8, @p9, @p10, @p11, @p12, @p13, @p14, @p15, @p16, @p17, @p18, @p19); <s:Microsoft.EntityFrameworkCore.Database.Command>
[2024-04-28 19:16:25 +07:00 INF] Executed DbCommand (2ms) [Parameters=[@__normalizedRoleName_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT a."Id", a."ConcurrencyStamp", a."Name", a."NormalizedName", a."RoleType"
FROM "AspNetRoles" AS a
WHERE a."NormalizedName" = @__normalizedRoleName_0
LIMIT 2 <s:Microsoft.EntityFrameworkCore.Database.Command>
[2024-04-28 19:16:25 +07:00 INF] Executed DbCommand (2ms) [Parameters=[@__get_Item_0='?' (DbType = Guid), @__get_Item_1='?' (DbType = Guid)], CommandType='"Text"', CommandTimeout='30']
SELECT a."UserId", a."RoleId"
FROM "AspNetUserRoles" AS a
WHERE a."UserId" = @__get_Item_0 AND a."RoleId" = @__get_Item_1
LIMIT 1 <s:Microsoft.EntityFrameworkCore.Database.Command>
[2024-04-28 19:16:25 +07:00 INF] Executed DbCommand (2ms) [Parameters=[@__normalizedRoleName_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT a."Id", a."ConcurrencyStamp", a."Name", a."NormalizedName", a."RoleType"
FROM "AspNetRoles" AS a
WHERE a."NormalizedName" = @__normalizedRoleName_0
LIMIT 2 <s:Microsoft.EntityFrameworkCore.Database.Command>
[2024-04-28 19:16:25 +07:00 INF] Executed DbCommand (3ms) [Parameters=[@__normalizedUserName_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT a."Id", a."AccessFailedCount", a."ConcurrencyStamp", a."Discriminator", a."Email", a."EmailConfirmed", a."FullName", a."JoinedAt", a."LockoutEnabled", a."LockoutEnd", a."NormalizedEmail", a."NormalizedUserName", a."PasswordHash", a."PhoneNumber", a."PhoneNumberConfirmed", a."SecurityStamp", a."TwoFactorEnabled", a."UserName", a."CourseNumber", a."Group"
FROM "AspNetUsers" AS a
WHERE a."NormalizedUserName" = @__normalizedUserName_0
LIMIT 1 <s:Microsoft.EntityFrameworkCore.Database.Command>
[2024-04-28 19:16:25 +07:00 INF] Executed DbCommand (4ms) [Parameters=[@p0='?' (DbType = Guid), @p1='?' (DbType = Guid), @p20='?' (DbType = Guid), @p2='?' (DbType = Int32), @p3='?', @p21='?', @p4='?' (DbType = Int32), @p5='?', @p6='?' (DbType = Boolean), @p7='?', @p8='?', @p9='?' (DbType = DateTime), @p10='?' (DbType = Boolean), @p11='?' (DbType = DateTime), @p12='?', @p13='?', @p14='?', @p15='?', @p16='?' (DbType = Boolean), @p17='?', @p18='?' (DbType = Boolean), @p19='?'], CommandType='"Text"', CommandTimeout='30']
INSERT INTO "AspNetUserRoles" ("RoleId", "UserId")
VALUES (@p0, @p1);
UPDATE "AspNetUsers" SET "AccessFailedCount" = @p2, "ConcurrencyStamp" = @p3, "CourseNumber" = @p4, "Email" = @p5, "EmailConfirmed" = @p6, "FullName" = @p7, "Group" = @p8, "JoinedAt" = @p9, "LockoutEnabled" = @p10, "LockoutEnd" = @p11, "NormalizedEmail" = @p12, "NormalizedUserName" = @p13, "PasswordHash" = @p14, "PhoneNumber" = @p15, "PhoneNumberConfirmed" = @p16, "SecurityStamp" = @p17, "TwoFactorEnabled" = @p18, "UserName" = @p19
WHERE "Id" = @p20 AND "ConcurrencyStamp" = @p21; <s:Microsoft.EntityFrameworkCore.Database.Command>
[2024-04-28 19:16:25 +07:00 INF] Executed action Internship_system.Controllers.InternshipAdminController.UploadStudents (Internship-system.API) in 1787.9222ms <s:Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker>
[2024-04-28 19:16:25 +07:00 INF] Executed endpoint 'Internship_system.Controllers.InternshipAdminController.UploadStudents (Internship-system.API)' <s:Microsoft.AspNetCore.Routing.EndpointMiddleware>
[2024-04-28 19:16:25 +07:00 INF] Request finished HTTP/1.1 POST http://localhost:5105/admin/internship/students - 200 0 null 1981.1187ms <s:Microsoft.AspNetCore.Hosting.Diagnostics>
[2024-04-28 19:18:04 +07:00 INF] Executed DbCommand (179ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT EXISTS (
    SELECT 1 FROM pg_catalog.pg_class c
    JOIN pg_catalog.pg_namespace n ON n.oid=c.relnamespace
    WHERE n.nspname='public' AND
          c.relname='__EFMigrationsHistory'
) <s:Microsoft.EntityFrameworkCore.Database.Command>
[2024-04-28 19:18:04 +07:00 INF] Executed DbCommand (11ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT "MigrationId", "ProductVersion"
FROM "__EFMigrationsHistory"
ORDER BY "MigrationId"; <s:Microsoft.EntityFrameworkCore.Database.Command>
[2024-04-28 19:18:04 +07:00 INF] Executed DbCommand (3ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT EXISTS (
    SELECT 1 FROM pg_catalog.pg_class c
    JOIN pg_catalog.pg_namespace n ON n.oid=c.relnamespace
    WHERE n.nspname='public' AND
          c.relname='__EFMigrationsHistory'
) <s:Microsoft.EntityFrameworkCore.Database.Command>
[2024-04-28 19:18:04 +07:00 INF] Executed DbCommand (1ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT EXISTS (
    SELECT 1 FROM pg_catalog.pg_class c
    JOIN pg_catalog.pg_namespace n ON n.oid=c.relnamespace
    WHERE n.nspname='public' AND
          c.relname='__EFMigrationsHistory'
) <s:Microsoft.EntityFrameworkCore.Database.Command>
[2024-04-28 19:18:04 +07:00 INF] Executed DbCommand (1ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT "MigrationId", "ProductVersion"
FROM "__EFMigrationsHistory"
ORDER BY "MigrationId"; <s:Microsoft.EntityFrameworkCore.Database.Command>
[2024-04-28 19:18:04 +07:00 INF] No migrations were applied. The database is already up to date. <s:Microsoft.EntityFrameworkCore.Migrations>
[2024-04-28 19:18:04 +07:00 INF] User profile is available. Using 'C:\Users\danka\AppData\Local\ASP.NET\DataProtection-Keys' as key repository and Windows DPAPI to encrypt keys at rest. <s:Microsoft.AspNetCore.DataProtection.KeyManagement.XmlKeyManager>
[2024-04-28 19:18:05 +07:00 INF] Executed DbCommand (27ms) [Parameters=[@__normalizedName_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT a."Id", a."ConcurrencyStamp", a."Name", a."NormalizedName", a."RoleType"
FROM "AspNetRoles" AS a
WHERE a."NormalizedName" = @__normalizedName_0
LIMIT 1 <s:Microsoft.EntityFrameworkCore.Database.Command>
[2024-04-28 19:18:05 +07:00 INF] Executed DbCommand (1ms) [Parameters=[@__normalizedName_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT a."Id", a."ConcurrencyStamp", a."Name", a."NormalizedName", a."RoleType"
FROM "AspNetRoles" AS a
WHERE a."NormalizedName" = @__normalizedName_0
LIMIT 1 <s:Microsoft.EntityFrameworkCore.Database.Command>
[2024-04-28 19:18:05 +07:00 INF] Executed DbCommand (3ms) [Parameters=[@__normalizedEmail_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT a."Id", a."AccessFailedCount", a."ConcurrencyStamp", a."Discriminator", a."Email", a."EmailConfirmed", a."FullName", a."JoinedAt", a."LockoutEnabled", a."LockoutEnd", a."NormalizedEmail", a."NormalizedUserName", a."PasswordHash", a."PhoneNumber", a."PhoneNumberConfirmed", a."SecurityStamp", a."TwoFactorEnabled", a."UserName", a."CourseNumber", a."Group"
FROM "AspNetUsers" AS a
WHERE a."NormalizedEmail" = @__normalizedEmail_0
LIMIT 2 <s:Microsoft.EntityFrameworkCore.Database.Command>
[2024-04-28 19:18:05 +07:00 INF] Executed DbCommand (2ms) [Parameters=[@__normalizedEmail_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT a."Id", a."AccessFailedCount", a."ConcurrencyStamp", a."Discriminator", a."Email", a."EmailConfirmed", a."FullName", a."JoinedAt", a."LockoutEnabled", a."LockoutEnd", a."NormalizedEmail", a."NormalizedUserName", a."PasswordHash", a."PhoneNumber", a."PhoneNumberConfirmed", a."SecurityStamp", a."TwoFactorEnabled", a."UserName", a."CourseNumber", a."Group"
FROM "AspNetUsers" AS a
WHERE a."NormalizedEmail" = @__normalizedEmail_0
LIMIT 2 <s:Microsoft.EntityFrameworkCore.Database.Command>
[2024-04-28 19:18:05 +07:00 INF] Executed DbCommand (1ms) [Parameters=[@__normalizedRoleName_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT a."Id", a."ConcurrencyStamp", a."Name", a."NormalizedName", a."RoleType"
FROM "AspNetRoles" AS a
WHERE a."NormalizedName" = @__normalizedRoleName_0
LIMIT 2 <s:Microsoft.EntityFrameworkCore.Database.Command>
[2024-04-28 19:18:05 +07:00 INF] Executed DbCommand (4ms) [Parameters=[@__get_Item_0='?' (DbType = Guid), @__get_Item_1='?' (DbType = Guid)], CommandType='"Text"', CommandTimeout='30']
SELECT a."UserId", a."RoleId"
FROM "AspNetUserRoles" AS a
WHERE a."UserId" = @__get_Item_0 AND a."RoleId" = @__get_Item_1
LIMIT 1 <s:Microsoft.EntityFrameworkCore.Database.Command>
[2024-04-28 19:18:05 +07:00 INF] Now listening on: http://localhost:5105 <s:Microsoft.Hosting.Lifetime>
[2024-04-28 19:18:05 +07:00 INF] Application started. Press Ctrl+C to shut down. <s:Microsoft.Hosting.Lifetime>
[2024-04-28 19:18:05 +07:00 INF] Hosting environment: Development <s:Microsoft.Hosting.Lifetime>
[2024-04-28 19:18:05 +07:00 INF] Content root path: D:\prog\a_projects\back\Internship\Internship-system.API <s:Microsoft.Hosting.Lifetime>
[2024-04-28 19:18:06 +07:00 INF] Request starting HTTP/1.1 GET http://localhost:5105/swagger/index.html - null null <s:Microsoft.AspNetCore.Hosting.Diagnostics>
[2024-04-28 19:18:06 +07:00 INF] Request finished HTTP/1.1 GET http://localhost:5105/swagger/index.html - 200 null text/html;charset=utf-8 276.9575ms <s:Microsoft.AspNetCore.Hosting.Diagnostics>
[2024-04-28 19:18:06 +07:00 INF] Request starting HTTP/1.1 GET http://localhost:5105/swagger/v1/swagger.json - null null <s:Microsoft.AspNetCore.Hosting.Diagnostics>
[2024-04-28 19:18:07 +07:00 INF] Request finished HTTP/1.1 GET http://localhost:5105/swagger/v1/swagger.json - 200 null application/json;charset=utf-8 398.8214ms <s:Microsoft.AspNetCore.Hosting.Diagnostics>
[2024-04-28 19:18:13 +07:00 INF] Request starting HTTP/1.1 POST http://localhost:5105/admin/internship/students - multipart/form-data; boundary=----WebKitFormBoundaryNqDDtn7XzDfr0gpm 5077 <s:Microsoft.AspNetCore.Hosting.Diagnostics>
[2024-04-28 19:18:13 +07:00 WRN] Failed to determine the https port for redirect. <s:Microsoft.AspNetCore.HttpsPolicy.HttpsRedirectionMiddleware>
[2024-04-28 19:18:13 +07:00 INF] CORS policy execution successful. <s:Microsoft.AspNetCore.Cors.Infrastructure.CorsService>
[2024-04-28 19:18:13 +07:00 INF] Executing endpoint 'Internship_system.Controllers.InternshipAdminController.UploadStudents (Internship-system.API)' <s:Microsoft.AspNetCore.Routing.EndpointMiddleware>
[2024-04-28 19:18:13 +07:00 INF] Route matched with {action = "UploadStudents", controller = "InternshipAdmin"}. Executing controller action with signature System.Threading.Tasks.Task UploadStudents(Microsoft.AspNetCore.Http.IFormFile) on controller Internship_system.Controllers.InternshipAdminController (Internship-system.API). <s:Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker>
[2024-04-28 19:18:14 +07:00 INF] Executed DbCommand (2ms) [Parameters=[@__normalizedEmail_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT a."Id", a."AccessFailedCount", a."ConcurrencyStamp", a."Discriminator", a."Email", a."EmailConfirmed", a."FullName", a."JoinedAt", a."LockoutEnabled", a."LockoutEnd", a."NormalizedEmail", a."NormalizedUserName", a."PasswordHash", a."PhoneNumber", a."PhoneNumberConfirmed", a."SecurityStamp", a."TwoFactorEnabled", a."UserName", a."CourseNumber", a."Group"
FROM "AspNetUsers" AS a
WHERE a."NormalizedEmail" = @__normalizedEmail_0
LIMIT 2 <s:Microsoft.EntityFrameworkCore.Database.Command>
[2024-04-28 19:18:14 +07:00 INF] Executed DbCommand (1ms) [Parameters=[@__normalizedEmail_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT a."Id", a."AccessFailedCount", a."ConcurrencyStamp", a."Discriminator", a."Email", a."EmailConfirmed", a."FullName", a."JoinedAt", a."LockoutEnabled", a."LockoutEnd", a."NormalizedEmail", a."NormalizedUserName", a."PasswordHash", a."PhoneNumber", a."PhoneNumberConfirmed", a."SecurityStamp", a."TwoFactorEnabled", a."UserName", a."CourseNumber", a."Group"
FROM "AspNetUsers" AS a
WHERE a."NormalizedEmail" = @__normalizedEmail_0
LIMIT 2 <s:Microsoft.EntityFrameworkCore.Database.Command>
[2024-04-28 19:18:14 +07:00 INF] Executed action Internship_system.Controllers.InternshipAdminController.UploadStudents (Internship-system.API) in 962.9536ms <s:Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker>
[2024-04-28 19:18:14 +07:00 INF] Executed endpoint 'Internship_system.Controllers.InternshipAdminController.UploadStudents (Internship-system.API)' <s:Microsoft.AspNetCore.Routing.EndpointMiddleware>
[2024-04-28 19:18:14 +07:00 INF] Request finished HTTP/1.1 POST http://localhost:5105/admin/internship/students - 200 0 null 1081.3656ms <s:Microsoft.AspNetCore.Hosting.Diagnostics>
[2024-04-28 19:18:37 +07:00 INF] Application is shutting down... <s:Microsoft.Hosting.Lifetime>
[2024-04-28 19:18:49 +07:00 INF] Executed DbCommand (161ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT EXISTS (
    SELECT 1 FROM pg_catalog.pg_class c
    JOIN pg_catalog.pg_namespace n ON n.oid=c.relnamespace
    WHERE n.nspname='public' AND
          c.relname='__EFMigrationsHistory'
) <s:Microsoft.EntityFrameworkCore.Database.Command>
[2024-04-28 19:18:49 +07:00 INF] Executed DbCommand (9ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT "MigrationId", "ProductVersion"
FROM "__EFMigrationsHistory"
ORDER BY "MigrationId"; <s:Microsoft.EntityFrameworkCore.Database.Command>
[2024-04-28 19:18:49 +07:00 INF] Executed DbCommand (3ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT EXISTS (
    SELECT 1 FROM pg_catalog.pg_class c
    JOIN pg_catalog.pg_namespace n ON n.oid=c.relnamespace
    WHERE n.nspname='public' AND
          c.relname='__EFMigrationsHistory'
) <s:Microsoft.EntityFrameworkCore.Database.Command>
[2024-04-28 19:18:49 +07:00 INF] Executed DbCommand (2ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT EXISTS (
    SELECT 1 FROM pg_catalog.pg_class c
    JOIN pg_catalog.pg_namespace n ON n.oid=c.relnamespace
    WHERE n.nspname='public' AND
          c.relname='__EFMigrationsHistory'
) <s:Microsoft.EntityFrameworkCore.Database.Command>
[2024-04-28 19:18:49 +07:00 INF] Executed DbCommand (2ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT "MigrationId", "ProductVersion"
FROM "__EFMigrationsHistory"
ORDER BY "MigrationId"; <s:Microsoft.EntityFrameworkCore.Database.Command>
[2024-04-28 19:18:49 +07:00 INF] No migrations were applied. The database is already up to date. <s:Microsoft.EntityFrameworkCore.Migrations>
[2024-04-28 19:18:49 +07:00 INF] User profile is available. Using 'C:\Users\danka\AppData\Local\ASP.NET\DataProtection-Keys' as key repository and Windows DPAPI to encrypt keys at rest. <s:Microsoft.AspNetCore.DataProtection.KeyManagement.XmlKeyManager>
[2024-04-28 19:18:50 +07:00 INF] Executed DbCommand (19ms) [Parameters=[@__normalizedName_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT a."Id", a."ConcurrencyStamp", a."Name", a."NormalizedName", a."RoleType"
FROM "AspNetRoles" AS a
WHERE a."NormalizedName" = @__normalizedName_0
LIMIT 1 <s:Microsoft.EntityFrameworkCore.Database.Command>
[2024-04-28 19:18:50 +07:00 INF] Executed DbCommand (1ms) [Parameters=[@__normalizedName_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT a."Id", a."ConcurrencyStamp", a."Name", a."NormalizedName", a."RoleType"
FROM "AspNetRoles" AS a
WHERE a."NormalizedName" = @__normalizedName_0
LIMIT 1 <s:Microsoft.EntityFrameworkCore.Database.Command>
[2024-04-28 19:18:50 +07:00 INF] Executed DbCommand (4ms) [Parameters=[@__normalizedEmail_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT a."Id", a."AccessFailedCount", a."ConcurrencyStamp", a."Discriminator", a."Email", a."EmailConfirmed", a."FullName", a."JoinedAt", a."LockoutEnabled", a."LockoutEnd", a."NormalizedEmail", a."NormalizedUserName", a."PasswordHash", a."PhoneNumber", a."PhoneNumberConfirmed", a."SecurityStamp", a."TwoFactorEnabled", a."UserName", a."CourseNumber", a."Group"
FROM "AspNetUsers" AS a
WHERE a."NormalizedEmail" = @__normalizedEmail_0
LIMIT 2 <s:Microsoft.EntityFrameworkCore.Database.Command>
[2024-04-28 19:18:50 +07:00 INF] Executed DbCommand (1ms) [Parameters=[@__normalizedEmail_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT a."Id", a."AccessFailedCount", a."ConcurrencyStamp", a."Discriminator", a."Email", a."EmailConfirmed", a."FullName", a."JoinedAt", a."LockoutEnabled", a."LockoutEnd", a."NormalizedEmail", a."NormalizedUserName", a."PasswordHash", a."PhoneNumber", a."PhoneNumberConfirmed", a."SecurityStamp", a."TwoFactorEnabled", a."UserName", a."CourseNumber", a."Group"
FROM "AspNetUsers" AS a
WHERE a."NormalizedEmail" = @__normalizedEmail_0
LIMIT 2 <s:Microsoft.EntityFrameworkCore.Database.Command>
[2024-04-28 19:18:50 +07:00 INF] Executed DbCommand (1ms) [Parameters=[@__normalizedRoleName_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT a."Id", a."ConcurrencyStamp", a."Name", a."NormalizedName", a."RoleType"
FROM "AspNetRoles" AS a
WHERE a."NormalizedName" = @__normalizedRoleName_0
LIMIT 2 <s:Microsoft.EntityFrameworkCore.Database.Command>
[2024-04-28 19:18:50 +07:00 INF] Executed DbCommand (4ms) [Parameters=[@__get_Item_0='?' (DbType = Guid), @__get_Item_1='?' (DbType = Guid)], CommandType='"Text"', CommandTimeout='30']
SELECT a."UserId", a."RoleId"
FROM "AspNetUserRoles" AS a
WHERE a."UserId" = @__get_Item_0 AND a."RoleId" = @__get_Item_1
LIMIT 1 <s:Microsoft.EntityFrameworkCore.Database.Command>
[2024-04-28 19:18:50 +07:00 INF] Now listening on: http://localhost:5105 <s:Microsoft.Hosting.Lifetime>
[2024-04-28 19:18:50 +07:00 INF] Application started. Press Ctrl+C to shut down. <s:Microsoft.Hosting.Lifetime>
[2024-04-28 19:18:50 +07:00 INF] Hosting environment: Development <s:Microsoft.Hosting.Lifetime>
[2024-04-28 19:18:50 +07:00 INF] Content root path: D:\prog\a_projects\back\Internship\Internship-system.API <s:Microsoft.Hosting.Lifetime>
[2024-04-28 19:18:50 +07:00 INF] Request starting HTTP/1.1 GET http://localhost:5105/swagger/index.html - null null <s:Microsoft.AspNetCore.Hosting.Diagnostics>
[2024-04-28 19:18:51 +07:00 INF] Request finished HTTP/1.1 GET http://localhost:5105/swagger/index.html - 200 null text/html;charset=utf-8 320.6406ms <s:Microsoft.AspNetCore.Hosting.Diagnostics>
[2024-04-28 19:18:51 +07:00 INF] Request starting HTTP/1.1 GET http://localhost:5105/swagger/v1/swagger.json - null null <s:Microsoft.AspNetCore.Hosting.Diagnostics>
[2024-04-28 19:18:51 +07:00 INF] Request finished HTTP/1.1 GET http://localhost:5105/swagger/v1/swagger.json - 200 null application/json;charset=utf-8 454.3357ms <s:Microsoft.AspNetCore.Hosting.Diagnostics>
[2024-04-28 19:18:55 +07:00 INF] Request starting HTTP/1.1 POST http://localhost:5105/admin/internship/students - multipart/form-data; boundary=----WebKitFormBoundary6ARwpFzjsN3sNPuQ 5077 <s:Microsoft.AspNetCore.Hosting.Diagnostics>
[2024-04-28 19:18:55 +07:00 WRN] Failed to determine the https port for redirect. <s:Microsoft.AspNetCore.HttpsPolicy.HttpsRedirectionMiddleware>
[2024-04-28 19:18:55 +07:00 INF] CORS policy execution successful. <s:Microsoft.AspNetCore.Cors.Infrastructure.CorsService>
[2024-04-28 19:18:55 +07:00 INF] Executing endpoint 'Internship_system.Controllers.InternshipAdminController.UploadStudents (Internship-system.API)' <s:Microsoft.AspNetCore.Routing.EndpointMiddleware>
[2024-04-28 19:18:55 +07:00 INF] Route matched with {action = "UploadStudents", controller = "InternshipAdmin"}. Executing controller action with signature System.Threading.Tasks.Task UploadStudents(Microsoft.AspNetCore.Http.IFormFile) on controller Internship_system.Controllers.InternshipAdminController (Internship-system.API). <s:Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker>
[2024-04-28 19:18:56 +07:00 INF] Executed DbCommand (2ms) [Parameters=[@__normalizedEmail_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT a."Id", a."AccessFailedCount", a."ConcurrencyStamp", a."Discriminator", a."Email", a."EmailConfirmed", a."FullName", a."JoinedAt", a."LockoutEnabled", a."LockoutEnd", a."NormalizedEmail", a."NormalizedUserName", a."PasswordHash", a."PhoneNumber", a."PhoneNumberConfirmed", a."SecurityStamp", a."TwoFactorEnabled", a."UserName", a."CourseNumber", a."Group"
FROM "AspNetUsers" AS a
WHERE a."NormalizedEmail" = @__normalizedEmail_0
LIMIT 2 <s:Microsoft.EntityFrameworkCore.Database.Command>
[2024-04-28 19:18:57 +07:00 INF] Executed DbCommand (2ms) [Parameters=[@__normalizedUserName_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT a."Id", a."AccessFailedCount", a."ConcurrencyStamp", a."Discriminator", a."Email", a."EmailConfirmed", a."FullName", a."JoinedAt", a."LockoutEnabled", a."LockoutEnd", a."NormalizedEmail", a."NormalizedUserName", a."PasswordHash", a."PhoneNumber", a."PhoneNumberConfirmed", a."SecurityStamp", a."TwoFactorEnabled", a."UserName", a."CourseNumber", a."Group"
FROM "AspNetUsers" AS a
WHERE a."NormalizedUserName" = @__normalizedUserName_0
LIMIT 1 <s:Microsoft.EntityFrameworkCore.Database.Command>
[2024-04-28 19:18:57 +07:00 INF] Executed DbCommand (49ms) [Parameters=[@p0='?' (DbType = Guid), @p1='?' (DbType = Int32), @p2='?', @p3='?' (DbType = Int32), @p4='?', @p5='?', @p6='?' (DbType = Boolean), @p7='?', @p8='?', @p9='?' (DbType = DateTime), @p10='?' (DbType = Boolean), @p11='?' (DbType = DateTime), @p12='?', @p13='?', @p14='?', @p15='?', @p16='?' (DbType = Boolean), @p17='?', @p18='?' (DbType = Boolean), @p19='?'], CommandType='"Text"', CommandTimeout='30']
INSERT INTO "AspNetUsers" ("Id", "AccessFailedCount", "ConcurrencyStamp", "CourseNumber", "Discriminator", "Email", "EmailConfirmed", "FullName", "Group", "JoinedAt", "LockoutEnabled", "LockoutEnd", "NormalizedEmail", "NormalizedUserName", "PasswordHash", "PhoneNumber", "PhoneNumberConfirmed", "SecurityStamp", "TwoFactorEnabled", "UserName")
VALUES (@p0, @p1, @p2, @p3, @p4, @p5, @p6, @p7, @p8, @p9, @p10, @p11, @p12, @p13, @p14, @p15, @p16, @p17, @p18, @p19); <s:Microsoft.EntityFrameworkCore.Database.Command>
[2024-04-28 19:18:57 +07:00 INF] Executed DbCommand (1ms) [Parameters=[@__normalizedRoleName_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT a."Id", a."ConcurrencyStamp", a."Name", a."NormalizedName", a."RoleType"
FROM "AspNetRoles" AS a
WHERE a."NormalizedName" = @__normalizedRoleName_0
LIMIT 2 <s:Microsoft.EntityFrameworkCore.Database.Command>
[2024-04-28 19:18:57 +07:00 INF] Executed DbCommand (1ms) [Parameters=[@__get_Item_0='?' (DbType = Guid), @__get_Item_1='?' (DbType = Guid)], CommandType='"Text"', CommandTimeout='30']
SELECT a."UserId", a."RoleId"
FROM "AspNetUserRoles" AS a
WHERE a."UserId" = @__get_Item_0 AND a."RoleId" = @__get_Item_1
LIMIT 1 <s:Microsoft.EntityFrameworkCore.Database.Command>
[2024-04-28 19:18:57 +07:00 INF] Executed DbCommand (1ms) [Parameters=[@__normalizedRoleName_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT a."Id", a."ConcurrencyStamp", a."Name", a."NormalizedName", a."RoleType"
FROM "AspNetRoles" AS a
WHERE a."NormalizedName" = @__normalizedRoleName_0
LIMIT 2 <s:Microsoft.EntityFrameworkCore.Database.Command>
[2024-04-28 19:18:57 +07:00 INF] Executed DbCommand (2ms) [Parameters=[@__normalizedUserName_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT a."Id", a."AccessFailedCount", a."ConcurrencyStamp", a."Discriminator", a."Email", a."EmailConfirmed", a."FullName", a."JoinedAt", a."LockoutEnabled", a."LockoutEnd", a."NormalizedEmail", a."NormalizedUserName", a."PasswordHash", a."PhoneNumber", a."PhoneNumberConfirmed", a."SecurityStamp", a."TwoFactorEnabled", a."UserName", a."CourseNumber", a."Group"
FROM "AspNetUsers" AS a
WHERE a."NormalizedUserName" = @__normalizedUserName_0
LIMIT 1 <s:Microsoft.EntityFrameworkCore.Database.Command>
[2024-04-28 19:18:58 +07:00 INF] Executed DbCommand (3ms) [Parameters=[@p0='?' (DbType = Guid), @p1='?' (DbType = Guid), @p20='?' (DbType = Guid), @p2='?' (DbType = Int32), @p3='?', @p21='?', @p4='?' (DbType = Int32), @p5='?', @p6='?' (DbType = Boolean), @p7='?', @p8='?', @p9='?' (DbType = DateTime), @p10='?' (DbType = Boolean), @p11='?' (DbType = DateTime), @p12='?', @p13='?', @p14='?', @p15='?', @p16='?' (DbType = Boolean), @p17='?', @p18='?' (DbType = Boolean), @p19='?'], CommandType='"Text"', CommandTimeout='30']
INSERT INTO "AspNetUserRoles" ("RoleId", "UserId")
VALUES (@p0, @p1);
UPDATE "AspNetUsers" SET "AccessFailedCount" = @p2, "ConcurrencyStamp" = @p3, "CourseNumber" = @p4, "Email" = @p5, "EmailConfirmed" = @p6, "FullName" = @p7, "Group" = @p8, "JoinedAt" = @p9, "LockoutEnabled" = @p10, "LockoutEnd" = @p11, "NormalizedEmail" = @p12, "NormalizedUserName" = @p13, "PasswordHash" = @p14, "PhoneNumber" = @p15, "PhoneNumberConfirmed" = @p16, "SecurityStamp" = @p17, "TwoFactorEnabled" = @p18, "UserName" = @p19
WHERE "Id" = @p20 AND "ConcurrencyStamp" = @p21; <s:Microsoft.EntityFrameworkCore.Database.Command>
[2024-04-28 19:18:58 +07:00 INF] Executed DbCommand (1ms) [Parameters=[@__normalizedEmail_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT a."Id", a."AccessFailedCount", a."ConcurrencyStamp", a."Discriminator", a."Email", a."EmailConfirmed", a."FullName", a."JoinedAt", a."LockoutEnabled", a."LockoutEnd", a."NormalizedEmail", a."NormalizedUserName", a."PasswordHash", a."PhoneNumber", a."PhoneNumberConfirmed", a."SecurityStamp", a."TwoFactorEnabled", a."UserName", a."CourseNumber", a."Group"
FROM "AspNetUsers" AS a
WHERE a."NormalizedEmail" = @__normalizedEmail_0
LIMIT 2 <s:Microsoft.EntityFrameworkCore.Database.Command>
[2024-04-28 19:18:58 +07:00 INF] Executed DbCommand (1ms) [Parameters=[@__normalizedUserName_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT a."Id", a."AccessFailedCount", a."ConcurrencyStamp", a."Discriminator", a."Email", a."EmailConfirmed", a."FullName", a."JoinedAt", a."LockoutEnabled", a."LockoutEnd", a."NormalizedEmail", a."NormalizedUserName", a."PasswordHash", a."PhoneNumber", a."PhoneNumberConfirmed", a."SecurityStamp", a."TwoFactorEnabled", a."UserName", a."CourseNumber", a."Group"
FROM "AspNetUsers" AS a
WHERE a."NormalizedUserName" = @__normalizedUserName_0
LIMIT 1 <s:Microsoft.EntityFrameworkCore.Database.Command>
[2024-04-28 19:18:58 +07:00 INF] Executed DbCommand (35ms) [Parameters=[@p0='?' (DbType = Guid), @p1='?' (DbType = Int32), @p2='?', @p3='?' (DbType = Int32), @p4='?', @p5='?', @p6='?' (DbType = Boolean), @p7='?', @p8='?', @p9='?' (DbType = DateTime), @p10='?' (DbType = Boolean), @p11='?' (DbType = DateTime), @p12='?', @p13='?', @p14='?', @p15='?', @p16='?' (DbType = Boolean), @p17='?', @p18='?' (DbType = Boolean), @p19='?'], CommandType='"Text"', CommandTimeout='30']
INSERT INTO "AspNetUsers" ("Id", "AccessFailedCount", "ConcurrencyStamp", "CourseNumber", "Discriminator", "Email", "EmailConfirmed", "FullName", "Group", "JoinedAt", "LockoutEnabled", "LockoutEnd", "NormalizedEmail", "NormalizedUserName", "PasswordHash", "PhoneNumber", "PhoneNumberConfirmed", "SecurityStamp", "TwoFactorEnabled", "UserName")
VALUES (@p0, @p1, @p2, @p3, @p4, @p5, @p6, @p7, @p8, @p9, @p10, @p11, @p12, @p13, @p14, @p15, @p16, @p17, @p18, @p19); <s:Microsoft.EntityFrameworkCore.Database.Command>
[2024-04-28 19:18:58 +07:00 INF] Executed DbCommand (1ms) [Parameters=[@__normalizedRoleName_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT a."Id", a."ConcurrencyStamp", a."Name", a."NormalizedName", a."RoleType"
FROM "AspNetRoles" AS a
WHERE a."NormalizedName" = @__normalizedRoleName_0
LIMIT 2 <s:Microsoft.EntityFrameworkCore.Database.Command>
[2024-04-28 19:18:58 +07:00 INF] Executed DbCommand (1ms) [Parameters=[@__get_Item_0='?' (DbType = Guid), @__get_Item_1='?' (DbType = Guid)], CommandType='"Text"', CommandTimeout='30']
SELECT a."UserId", a."RoleId"
FROM "AspNetUserRoles" AS a
WHERE a."UserId" = @__get_Item_0 AND a."RoleId" = @__get_Item_1
LIMIT 1 <s:Microsoft.EntityFrameworkCore.Database.Command>
[2024-04-28 19:18:58 +07:00 INF] Executed DbCommand (1ms) [Parameters=[@__normalizedRoleName_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT a."Id", a."ConcurrencyStamp", a."Name", a."NormalizedName", a."RoleType"
FROM "AspNetRoles" AS a
WHERE a."NormalizedName" = @__normalizedRoleName_0
LIMIT 2 <s:Microsoft.EntityFrameworkCore.Database.Command>
[2024-04-28 19:18:58 +07:00 INF] Executed DbCommand (1ms) [Parameters=[@__normalizedUserName_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT a."Id", a."AccessFailedCount", a."ConcurrencyStamp", a."Discriminator", a."Email", a."EmailConfirmed", a."FullName", a."JoinedAt", a."LockoutEnabled", a."LockoutEnd", a."NormalizedEmail", a."NormalizedUserName", a."PasswordHash", a."PhoneNumber", a."PhoneNumberConfirmed", a."SecurityStamp", a."TwoFactorEnabled", a."UserName", a."CourseNumber", a."Group"
FROM "AspNetUsers" AS a
WHERE a."NormalizedUserName" = @__normalizedUserName_0
LIMIT 1 <s:Microsoft.EntityFrameworkCore.Database.Command>
[2024-04-28 19:18:58 +07:00 INF] Executed DbCommand (1ms) [Parameters=[@p0='?' (DbType = Guid), @p1='?' (DbType = Guid), @p20='?' (DbType = Guid), @p2='?' (DbType = Int32), @p3='?', @p21='?', @p4='?' (DbType = Int32), @p5='?', @p6='?' (DbType = Boolean), @p7='?', @p8='?', @p9='?' (DbType = DateTime), @p10='?' (DbType = Boolean), @p11='?' (DbType = DateTime), @p12='?', @p13='?', @p14='?', @p15='?', @p16='?' (DbType = Boolean), @p17='?', @p18='?' (DbType = Boolean), @p19='?'], CommandType='"Text"', CommandTimeout='30']
INSERT INTO "AspNetUserRoles" ("RoleId", "UserId")
VALUES (@p0, @p1);
UPDATE "AspNetUsers" SET "AccessFailedCount" = @p2, "ConcurrencyStamp" = @p3, "CourseNumber" = @p4, "Email" = @p5, "EmailConfirmed" = @p6, "FullName" = @p7, "Group" = @p8, "JoinedAt" = @p9, "LockoutEnabled" = @p10, "LockoutEnd" = @p11, "NormalizedEmail" = @p12, "NormalizedUserName" = @p13, "PasswordHash" = @p14, "PhoneNumber" = @p15, "PhoneNumberConfirmed" = @p16, "SecurityStamp" = @p17, "TwoFactorEnabled" = @p18, "UserName" = @p19
WHERE "Id" = @p20 AND "ConcurrencyStamp" = @p21; <s:Microsoft.EntityFrameworkCore.Database.Command>
[2024-04-28 19:18:58 +07:00 INF] Executed action Internship_system.Controllers.InternshipAdminController.UploadStudents (Internship-system.API) in 2569.2954ms <s:Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker>
[2024-04-28 19:18:58 +07:00 INF] Executed endpoint 'Internship_system.Controllers.InternshipAdminController.UploadStudents (Internship-system.API)' <s:Microsoft.AspNetCore.Routing.EndpointMiddleware>
[2024-04-28 19:18:58 +07:00 INF] Request finished HTTP/1.1 POST http://localhost:5105/admin/internship/students - 200 0 null 2676.3118ms <s:Microsoft.AspNetCore.Hosting.Diagnostics>
[2024-04-28 19:26:07 +07:00 INF] Application is shutting down... <s:Microsoft.Hosting.Lifetime>
[2024-04-28 19:26:18 +07:00 INF] Executed DbCommand (232ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT EXISTS (
    SELECT 1 FROM pg_catalog.pg_class c
    JOIN pg_catalog.pg_namespace n ON n.oid=c.relnamespace
    WHERE n.nspname='public' AND
          c.relname='__EFMigrationsHistory'
) <s:Microsoft.EntityFrameworkCore.Database.Command>
[2024-04-28 19:26:19 +07:00 INF] Executed DbCommand (22ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT "MigrationId", "ProductVersion"
FROM "__EFMigrationsHistory"
ORDER BY "MigrationId"; <s:Microsoft.EntityFrameworkCore.Database.Command>
[2024-04-28 19:26:19 +07:00 INF] Executed DbCommand (5ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT EXISTS (
    SELECT 1 FROM pg_catalog.pg_class c
    JOIN pg_catalog.pg_namespace n ON n.oid=c.relnamespace
    WHERE n.nspname='public' AND
          c.relname='__EFMigrationsHistory'
) <s:Microsoft.EntityFrameworkCore.Database.Command>
[2024-04-28 19:26:19 +07:00 INF] Executed DbCommand (2ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT EXISTS (
    SELECT 1 FROM pg_catalog.pg_class c
    JOIN pg_catalog.pg_namespace n ON n.oid=c.relnamespace
    WHERE n.nspname='public' AND
          c.relname='__EFMigrationsHistory'
) <s:Microsoft.EntityFrameworkCore.Database.Command>
[2024-04-28 19:26:19 +07:00 INF] Executed DbCommand (2ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT "MigrationId", "ProductVersion"
FROM "__EFMigrationsHistory"
ORDER BY "MigrationId"; <s:Microsoft.EntityFrameworkCore.Database.Command>
[2024-04-28 19:26:19 +07:00 INF] No migrations were applied. The database is already up to date. <s:Microsoft.EntityFrameworkCore.Migrations>
[2024-04-28 19:26:19 +07:00 INF] User profile is available. Using 'C:\Users\danka\AppData\Local\ASP.NET\DataProtection-Keys' as key repository and Windows DPAPI to encrypt keys at rest. <s:Microsoft.AspNetCore.DataProtection.KeyManagement.XmlKeyManager>
[2024-04-28 19:26:19 +07:00 INF] Executed DbCommand (20ms) [Parameters=[@__normalizedName_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT a."Id", a."ConcurrencyStamp", a."Name", a."NormalizedName", a."RoleType"
FROM "AspNetRoles" AS a
WHERE a."NormalizedName" = @__normalizedName_0
LIMIT 1 <s:Microsoft.EntityFrameworkCore.Database.Command>
[2024-04-28 19:26:20 +07:00 INF] Executed DbCommand (1ms) [Parameters=[@__normalizedName_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT a."Id", a."ConcurrencyStamp", a."Name", a."NormalizedName", a."RoleType"
FROM "AspNetRoles" AS a
WHERE a."NormalizedName" = @__normalizedName_0
LIMIT 1 <s:Microsoft.EntityFrameworkCore.Database.Command>
[2024-04-28 19:26:20 +07:00 INF] Executed DbCommand (6ms) [Parameters=[@__normalizedEmail_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT a."Id", a."AccessFailedCount", a."ConcurrencyStamp", a."Discriminator", a."Email", a."EmailConfirmed", a."FullName", a."JoinedAt", a."LockoutEnabled", a."LockoutEnd", a."NormalizedEmail", a."NormalizedUserName", a."PasswordHash", a."PhoneNumber", a."PhoneNumberConfirmed", a."SecurityStamp", a."TwoFactorEnabled", a."UserName", a."CourseNumber", a."Group"
FROM "AspNetUsers" AS a
WHERE a."NormalizedEmail" = @__normalizedEmail_0
LIMIT 2 <s:Microsoft.EntityFrameworkCore.Database.Command>
[2024-04-28 19:26:20 +07:00 INF] Executed DbCommand (2ms) [Parameters=[@__normalizedEmail_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT a."Id", a."AccessFailedCount", a."ConcurrencyStamp", a."Discriminator", a."Email", a."EmailConfirmed", a."FullName", a."JoinedAt", a."LockoutEnabled", a."LockoutEnd", a."NormalizedEmail", a."NormalizedUserName", a."PasswordHash", a."PhoneNumber", a."PhoneNumberConfirmed", a."SecurityStamp", a."TwoFactorEnabled", a."UserName", a."CourseNumber", a."Group"
FROM "AspNetUsers" AS a
WHERE a."NormalizedEmail" = @__normalizedEmail_0
LIMIT 2 <s:Microsoft.EntityFrameworkCore.Database.Command>
[2024-04-28 19:26:20 +07:00 INF] Executed DbCommand (1ms) [Parameters=[@__normalizedRoleName_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT a."Id", a."ConcurrencyStamp", a."Name", a."NormalizedName", a."RoleType"
FROM "AspNetRoles" AS a
WHERE a."NormalizedName" = @__normalizedRoleName_0
LIMIT 2 <s:Microsoft.EntityFrameworkCore.Database.Command>
[2024-04-28 19:26:20 +07:00 INF] Executed DbCommand (8ms) [Parameters=[@__get_Item_0='?' (DbType = Guid), @__get_Item_1='?' (DbType = Guid)], CommandType='"Text"', CommandTimeout='30']
SELECT a."UserId", a."RoleId"
FROM "AspNetUserRoles" AS a
WHERE a."UserId" = @__get_Item_0 AND a."RoleId" = @__get_Item_1
LIMIT 1 <s:Microsoft.EntityFrameworkCore.Database.Command>
[2024-04-28 19:26:20 +07:00 INF] Now listening on: http://localhost:5105 <s:Microsoft.Hosting.Lifetime>
[2024-04-28 19:26:20 +07:00 INF] Application started. Press Ctrl+C to shut down. <s:Microsoft.Hosting.Lifetime>
[2024-04-28 19:26:20 +07:00 INF] Hosting environment: Development <s:Microsoft.Hosting.Lifetime>
[2024-04-28 19:26:20 +07:00 INF] Content root path: D:\prog\a_projects\back\Internship\Internship-system.API <s:Microsoft.Hosting.Lifetime>
[2024-04-28 19:26:21 +07:00 INF] Request starting HTTP/1.1 GET http://localhost:5105/swagger/index.html - null null <s:Microsoft.AspNetCore.Hosting.Diagnostics>
[2024-04-28 19:26:22 +07:00 INF] Request finished HTTP/1.1 GET http://localhost:5105/swagger/index.html - 200 null text/html;charset=utf-8 345.7742ms <s:Microsoft.AspNetCore.Hosting.Diagnostics>
[2024-04-28 19:26:22 +07:00 INF] Request starting HTTP/1.1 GET http://localhost:5105/swagger/v1/swagger.json - null null <s:Microsoft.AspNetCore.Hosting.Diagnostics>
[2024-04-28 19:26:22 +07:00 INF] Request finished HTTP/1.1 GET http://localhost:5105/swagger/v1/swagger.json - 200 null application/json;charset=utf-8 470.4373ms <s:Microsoft.AspNetCore.Hosting.Diagnostics>
[2024-04-28 19:26:44 +07:00 INF] Request starting HTTP/1.1 POST http://localhost:5105/admin/internship/students - multipart/form-data; boundary=----WebKitFormBoundarySaQkfSu3gzcp8HJ1 5077 <s:Microsoft.AspNetCore.Hosting.Diagnostics>
[2024-04-28 19:26:44 +07:00 WRN] Failed to determine the https port for redirect. <s:Microsoft.AspNetCore.HttpsPolicy.HttpsRedirectionMiddleware>
[2024-04-28 19:26:44 +07:00 INF] CORS policy execution successful. <s:Microsoft.AspNetCore.Cors.Infrastructure.CorsService>
[2024-04-28 19:26:44 +07:00 INF] Executing endpoint 'Internship_system.Controllers.InternshipAdminController.UploadStudents (Internship-system.API)' <s:Microsoft.AspNetCore.Routing.EndpointMiddleware>
[2024-04-28 19:26:44 +07:00 INF] Route matched with {action = "UploadStudents", controller = "InternshipAdmin"}. Executing controller action with signature System.Threading.Tasks.Task UploadStudents(Microsoft.AspNetCore.Http.IFormFile) on controller Internship_system.Controllers.InternshipAdminController (Internship-system.API). <s:Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker>
[2024-04-28 19:26:45 +07:00 INF] Executed DbCommand (1ms) [Parameters=[@__normalizedEmail_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT a."Id", a."AccessFailedCount", a."ConcurrencyStamp", a."Discriminator", a."Email", a."EmailConfirmed", a."FullName", a."JoinedAt", a."LockoutEnabled", a."LockoutEnd", a."NormalizedEmail", a."NormalizedUserName", a."PasswordHash", a."PhoneNumber", a."PhoneNumberConfirmed", a."SecurityStamp", a."TwoFactorEnabled", a."UserName", a."CourseNumber", a."Group"
FROM "AspNetUsers" AS a
WHERE a."NormalizedEmail" = @__normalizedEmail_0
LIMIT 2 <s:Microsoft.EntityFrameworkCore.Database.Command>
[2024-04-28 19:26:45 +07:00 INF] Executed DbCommand (2ms) [Parameters=[@__normalizedUserName_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT a."Id", a."AccessFailedCount", a."ConcurrencyStamp", a."Discriminator", a."Email", a."EmailConfirmed", a."FullName", a."JoinedAt", a."LockoutEnabled", a."LockoutEnd", a."NormalizedEmail", a."NormalizedUserName", a."PasswordHash", a."PhoneNumber", a."PhoneNumberConfirmed", a."SecurityStamp", a."TwoFactorEnabled", a."UserName", a."CourseNumber", a."Group"
FROM "AspNetUsers" AS a
WHERE a."NormalizedUserName" = @__normalizedUserName_0
LIMIT 1 <s:Microsoft.EntityFrameworkCore.Database.Command>
[2024-04-28 19:26:45 +07:00 INF] Executed DbCommand (48ms) [Parameters=[@p18='?' (DbType = Guid), @p0='?' (DbType = Int32), @p1='?', @p19='?', @p2='?' (DbType = Int32), @p3='?', @p4='?' (DbType = Boolean), @p5='?', @p6='?', @p7='?' (DbType = DateTime), @p8='?' (DbType = Boolean), @p9='?' (DbType = DateTime), @p10='?', @p11='?', @p12='?', @p13='?', @p14='?' (DbType = Boolean), @p15='?', @p16='?' (DbType = Boolean), @p17='?'], CommandType='"Text"', CommandTimeout='30']
UPDATE "AspNetUsers" SET "AccessFailedCount" = @p0, "ConcurrencyStamp" = @p1, "CourseNumber" = @p2, "Email" = @p3, "EmailConfirmed" = @p4, "FullName" = @p5, "Group" = @p6, "JoinedAt" = @p7, "LockoutEnabled" = @p8, "LockoutEnd" = @p9, "NormalizedEmail" = @p10, "NormalizedUserName" = @p11, "PasswordHash" = @p12, "PhoneNumber" = @p13, "PhoneNumberConfirmed" = @p14, "SecurityStamp" = @p15, "TwoFactorEnabled" = @p16, "UserName" = @p17
WHERE "Id" = @p18 AND "ConcurrencyStamp" = @p19; <s:Microsoft.EntityFrameworkCore.Database.Command>
[2024-04-28 19:26:45 +07:00 INF] Executed DbCommand (1ms) [Parameters=[@__normalizedEmail_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT a."Id", a."AccessFailedCount", a."ConcurrencyStamp", a."Discriminator", a."Email", a."EmailConfirmed", a."FullName", a."JoinedAt", a."LockoutEnabled", a."LockoutEnd", a."NormalizedEmail", a."NormalizedUserName", a."PasswordHash", a."PhoneNumber", a."PhoneNumberConfirmed", a."SecurityStamp", a."TwoFactorEnabled", a."UserName", a."CourseNumber", a."Group"
FROM "AspNetUsers" AS a
WHERE a."NormalizedEmail" = @__normalizedEmail_0
LIMIT 2 <s:Microsoft.EntityFrameworkCore.Database.Command>
[2024-04-28 19:26:45 +07:00 INF] Executed DbCommand (1ms) [Parameters=[@__normalizedUserName_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT a."Id", a."AccessFailedCount", a."ConcurrencyStamp", a."Discriminator", a."Email", a."EmailConfirmed", a."FullName", a."JoinedAt", a."LockoutEnabled", a."LockoutEnd", a."NormalizedEmail", a."NormalizedUserName", a."PasswordHash", a."PhoneNumber", a."PhoneNumberConfirmed", a."SecurityStamp", a."TwoFactorEnabled", a."UserName", a."CourseNumber", a."Group"
FROM "AspNetUsers" AS a
WHERE a."NormalizedUserName" = @__normalizedUserName_0
LIMIT 1 <s:Microsoft.EntityFrameworkCore.Database.Command>
[2024-04-28 19:26:45 +07:00 INF] Executed DbCommand (2ms) [Parameters=[@p18='?' (DbType = Guid), @p0='?' (DbType = Int32), @p1='?', @p19='?', @p2='?' (DbType = Int32), @p3='?', @p4='?' (DbType = Boolean), @p5='?', @p6='?', @p7='?' (DbType = DateTime), @p8='?' (DbType = Boolean), @p9='?' (DbType = DateTime), @p10='?', @p11='?', @p12='?', @p13='?', @p14='?' (DbType = Boolean), @p15='?', @p16='?' (DbType = Boolean), @p17='?'], CommandType='"Text"', CommandTimeout='30']
UPDATE "AspNetUsers" SET "AccessFailedCount" = @p0, "ConcurrencyStamp" = @p1, "CourseNumber" = @p2, "Email" = @p3, "EmailConfirmed" = @p4, "FullName" = @p5, "Group" = @p6, "JoinedAt" = @p7, "LockoutEnabled" = @p8, "LockoutEnd" = @p9, "NormalizedEmail" = @p10, "NormalizedUserName" = @p11, "PasswordHash" = @p12, "PhoneNumber" = @p13, "PhoneNumberConfirmed" = @p14, "SecurityStamp" = @p15, "TwoFactorEnabled" = @p16, "UserName" = @p17
WHERE "Id" = @p18 AND "ConcurrencyStamp" = @p19; <s:Microsoft.EntityFrameworkCore.Database.Command>
[2024-04-28 19:26:45 +07:00 INF] Executed action Internship_system.Controllers.InternshipAdminController.UploadStudents (Internship-system.API) in 1402.7794ms <s:Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker>
[2024-04-28 19:26:45 +07:00 INF] Executed endpoint 'Internship_system.Controllers.InternshipAdminController.UploadStudents (Internship-system.API)' <s:Microsoft.AspNetCore.Routing.EndpointMiddleware>
[2024-04-28 19:26:45 +07:00 INF] Request finished HTTP/1.1 POST http://localhost:5105/admin/internship/students - 200 0 null 1594.5569ms <s:Microsoft.AspNetCore.Hosting.Diagnostics>
[2024-04-28 19:27:03 +07:00 INF] Application is shutting down... <s:Microsoft.Hosting.Lifetime>
[2024-04-28 19:34:46 +07:00 INF] Executed DbCommand (170ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT EXISTS (
    SELECT 1 FROM pg_catalog.pg_class c
    JOIN pg_catalog.pg_namespace n ON n.oid=c.relnamespace
    WHERE n.nspname='public' AND
          c.relname='__EFMigrationsHistory'
) <s:Microsoft.EntityFrameworkCore.Database.Command>
[2024-04-28 19:34:46 +07:00 INF] Executed DbCommand (13ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT "MigrationId", "ProductVersion"
FROM "__EFMigrationsHistory"
ORDER BY "MigrationId"; <s:Microsoft.EntityFrameworkCore.Database.Command>
[2024-04-28 19:34:46 +07:00 INF] Executed DbCommand (3ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT EXISTS (
    SELECT 1 FROM pg_catalog.pg_class c
    JOIN pg_catalog.pg_namespace n ON n.oid=c.relnamespace
    WHERE n.nspname='public' AND
          c.relname='__EFMigrationsHistory'
) <s:Microsoft.EntityFrameworkCore.Database.Command>
[2024-04-28 19:34:46 +07:00 INF] Executed DbCommand (2ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT EXISTS (
    SELECT 1 FROM pg_catalog.pg_class c
    JOIN pg_catalog.pg_namespace n ON n.oid=c.relnamespace
    WHERE n.nspname='public' AND
          c.relname='__EFMigrationsHistory'
) <s:Microsoft.EntityFrameworkCore.Database.Command>
[2024-04-28 19:34:46 +07:00 INF] Executed DbCommand (1ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT "MigrationId", "ProductVersion"
FROM "__EFMigrationsHistory"
ORDER BY "MigrationId"; <s:Microsoft.EntityFrameworkCore.Database.Command>
[2024-04-28 19:34:46 +07:00 INF] No migrations were applied. The database is already up to date. <s:Microsoft.EntityFrameworkCore.Migrations>
[2024-04-28 19:34:46 +07:00 INF] User profile is available. Using 'C:\Users\danka\AppData\Local\ASP.NET\DataProtection-Keys' as key repository and Windows DPAPI to encrypt keys at rest. <s:Microsoft.AspNetCore.DataProtection.KeyManagement.XmlKeyManager>
[2024-04-28 19:34:47 +07:00 INF] Executed DbCommand (21ms) [Parameters=[@__normalizedName_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT a."Id", a."ConcurrencyStamp", a."Name", a."NormalizedName", a."RoleType"
FROM "AspNetRoles" AS a
WHERE a."NormalizedName" = @__normalizedName_0
LIMIT 1 <s:Microsoft.EntityFrameworkCore.Database.Command>
[2024-04-28 19:34:47 +07:00 INF] Executed DbCommand (1ms) [Parameters=[@__normalizedName_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT a."Id", a."ConcurrencyStamp", a."Name", a."NormalizedName", a."RoleType"
FROM "AspNetRoles" AS a
WHERE a."NormalizedName" = @__normalizedName_0
LIMIT 1 <s:Microsoft.EntityFrameworkCore.Database.Command>
[2024-04-28 19:34:47 +07:00 INF] Executed DbCommand (4ms) [Parameters=[@__normalizedEmail_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT a."Id", a."AccessFailedCount", a."ConcurrencyStamp", a."Discriminator", a."Email", a."EmailConfirmed", a."FullName", a."JoinedAt", a."LockoutEnabled", a."LockoutEnd", a."NormalizedEmail", a."NormalizedUserName", a."PasswordHash", a."PhoneNumber", a."PhoneNumberConfirmed", a."SecurityStamp", a."TwoFactorEnabled", a."UserName", a."CourseNumber", a."Group"
FROM "AspNetUsers" AS a
WHERE a."NormalizedEmail" = @__normalizedEmail_0
LIMIT 2 <s:Microsoft.EntityFrameworkCore.Database.Command>
[2024-04-28 19:34:47 +07:00 INF] Executed DbCommand (1ms) [Parameters=[@__normalizedEmail_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT a."Id", a."AccessFailedCount", a."ConcurrencyStamp", a."Discriminator", a."Email", a."EmailConfirmed", a."FullName", a."JoinedAt", a."LockoutEnabled", a."LockoutEnd", a."NormalizedEmail", a."NormalizedUserName", a."PasswordHash", a."PhoneNumber", a."PhoneNumberConfirmed", a."SecurityStamp", a."TwoFactorEnabled", a."UserName", a."CourseNumber", a."Group"
FROM "AspNetUsers" AS a
WHERE a."NormalizedEmail" = @__normalizedEmail_0
LIMIT 2 <s:Microsoft.EntityFrameworkCore.Database.Command>
[2024-04-28 19:34:47 +07:00 INF] Executed DbCommand (1ms) [Parameters=[@__normalizedRoleName_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT a."Id", a."ConcurrencyStamp", a."Name", a."NormalizedName", a."RoleType"
FROM "AspNetRoles" AS a
WHERE a."NormalizedName" = @__normalizedRoleName_0
LIMIT 2 <s:Microsoft.EntityFrameworkCore.Database.Command>
[2024-04-28 19:34:47 +07:00 INF] Executed DbCommand (8ms) [Parameters=[@__get_Item_0='?' (DbType = Guid), @__get_Item_1='?' (DbType = Guid)], CommandType='"Text"', CommandTimeout='30']
SELECT a."UserId", a."RoleId"
FROM "AspNetUserRoles" AS a
WHERE a."UserId" = @__get_Item_0 AND a."RoleId" = @__get_Item_1
LIMIT 1 <s:Microsoft.EntityFrameworkCore.Database.Command>
[2024-04-28 19:34:48 +07:00 INF] Now listening on: http://localhost:5105 <s:Microsoft.Hosting.Lifetime>
[2024-04-28 19:34:48 +07:00 INF] Application started. Press Ctrl+C to shut down. <s:Microsoft.Hosting.Lifetime>
[2024-04-28 19:34:48 +07:00 INF] Hosting environment: Development <s:Microsoft.Hosting.Lifetime>
[2024-04-28 19:34:48 +07:00 INF] Content root path: D:\prog\a_projects\back\Internship\Internship-system.API <s:Microsoft.Hosting.Lifetime>
[2024-04-28 19:34:49 +07:00 INF] Request starting HTTP/1.1 GET http://localhost:5105/swagger/index.html - null null <s:Microsoft.AspNetCore.Hosting.Diagnostics>
[2024-04-28 19:34:49 +07:00 INF] Request finished HTTP/1.1 GET http://localhost:5105/swagger/index.html - 200 null text/html;charset=utf-8 496.1001ms <s:Microsoft.AspNetCore.Hosting.Diagnostics>
[2024-04-28 19:34:49 +07:00 INF] Request starting HTTP/1.1 GET http://localhost:5105/swagger/v1/swagger.json - null null <s:Microsoft.AspNetCore.Hosting.Diagnostics>
[2024-04-28 19:34:50 +07:00 INF] Request finished HTTP/1.1 GET http://localhost:5105/swagger/v1/swagger.json - 200 null application/json;charset=utf-8 384.8894ms <s:Microsoft.AspNetCore.Hosting.Diagnostics>
[2024-04-28 19:34:58 +07:00 INF] Request starting HTTP/1.1 GET http://localhost:5105/admin/internship/students/table - null null <s:Microsoft.AspNetCore.Hosting.Diagnostics>
[2024-04-28 19:34:58 +07:00 WRN] Failed to determine the https port for redirect. <s:Microsoft.AspNetCore.HttpsPolicy.HttpsRedirectionMiddleware>
[2024-04-28 19:34:58 +07:00 INF] Executing endpoint 'Internship_system.Controllers.InternshipAdminController.ExportStudentsAsTable (Internship-system.API)' <s:Microsoft.AspNetCore.Routing.EndpointMiddleware>
[2024-04-28 19:34:58 +07:00 INF] Route matched with {action = "ExportStudentsAsTable", controller = "InternshipAdmin"}. Executing controller action with signature System.Threading.Tasks.Task ExportStudentsAsTable() on controller Internship_system.Controllers.InternshipAdminController (Internship-system.API). <s:Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker>
[2024-04-28 19:34:59 +07:00 INF] Executed action Internship_system.Controllers.InternshipAdminController.ExportStudentsAsTable (Internship-system.API) in 162.17ms <s:Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker>
[2024-04-28 19:34:59 +07:00 INF] Executed endpoint 'Internship_system.Controllers.InternshipAdminController.ExportStudentsAsTable (Internship-system.API)' <s:Microsoft.AspNetCore.Routing.EndpointMiddleware>
[2024-04-28 19:34:59 +07:00 INF] Request finished HTTP/1.1 GET http://localhost:5105/admin/internship/students/table - 200 0 null 287.8548ms <s:Microsoft.AspNetCore.Hosting.Diagnostics>
[2024-04-28 19:36:34 +07:00 INF] Request starting HTTP/1.1 GET http://localhost:5105/admin/internship/students/table - null null <s:Microsoft.AspNetCore.Hosting.Diagnostics>
[2024-04-28 19:36:34 +07:00 INF] Executing endpoint 'Internship_system.Controllers.InternshipAdminController.ExportStudentsAsTable (Internship-system.API)' <s:Microsoft.AspNetCore.Routing.EndpointMiddleware>
[2024-04-28 19:36:34 +07:00 INF] Route matched with {action = "ExportStudentsAsTable", controller = "InternshipAdmin"}. Executing controller action with signature System.Threading.Tasks.Task ExportStudentsAsTable() on controller Internship_system.Controllers.InternshipAdminController (Internship-system.API). <s:Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker>
[2024-04-28 19:36:34 +07:00 INF] Executed action Internship_system.Controllers.InternshipAdminController.ExportStudentsAsTable (Internship-system.API) in 47.2916ms <s:Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker>
[2024-04-28 19:36:34 +07:00 INF] Executed endpoint 'Internship_system.Controllers.InternshipAdminController.ExportStudentsAsTable (Internship-system.API)' <s:Microsoft.AspNetCore.Routing.EndpointMiddleware>
[2024-04-28 19:36:34 +07:00 INF] Request finished HTTP/1.1 GET http://localhost:5105/admin/internship/students/table - 200 0 null 69.0076ms <s:Microsoft.AspNetCore.Hosting.Diagnostics>
[2024-04-28 19:38:25 +07:00 INF] Request starting HTTP/1.1 GET http://localhost:5105/admin/internship/students/table - null null <s:Microsoft.AspNetCore.Hosting.Diagnostics>
[2024-04-28 19:38:25 +07:00 INF] Executing endpoint 'Internship_system.Controllers.InternshipAdminController.ExportStudentsAsTable (Internship-system.API)' <s:Microsoft.AspNetCore.Routing.EndpointMiddleware>
[2024-04-28 19:38:25 +07:00 INF] Route matched with {action = "ExportStudentsAsTable", controller = "InternshipAdmin"}. Executing controller action with signature System.Threading.Tasks.Task ExportStudentsAsTable() on controller Internship_system.Controllers.InternshipAdminController (Internship-system.API). <s:Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker>
[2024-04-28 19:38:25 +07:00 INF] Executed action Internship_system.Controllers.InternshipAdminController.ExportStudentsAsTable (Internship-system.API) in 46.9276ms <s:Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker>
[2024-04-28 19:38:25 +07:00 INF] Executed endpoint 'Internship_system.Controllers.InternshipAdminController.ExportStudentsAsTable (Internship-system.API)' <s:Microsoft.AspNetCore.Routing.EndpointMiddleware>
[2024-04-28 19:38:25 +07:00 INF] Request finished HTTP/1.1 GET http://localhost:5105/admin/internship/students/table - 200 0 null 72.288ms <s:Microsoft.AspNetCore.Hosting.Diagnostics>
[2024-04-28 19:38:29 +07:00 INF] Application is shutting down... <s:Microsoft.Hosting.Lifetime>
[2024-04-28 19:38:46 +07:00 INF] Executed DbCommand (113ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT EXISTS (
    SELECT 1 FROM pg_catalog.pg_class c
    JOIN pg_catalog.pg_namespace n ON n.oid=c.relnamespace
    WHERE n.nspname='public' AND
          c.relname='__EFMigrationsHistory'
) <s:Microsoft.EntityFrameworkCore.Database.Command>
[2024-04-28 19:38:46 +07:00 INF] Executed DbCommand (12ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT "MigrationId", "ProductVersion"
FROM "__EFMigrationsHistory"
ORDER BY "MigrationId"; <s:Microsoft.EntityFrameworkCore.Database.Command>
[2024-04-28 19:38:46 +07:00 INF] Executed DbCommand (3ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT EXISTS (
    SELECT 1 FROM pg_catalog.pg_class c
    JOIN pg_catalog.pg_namespace n ON n.oid=c.relnamespace
    WHERE n.nspname='public' AND
          c.relname='__EFMigrationsHistory'
) <s:Microsoft.EntityFrameworkCore.Database.Command>
[2024-04-28 19:38:46 +07:00 INF] Executed DbCommand (1ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT EXISTS (
    SELECT 1 FROM pg_catalog.pg_class c
    JOIN pg_catalog.pg_namespace n ON n.oid=c.relnamespace
    WHERE n.nspname='public' AND
          c.relname='__EFMigrationsHistory'
) <s:Microsoft.EntityFrameworkCore.Database.Command>
[2024-04-28 19:38:46 +07:00 INF] Executed DbCommand (1ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT "MigrationId", "ProductVersion"
FROM "__EFMigrationsHistory"
ORDER BY "MigrationId"; <s:Microsoft.EntityFrameworkCore.Database.Command>
[2024-04-28 19:38:46 +07:00 INF] No migrations were applied. The database is already up to date. <s:Microsoft.EntityFrameworkCore.Migrations>
[2024-04-28 19:38:46 +07:00 INF] User profile is available. Using 'C:\Users\danka\AppData\Local\ASP.NET\DataProtection-Keys' as key repository and Windows DPAPI to encrypt keys at rest. <s:Microsoft.AspNetCore.DataProtection.KeyManagement.XmlKeyManager>
[2024-04-28 19:38:46 +07:00 INF] Executed DbCommand (15ms) [Parameters=[@__normalizedName_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT a."Id", a."ConcurrencyStamp", a."Name", a."NormalizedName", a."RoleType"
FROM "AspNetRoles" AS a
WHERE a."NormalizedName" = @__normalizedName_0
LIMIT 1 <s:Microsoft.EntityFrameworkCore.Database.Command>
[2024-04-28 19:38:46 +07:00 INF] Executed DbCommand (1ms) [Parameters=[@__normalizedName_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT a."Id", a."ConcurrencyStamp", a."Name", a."NormalizedName", a."RoleType"
FROM "AspNetRoles" AS a
WHERE a."NormalizedName" = @__normalizedName_0
LIMIT 1 <s:Microsoft.EntityFrameworkCore.Database.Command>
[2024-04-28 19:38:46 +07:00 INF] Executed DbCommand (3ms) [Parameters=[@__normalizedEmail_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT a."Id", a."AccessFailedCount", a."ConcurrencyStamp", a."Discriminator", a."Email", a."EmailConfirmed", a."FullName", a."JoinedAt", a."LockoutEnabled", a."LockoutEnd", a."NormalizedEmail", a."NormalizedUserName", a."PasswordHash", a."PhoneNumber", a."PhoneNumberConfirmed", a."SecurityStamp", a."TwoFactorEnabled", a."UserName", a."CourseNumber", a."Group"
FROM "AspNetUsers" AS a
WHERE a."NormalizedEmail" = @__normalizedEmail_0
LIMIT 2 <s:Microsoft.EntityFrameworkCore.Database.Command>
[2024-04-28 19:38:47 +07:00 INF] Executed DbCommand (2ms) [Parameters=[@__normalizedEmail_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT a."Id", a."AccessFailedCount", a."ConcurrencyStamp", a."Discriminator", a."Email", a."EmailConfirmed", a."FullName", a."JoinedAt", a."LockoutEnabled", a."LockoutEnd", a."NormalizedEmail", a."NormalizedUserName", a."PasswordHash", a."PhoneNumber", a."PhoneNumberConfirmed", a."SecurityStamp", a."TwoFactorEnabled", a."UserName", a."CourseNumber", a."Group"
FROM "AspNetUsers" AS a
WHERE a."NormalizedEmail" = @__normalizedEmail_0
LIMIT 2 <s:Microsoft.EntityFrameworkCore.Database.Command>
[2024-04-28 19:38:47 +07:00 INF] Executed DbCommand (1ms) [Parameters=[@__normalizedRoleName_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT a."Id", a."ConcurrencyStamp", a."Name", a."NormalizedName", a."RoleType"
FROM "AspNetRoles" AS a
WHERE a."NormalizedName" = @__normalizedRoleName_0
LIMIT 2 <s:Microsoft.EntityFrameworkCore.Database.Command>
[2024-04-28 19:38:47 +07:00 INF] Executed DbCommand (5ms) [Parameters=[@__get_Item_0='?' (DbType = Guid), @__get_Item_1='?' (DbType = Guid)], CommandType='"Text"', CommandTimeout='30']
SELECT a."UserId", a."RoleId"
FROM "AspNetUserRoles" AS a
WHERE a."UserId" = @__get_Item_0 AND a."RoleId" = @__get_Item_1
LIMIT 1 <s:Microsoft.EntityFrameworkCore.Database.Command>
[2024-04-28 19:38:47 +07:00 INF] Now listening on: http://localhost:5105 <s:Microsoft.Hosting.Lifetime>
[2024-04-28 19:38:47 +07:00 INF] Application started. Press Ctrl+C to shut down. <s:Microsoft.Hosting.Lifetime>
[2024-04-28 19:38:47 +07:00 INF] Hosting environment: Development <s:Microsoft.Hosting.Lifetime>
[2024-04-28 19:38:47 +07:00 INF] Content root path: D:\prog\a_projects\back\Internship\Internship-system.API <s:Microsoft.Hosting.Lifetime>
[2024-04-28 19:38:47 +07:00 INF] Request starting HTTP/1.1 GET http://localhost:5105/swagger/index.html - null null <s:Microsoft.AspNetCore.Hosting.Diagnostics>
[2024-04-28 19:38:48 +07:00 INF] Request finished HTTP/1.1 GET http://localhost:5105/swagger/index.html - 200 null text/html;charset=utf-8 636.2843ms <s:Microsoft.AspNetCore.Hosting.Diagnostics>
[2024-04-28 19:38:48 +07:00 INF] Request starting HTTP/1.1 GET http://localhost:5105/swagger/v1/swagger.json - null null <s:Microsoft.AspNetCore.Hosting.Diagnostics>
[2024-04-28 19:38:49 +07:00 INF] Request finished HTTP/1.1 GET http://localhost:5105/swagger/v1/swagger.json - 200 null application/json;charset=utf-8 506.1625ms <s:Microsoft.AspNetCore.Hosting.Diagnostics>
[2024-04-28 19:38:51 +07:00 INF] Request starting HTTP/1.1 GET http://localhost:5105/admin/internship/students/table - null null <s:Microsoft.AspNetCore.Hosting.Diagnostics>
[2024-04-28 19:38:51 +07:00 WRN] Failed to determine the https port for redirect. <s:Microsoft.AspNetCore.HttpsPolicy.HttpsRedirectionMiddleware>
[2024-04-28 19:38:51 +07:00 INF] Executing endpoint 'Internship_system.Controllers.InternshipAdminController.ExportStudentsAsTable (Internship-system.API)' <s:Microsoft.AspNetCore.Routing.EndpointMiddleware>
[2024-04-28 19:38:52 +07:00 INF] Route matched with {action = "ExportStudentsAsTable", controller = "InternshipAdmin"}. Executing controller action with signature System.Threading.Tasks.Task ExportStudentsAsTable() on controller Internship_system.Controllers.InternshipAdminController (Internship-system.API). <s:Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker>
[2024-04-28 19:41:58 +07:00 INF] Executed DbCommand (159ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT EXISTS (
    SELECT 1 FROM pg_catalog.pg_class c
    JOIN pg_catalog.pg_namespace n ON n.oid=c.relnamespace
    WHERE n.nspname='public' AND
          c.relname='__EFMigrationsHistory'
) <s:Microsoft.EntityFrameworkCore.Database.Command>
[2024-04-28 19:41:58 +07:00 INF] Executed DbCommand (11ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT "MigrationId", "ProductVersion"
FROM "__EFMigrationsHistory"
ORDER BY "MigrationId"; <s:Microsoft.EntityFrameworkCore.Database.Command>
[2024-04-28 19:41:59 +07:00 INF] Executed DbCommand (3ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT EXISTS (
    SELECT 1 FROM pg_catalog.pg_class c
    JOIN pg_catalog.pg_namespace n ON n.oid=c.relnamespace
    WHERE n.nspname='public' AND
          c.relname='__EFMigrationsHistory'
) <s:Microsoft.EntityFrameworkCore.Database.Command>
[2024-04-28 19:41:59 +07:00 INF] Executed DbCommand (1ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT EXISTS (
    SELECT 1 FROM pg_catalog.pg_class c
    JOIN pg_catalog.pg_namespace n ON n.oid=c.relnamespace
    WHERE n.nspname='public' AND
          c.relname='__EFMigrationsHistory'
) <s:Microsoft.EntityFrameworkCore.Database.Command>
[2024-04-28 19:41:59 +07:00 INF] Executed DbCommand (1ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT "MigrationId", "ProductVersion"
FROM "__EFMigrationsHistory"
ORDER BY "MigrationId"; <s:Microsoft.EntityFrameworkCore.Database.Command>
[2024-04-28 19:41:59 +07:00 INF] No migrations were applied. The database is already up to date. <s:Microsoft.EntityFrameworkCore.Migrations>
[2024-04-28 19:41:59 +07:00 INF] User profile is available. Using 'C:\Users\danka\AppData\Local\ASP.NET\DataProtection-Keys' as key repository and Windows DPAPI to encrypt keys at rest. <s:Microsoft.AspNetCore.DataProtection.KeyManagement.XmlKeyManager>
[2024-04-28 19:41:59 +07:00 INF] Executed DbCommand (31ms) [Parameters=[@__normalizedName_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT a."Id", a."ConcurrencyStamp", a."Name", a."NormalizedName", a."RoleType"
FROM "AspNetRoles" AS a
WHERE a."NormalizedName" = @__normalizedName_0
LIMIT 1 <s:Microsoft.EntityFrameworkCore.Database.Command>
[2024-04-28 19:41:59 +07:00 INF] Executed DbCommand (2ms) [Parameters=[@__normalizedName_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT a."Id", a."ConcurrencyStamp", a."Name", a."NormalizedName", a."RoleType"
FROM "AspNetRoles" AS a
WHERE a."NormalizedName" = @__normalizedName_0
LIMIT 1 <s:Microsoft.EntityFrameworkCore.Database.Command>
[2024-04-28 19:41:59 +07:00 INF] Executed DbCommand (4ms) [Parameters=[@__normalizedEmail_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT a."Id", a."AccessFailedCount", a."ConcurrencyStamp", a."Discriminator", a."Email", a."EmailConfirmed", a."FullName", a."JoinedAt", a."LockoutEnabled", a."LockoutEnd", a."NormalizedEmail", a."NormalizedUserName", a."PasswordHash", a."PhoneNumber", a."PhoneNumberConfirmed", a."SecurityStamp", a."TwoFactorEnabled", a."UserName", a."CourseNumber", a."Group"
FROM "AspNetUsers" AS a
WHERE a."NormalizedEmail" = @__normalizedEmail_0
LIMIT 2 <s:Microsoft.EntityFrameworkCore.Database.Command>
[2024-04-28 19:41:59 +07:00 INF] Executed DbCommand (2ms) [Parameters=[@__normalizedEmail_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT a."Id", a."AccessFailedCount", a."ConcurrencyStamp", a."Discriminator", a."Email", a."EmailConfirmed", a."FullName", a."JoinedAt", a."LockoutEnabled", a."LockoutEnd", a."NormalizedEmail", a."NormalizedUserName", a."PasswordHash", a."PhoneNumber", a."PhoneNumberConfirmed", a."SecurityStamp", a."TwoFactorEnabled", a."UserName", a."CourseNumber", a."Group"
FROM "AspNetUsers" AS a
WHERE a."NormalizedEmail" = @__normalizedEmail_0
LIMIT 2 <s:Microsoft.EntityFrameworkCore.Database.Command>
[2024-04-28 19:41:59 +07:00 INF] Executed DbCommand (1ms) [Parameters=[@__normalizedRoleName_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT a."Id", a."ConcurrencyStamp", a."Name", a."NormalizedName", a."RoleType"
FROM "AspNetRoles" AS a
WHERE a."NormalizedName" = @__normalizedRoleName_0
LIMIT 2 <s:Microsoft.EntityFrameworkCore.Database.Command>
[2024-04-28 19:41:59 +07:00 INF] Executed DbCommand (4ms) [Parameters=[@__get_Item_0='?' (DbType = Guid), @__get_Item_1='?' (DbType = Guid)], CommandType='"Text"', CommandTimeout='30']
SELECT a."UserId", a."RoleId"
FROM "AspNetUserRoles" AS a
WHERE a."UserId" = @__get_Item_0 AND a."RoleId" = @__get_Item_1
LIMIT 1 <s:Microsoft.EntityFrameworkCore.Database.Command>
[2024-04-28 19:42:00 +07:00 INF] Now listening on: http://localhost:5105 <s:Microsoft.Hosting.Lifetime>
[2024-04-28 19:42:00 +07:00 INF] Application started. Press Ctrl+C to shut down. <s:Microsoft.Hosting.Lifetime>
[2024-04-28 19:42:00 +07:00 INF] Hosting environment: Development <s:Microsoft.Hosting.Lifetime>
[2024-04-28 19:42:00 +07:00 INF] Content root path: D:\prog\a_projects\back\Internship\Internship-system.API <s:Microsoft.Hosting.Lifetime>
[2024-04-28 19:42:00 +07:00 INF] Request starting HTTP/1.1 GET http://localhost:5105/swagger/index.html - null null <s:Microsoft.AspNetCore.Hosting.Diagnostics>
[2024-04-28 19:42:01 +07:00 INF] Request finished HTTP/1.1 GET http://localhost:5105/swagger/index.html - 200 null text/html;charset=utf-8 528.2826ms <s:Microsoft.AspNetCore.Hosting.Diagnostics>
[2024-04-28 19:42:01 +07:00 INF] Request starting HTTP/1.1 GET http://localhost:5105/swagger/v1/swagger.json - null null <s:Microsoft.AspNetCore.Hosting.Diagnostics>
[2024-04-28 19:42:02 +07:00 INF] Request finished HTTP/1.1 GET http://localhost:5105/swagger/v1/swagger.json - 200 null application/json;charset=utf-8 694.6762ms <s:Microsoft.AspNetCore.Hosting.Diagnostics>
[2024-04-28 19:42:05 +07:00 INF] Request starting HTTP/1.1 GET http://localhost:5105/admin/internship/students/table - null null <s:Microsoft.AspNetCore.Hosting.Diagnostics>
[2024-04-28 19:42:05 +07:00 WRN] Failed to determine the https port for redirect. <s:Microsoft.AspNetCore.HttpsPolicy.HttpsRedirectionMiddleware>
[2024-04-28 19:42:05 +07:00 INF] Executing endpoint 'Internship_system.Controllers.InternshipAdminController.ExportStudentsAsTable (Internship-system.API)' <s:Microsoft.AspNetCore.Routing.EndpointMiddleware>
[2024-04-28 19:42:05 +07:00 INF] Route matched with {action = "ExportStudentsAsTable", controller = "InternshipAdmin"}. Executing controller action with signature System.Threading.Tasks.Task ExportStudentsAsTable() on controller Internship_system.Controllers.InternshipAdminController (Internship-system.API). <s:Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker>
[2024-04-28 19:54:43 +07:00 INF] Executed DbCommand (140ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT EXISTS (
    SELECT 1 FROM pg_catalog.pg_class c
    JOIN pg_catalog.pg_namespace n ON n.oid=c.relnamespace
    WHERE n.nspname='public' AND
          c.relname='__EFMigrationsHistory'
) <s:Microsoft.EntityFrameworkCore.Database.Command>
[2024-04-28 19:54:43 +07:00 INF] Executed DbCommand (14ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT "MigrationId", "ProductVersion"
FROM "__EFMigrationsHistory"
ORDER BY "MigrationId"; <s:Microsoft.EntityFrameworkCore.Database.Command>
[2024-04-28 19:54:43 +07:00 INF] Executed DbCommand (6ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT EXISTS (
    SELECT 1 FROM pg_catalog.pg_class c
    JOIN pg_catalog.pg_namespace n ON n.oid=c.relnamespace
    WHERE n.nspname='public' AND
          c.relname='__EFMigrationsHistory'
) <s:Microsoft.EntityFrameworkCore.Database.Command>
[2024-04-28 19:54:43 +07:00 INF] Executed DbCommand (2ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT EXISTS (
    SELECT 1 FROM pg_catalog.pg_class c
    JOIN pg_catalog.pg_namespace n ON n.oid=c.relnamespace
    WHERE n.nspname='public' AND
          c.relname='__EFMigrationsHistory'
) <s:Microsoft.EntityFrameworkCore.Database.Command>
[2024-04-28 19:54:43 +07:00 INF] Executed DbCommand (2ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT "MigrationId", "ProductVersion"
FROM "__EFMigrationsHistory"
ORDER BY "MigrationId"; <s:Microsoft.EntityFrameworkCore.Database.Command>
[2024-04-28 19:54:44 +07:00 INF] No migrations were applied. The database is already up to date. <s:Microsoft.EntityFrameworkCore.Migrations>
[2024-04-28 19:54:44 +07:00 INF] User profile is available. Using 'C:\Users\danka\AppData\Local\ASP.NET\DataProtection-Keys' as key repository and Windows DPAPI to encrypt keys at rest. <s:Microsoft.AspNetCore.DataProtection.KeyManagement.XmlKeyManager>
[2024-04-28 19:54:44 +07:00 INF] Executed DbCommand (18ms) [Parameters=[@__normalizedName_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT a."Id", a."ConcurrencyStamp", a."Name", a."NormalizedName", a."RoleType"
FROM "AspNetRoles" AS a
WHERE a."NormalizedName" = @__normalizedName_0
LIMIT 1 <s:Microsoft.EntityFrameworkCore.Database.Command>
[2024-04-28 19:54:44 +07:00 INF] Executed DbCommand (1ms) [Parameters=[@__normalizedName_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT a."Id", a."ConcurrencyStamp", a."Name", a."NormalizedName", a."RoleType"
FROM "AspNetRoles" AS a
WHERE a."NormalizedName" = @__normalizedName_0
LIMIT 1 <s:Microsoft.EntityFrameworkCore.Database.Command>
[2024-04-28 19:54:44 +07:00 INF] Executed DbCommand (5ms) [Parameters=[@__normalizedEmail_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT a."Id", a."AccessFailedCount", a."ConcurrencyStamp", a."Discriminator", a."Email", a."EmailConfirmed", a."FullName", a."JoinedAt", a."LockoutEnabled", a."LockoutEnd", a."NormalizedEmail", a."NormalizedUserName", a."PasswordHash", a."PhoneNumber", a."PhoneNumberConfirmed", a."SecurityStamp", a."TwoFactorEnabled", a."UserName", a."CourseNumber", a."Group"
FROM "AspNetUsers" AS a
WHERE a."NormalizedEmail" = @__normalizedEmail_0
LIMIT 2 <s:Microsoft.EntityFrameworkCore.Database.Command>
[2024-04-28 19:54:44 +07:00 INF] Executed DbCommand (1ms) [Parameters=[@__normalizedEmail_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT a."Id", a."AccessFailedCount", a."ConcurrencyStamp", a."Discriminator", a."Email", a."EmailConfirmed", a."FullName", a."JoinedAt", a."LockoutEnabled", a."LockoutEnd", a."NormalizedEmail", a."NormalizedUserName", a."PasswordHash", a."PhoneNumber", a."PhoneNumberConfirmed", a."SecurityStamp", a."TwoFactorEnabled", a."UserName", a."CourseNumber", a."Group"
FROM "AspNetUsers" AS a
WHERE a."NormalizedEmail" = @__normalizedEmail_0
LIMIT 2 <s:Microsoft.EntityFrameworkCore.Database.Command>
[2024-04-28 19:54:44 +07:00 INF] Executed DbCommand (1ms) [Parameters=[@__normalizedRoleName_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT a."Id", a."ConcurrencyStamp", a."Name", a."NormalizedName", a."RoleType"
FROM "AspNetRoles" AS a
WHERE a."NormalizedName" = @__normalizedRoleName_0
LIMIT 2 <s:Microsoft.EntityFrameworkCore.Database.Command>
[2024-04-28 19:54:45 +07:00 INF] Executed DbCommand (8ms) [Parameters=[@__get_Item_0='?' (DbType = Guid), @__get_Item_1='?' (DbType = Guid)], CommandType='"Text"', CommandTimeout='30']
SELECT a."UserId", a."RoleId"
FROM "AspNetUserRoles" AS a
WHERE a."UserId" = @__get_Item_0 AND a."RoleId" = @__get_Item_1
LIMIT 1 <s:Microsoft.EntityFrameworkCore.Database.Command>
[2024-04-28 19:54:45 +07:00 INF] Now listening on: http://localhost:5105 <s:Microsoft.Hosting.Lifetime>
[2024-04-28 19:54:45 +07:00 INF] Application started. Press Ctrl+C to shut down. <s:Microsoft.Hosting.Lifetime>
[2024-04-28 19:54:45 +07:00 INF] Hosting environment: Development <s:Microsoft.Hosting.Lifetime>
[2024-04-28 19:54:45 +07:00 INF] Content root path: D:\prog\a_projects\back\Internship\Internship-system.API <s:Microsoft.Hosting.Lifetime>
[2024-04-28 19:54:46 +07:00 INF] Request starting HTTP/1.1 GET http://localhost:5105/swagger/index.html - null null <s:Microsoft.AspNetCore.Hosting.Diagnostics>
[2024-04-28 19:54:46 +07:00 INF] Request finished HTTP/1.1 GET http://localhost:5105/swagger/index.html - 200 null text/html;charset=utf-8 532.7115ms <s:Microsoft.AspNetCore.Hosting.Diagnostics>
[2024-04-28 19:54:46 +07:00 INF] Request starting HTTP/1.1 GET http://localhost:5105/swagger/v1/swagger.json - null null <s:Microsoft.AspNetCore.Hosting.Diagnostics>
[2024-04-28 19:54:47 +07:00 INF] Request finished HTTP/1.1 GET http://localhost:5105/swagger/v1/swagger.json - 200 null application/json;charset=utf-8 399.8582ms <s:Microsoft.AspNetCore.Hosting.Diagnostics>
[2024-04-28 19:54:49 +07:00 INF] Request starting HTTP/1.1 GET http://localhost:5105/admin/internship/students/table - null null <s:Microsoft.AspNetCore.Hosting.Diagnostics>
[2024-04-28 19:54:49 +07:00 WRN] Failed to determine the https port for redirect. <s:Microsoft.AspNetCore.HttpsPolicy.HttpsRedirectionMiddleware>
[2024-04-28 19:54:49 +07:00 INF] Executing endpoint 'Internship_system.Controllers.InternshipAdminController.ExportStudentsAsTable (Internship-system.API)' <s:Microsoft.AspNetCore.Routing.EndpointMiddleware>
[2024-04-28 19:54:49 +07:00 INF] Route matched with {action = "ExportStudentsAsTable", controller = "InternshipAdmin"}. Executing controller action with signature System.Threading.Tasks.Task ExportStudentsAsTable() on controller Internship_system.Controllers.InternshipAdminController (Internship-system.API). <s:Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker>
[2024-04-28 19:54:50 +07:00 INF] Executed action Internship_system.Controllers.InternshipAdminController.ExportStudentsAsTable (Internship-system.API) in 1188.9653ms <s:Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker>
[2024-04-28 19:54:50 +07:00 INF] Executed endpoint 'Internship_system.Controllers.InternshipAdminController.ExportStudentsAsTable (Internship-system.API)' <s:Microsoft.AspNetCore.Routing.EndpointMiddleware>
[2024-04-28 19:54:50 +07:00 INF] Request finished HTTP/1.1 GET http://localhost:5105/admin/internship/students/table - 200 0 null 1318.2284ms <s:Microsoft.AspNetCore.Hosting.Diagnostics>
[2024-04-28 19:56:22 +07:00 INF] Application is shutting down... <s:Microsoft.Hosting.Lifetime>
[2024-04-28 19:56:43 +07:00 INF] Executed DbCommand (130ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT EXISTS (
    SELECT 1 FROM pg_catalog.pg_class c
    JOIN pg_catalog.pg_namespace n ON n.oid=c.relnamespace
    WHERE n.nspname='public' AND
          c.relname='__EFMigrationsHistory'
) <s:Microsoft.EntityFrameworkCore.Database.Command>
[2024-04-28 19:56:43 +07:00 INF] Executed DbCommand (16ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT "MigrationId", "ProductVersion"
FROM "__EFMigrationsHistory"
ORDER BY "MigrationId"; <s:Microsoft.EntityFrameworkCore.Database.Command>
[2024-04-28 19:56:43 +07:00 INF] Executed DbCommand (7ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT EXISTS (
    SELECT 1 FROM pg_catalog.pg_class c
    JOIN pg_catalog.pg_namespace n ON n.oid=c.relnamespace
    WHERE n.nspname='public' AND
          c.relname='__EFMigrationsHistory'
) <s:Microsoft.EntityFrameworkCore.Database.Command>
[2024-04-28 19:56:44 +07:00 INF] Executed DbCommand (3ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT EXISTS (
    SELECT 1 FROM pg_catalog.pg_class c
    JOIN pg_catalog.pg_namespace n ON n.oid=c.relnamespace
    WHERE n.nspname='public' AND
          c.relname='__EFMigrationsHistory'
) <s:Microsoft.EntityFrameworkCore.Database.Command>
[2024-04-28 19:56:44 +07:00 INF] Executed DbCommand (2ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT "MigrationId", "ProductVersion"
FROM "__EFMigrationsHistory"
ORDER BY "MigrationId"; <s:Microsoft.EntityFrameworkCore.Database.Command>
[2024-04-28 19:56:44 +07:00 INF] No migrations were applied. The database is already up to date. <s:Microsoft.EntityFrameworkCore.Migrations>
[2024-04-28 19:56:44 +07:00 INF] User profile is available. Using 'C:\Users\danka\AppData\Local\ASP.NET\DataProtection-Keys' as key repository and Windows DPAPI to encrypt keys at rest. <s:Microsoft.AspNetCore.DataProtection.KeyManagement.XmlKeyManager>
[2024-04-28 19:56:44 +07:00 INF] Executed DbCommand (15ms) [Parameters=[@__normalizedName_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT a."Id", a."ConcurrencyStamp", a."Name", a."NormalizedName", a."RoleType"
FROM "AspNetRoles" AS a
WHERE a."NormalizedName" = @__normalizedName_0
LIMIT 1 <s:Microsoft.EntityFrameworkCore.Database.Command>
[2024-04-28 19:56:44 +07:00 INF] Executed DbCommand (1ms) [Parameters=[@__normalizedName_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT a."Id", a."ConcurrencyStamp", a."Name", a."NormalizedName", a."RoleType"
FROM "AspNetRoles" AS a
WHERE a."NormalizedName" = @__normalizedName_0
LIMIT 1 <s:Microsoft.EntityFrameworkCore.Database.Command>
[2024-04-28 19:56:44 +07:00 INF] Executed DbCommand (3ms) [Parameters=[@__normalizedEmail_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT a."Id", a."AccessFailedCount", a."ConcurrencyStamp", a."Discriminator", a."Email", a."EmailConfirmed", a."FullName", a."JoinedAt", a."LockoutEnabled", a."LockoutEnd", a."NormalizedEmail", a."NormalizedUserName", a."PasswordHash", a."PhoneNumber", a."PhoneNumberConfirmed", a."SecurityStamp", a."TwoFactorEnabled", a."UserName", a."CourseNumber", a."Group"
FROM "AspNetUsers" AS a
WHERE a."NormalizedEmail" = @__normalizedEmail_0
LIMIT 2 <s:Microsoft.EntityFrameworkCore.Database.Command>
[2024-04-28 19:56:45 +07:00 INF] Executed DbCommand (1ms) [Parameters=[@__normalizedEmail_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT a."Id", a."AccessFailedCount", a."ConcurrencyStamp", a."Discriminator", a."Email", a."EmailConfirmed", a."FullName", a."JoinedAt", a."LockoutEnabled", a."LockoutEnd", a."NormalizedEmail", a."NormalizedUserName", a."PasswordHash", a."PhoneNumber", a."PhoneNumberConfirmed", a."SecurityStamp", a."TwoFactorEnabled", a."UserName", a."CourseNumber", a."Group"
FROM "AspNetUsers" AS a
WHERE a."NormalizedEmail" = @__normalizedEmail_0
LIMIT 2 <s:Microsoft.EntityFrameworkCore.Database.Command>
[2024-04-28 19:56:45 +07:00 INF] Executed DbCommand (1ms) [Parameters=[@__normalizedRoleName_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT a."Id", a."ConcurrencyStamp", a."Name", a."NormalizedName", a."RoleType"
FROM "AspNetRoles" AS a
WHERE a."NormalizedName" = @__normalizedRoleName_0
LIMIT 2 <s:Microsoft.EntityFrameworkCore.Database.Command>
[2024-04-28 19:56:45 +07:00 INF] Executed DbCommand (5ms) [Parameters=[@__get_Item_0='?' (DbType = Guid), @__get_Item_1='?' (DbType = Guid)], CommandType='"Text"', CommandTimeout='30']
SELECT a."UserId", a."RoleId"
FROM "AspNetUserRoles" AS a
WHERE a."UserId" = @__get_Item_0 AND a."RoleId" = @__get_Item_1
LIMIT 1 <s:Microsoft.EntityFrameworkCore.Database.Command>
[2024-04-28 19:56:45 +07:00 INF] Now listening on: http://localhost:5105 <s:Microsoft.Hosting.Lifetime>
[2024-04-28 19:56:45 +07:00 INF] Application started. Press Ctrl+C to shut down. <s:Microsoft.Hosting.Lifetime>
[2024-04-28 19:56:45 +07:00 INF] Hosting environment: Development <s:Microsoft.Hosting.Lifetime>
[2024-04-28 19:56:45 +07:00 INF] Content root path: D:\prog\a_projects\back\Internship\Internship-system.API <s:Microsoft.Hosting.Lifetime>
[2024-04-28 19:56:46 +07:00 INF] Request starting HTTP/1.1 GET http://localhost:5105/swagger/index.html - null null <s:Microsoft.AspNetCore.Hosting.Diagnostics>
[2024-04-28 19:56:47 +07:00 INF] Request finished HTTP/1.1 GET http://localhost:5105/swagger/index.html - 200 null text/html;charset=utf-8 508.4091ms <s:Microsoft.AspNetCore.Hosting.Diagnostics>
[2024-04-28 19:56:47 +07:00 INF] Request starting HTTP/1.1 GET http://localhost:5105/swagger/v1/swagger.json - null null <s:Microsoft.AspNetCore.Hosting.Diagnostics>
[2024-04-28 19:56:47 +07:00 INF] Request finished HTTP/1.1 GET http://localhost:5105/swagger/v1/swagger.json - 200 null application/json;charset=utf-8 479.1313ms <s:Microsoft.AspNetCore.Hosting.Diagnostics>
[2024-04-28 19:56:52 +07:00 INF] Request starting HTTP/1.1 GET http://localhost:5105/admin/internship/students/table - null null <s:Microsoft.AspNetCore.Hosting.Diagnostics>
[2024-04-28 19:56:52 +07:00 WRN] Failed to determine the https port for redirect. <s:Microsoft.AspNetCore.HttpsPolicy.HttpsRedirectionMiddleware>
[2024-04-28 19:56:52 +07:00 INF] Executing endpoint 'Internship_system.Controllers.InternshipAdminController.ExportStudentsAsTable (Internship-system.API)' <s:Microsoft.AspNetCore.Routing.EndpointMiddleware>
[2024-04-28 19:56:52 +07:00 INF] Route matched with {action = "ExportStudentsAsTable", controller = "InternshipAdmin"}. Executing controller action with signature System.Threading.Tasks.Task ExportStudentsAsTable() on controller Internship_system.Controllers.InternshipAdminController (Internship-system.API). <s:Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker>
[2024-04-28 19:56:52 +07:00 INF] Executed action Internship_system.Controllers.InternshipAdminController.ExportStudentsAsTable (Internship-system.API) in 515.2688ms <s:Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker>
[2024-04-28 19:56:52 +07:00 INF] Executed endpoint 'Internship_system.Controllers.InternshipAdminController.ExportStudentsAsTable (Internship-system.API)' <s:Microsoft.AspNetCore.Routing.EndpointMiddleware>
[2024-04-28 19:56:52 +07:00 ERR] {"StatusCode":500,"Message":"Something went wrong","TraceId":"00-34a5891e607430437ee75201e70679ec-b395cfae20b8adc4-00"} <s:Internship_system.BLL.Exceptions.ExceptionHandlerMiddleware>
OfficeOpenXml.LicenseException: Please set the ExcelPackage.LicenseContext property. See https://epplussoftware.com/developers/licenseexception
   at OfficeOpenXml.ExcelPackage.get_Workbook()
   at Internship_system.BLL.Services.InternshipAdminService.ExportStudentsAsTable() in D:\prog\a_projects\back\Internship\Internship-system.BLL\Services\InternshipAdminService.cs:line 124
   at Internship_system.Controllers.InternshipAdminController.ExportStudentsAsTable() in D:\prog\a_projects\back\Internship\Internship-system.API\Controllers\InternshipAdminController.cs:line 49
   at Microsoft.AspNetCore.Mvc.Infrastructure.ActionMethodExecutor.TaskResultExecutor.Execute(ActionContext actionContext, IActionResultTypeMapper mapper, ObjectMethodExecutor executor, Object controller, Object[] arguments)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.<InvokeActionMethodAsync>g__Awaited|12_0(ControllerActionInvoker invoker, ValueTask`1 actionResultValueTask)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.<InvokeNextActionFilterAsync>g__Awaited|10_0(ControllerActionInvoker invoker, Task lastTask, State next, Scope scope, Object state, Boolean isCompleted)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.Rethrow(ActionExecutedContextSealed context)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.Next(State& next, Scope& scope, Object& state, Boolean& isCompleted)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.InvokeInnerFilterAsync()
--- End of stack trace from previous location ---
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.<InvokeFilterPipelineAsync>g__Awaited|20_0(ResourceInvoker invoker, Task lastTask, State next, Scope scope, Object state, Boolean isCompleted)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.<InvokeAsync>g__Logged|17_1(ResourceInvoker invoker)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.<InvokeAsync>g__Logged|17_1(ResourceInvoker invoker)
   at Microsoft.AspNetCore.Routing.EndpointMiddleware.<Invoke>g__AwaitRequestTask|7_0(Endpoint endpoint, Task requestTask, ILogger logger)
   at Microsoft.AspNetCore.Authentication.AuthenticationMiddleware.Invoke(HttpContext context)
   at Microsoft.AspNetCore.Authorization.AuthorizationMiddleware.Invoke(HttpContext context)
   at Internship_system.BLL.Exceptions.ExceptionHandlerMiddleware.InvokeAsync(HttpContext context) in D:\prog\a_projects\back\Internship\Internship-system.BLL\Exceptions\ExceptionHandlerMiddleware.cs:line 27
[2024-04-28 19:56:52 +07:00 INF] Request finished HTTP/1.1 GET http://localhost:5105/admin/internship/students/table - 500 null application/json 662.5637ms <s:Microsoft.AspNetCore.Hosting.Diagnostics>
[2024-04-28 19:56:58 +07:00 INF] Request starting HTTP/1.1 GET http://localhost:5105/admin/internship/students/table - null null <s:Microsoft.AspNetCore.Hosting.Diagnostics>
[2024-04-28 19:56:58 +07:00 INF] Executing endpoint 'Internship_system.Controllers.InternshipAdminController.ExportStudentsAsTable (Internship-system.API)' <s:Microsoft.AspNetCore.Routing.EndpointMiddleware>
[2024-04-28 19:56:58 +07:00 INF] Route matched with {action = "ExportStudentsAsTable", controller = "InternshipAdmin"}. Executing controller action with signature System.Threading.Tasks.Task ExportStudentsAsTable() on controller Internship_system.Controllers.InternshipAdminController (Internship-system.API). <s:Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker>
[2024-04-28 19:56:58 +07:00 INF] Executed action Internship_system.Controllers.InternshipAdminController.ExportStudentsAsTable (Internship-system.API) in 218.1428ms <s:Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker>
[2024-04-28 19:56:58 +07:00 INF] Executed endpoint 'Internship_system.Controllers.InternshipAdminController.ExportStudentsAsTable (Internship-system.API)' <s:Microsoft.AspNetCore.Routing.EndpointMiddleware>
[2024-04-28 19:56:58 +07:00 ERR] {"StatusCode":500,"Message":"Something went wrong","TraceId":"00-a55c078980f03ff34a7423e86771fcb4-f679ac793662d7b8-00"} <s:Internship_system.BLL.Exceptions.ExceptionHandlerMiddleware>
OfficeOpenXml.LicenseException: Please set the ExcelPackage.LicenseContext property. See https://epplussoftware.com/developers/licenseexception
   at OfficeOpenXml.ExcelPackage.get_Workbook()
   at Internship_system.BLL.Services.InternshipAdminService.ExportStudentsAsTable() in D:\prog\a_projects\back\Internship\Internship-system.BLL\Services\InternshipAdminService.cs:line 124
   at Internship_system.Controllers.InternshipAdminController.ExportStudentsAsTable() in D:\prog\a_projects\back\Internship\Internship-system.API\Controllers\InternshipAdminController.cs:line 49
   at Microsoft.AspNetCore.Mvc.Infrastructure.ActionMethodExecutor.TaskResultExecutor.Execute(ActionContext actionContext, IActionResultTypeMapper mapper, ObjectMethodExecutor executor, Object controller, Object[] arguments)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.<InvokeActionMethodAsync>g__Awaited|12_0(ControllerActionInvoker invoker, ValueTask`1 actionResultValueTask)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.<InvokeNextActionFilterAsync>g__Awaited|10_0(ControllerActionInvoker invoker, Task lastTask, State next, Scope scope, Object state, Boolean isCompleted)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.Rethrow(ActionExecutedContextSealed context)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.Next(State& next, Scope& scope, Object& state, Boolean& isCompleted)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.InvokeInnerFilterAsync()
--- End of stack trace from previous location ---
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.<InvokeFilterPipelineAsync>g__Awaited|20_0(ResourceInvoker invoker, Task lastTask, State next, Scope scope, Object state, Boolean isCompleted)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.<InvokeAsync>g__Logged|17_1(ResourceInvoker invoker)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.<InvokeAsync>g__Logged|17_1(ResourceInvoker invoker)
   at Microsoft.AspNetCore.Routing.EndpointMiddleware.<Invoke>g__AwaitRequestTask|7_0(Endpoint endpoint, Task requestTask, ILogger logger)
   at Microsoft.AspNetCore.Authentication.AuthenticationMiddleware.Invoke(HttpContext context)
   at Microsoft.AspNetCore.Authorization.AuthorizationMiddleware.Invoke(HttpContext context)
   at Internship_system.BLL.Exceptions.ExceptionHandlerMiddleware.InvokeAsync(HttpContext context) in D:\prog\a_projects\back\Internship\Internship-system.BLL\Exceptions\ExceptionHandlerMiddleware.cs:line 27
[2024-04-28 19:56:59 +07:00 INF] Request finished HTTP/1.1 GET http://localhost:5105/admin/internship/students/table - 500 null application/json 307.3354ms <s:Microsoft.AspNetCore.Hosting.Diagnostics>
[2024-04-28 19:57:01 +07:00 INF] Request starting HTTP/1.1 GET http://localhost:5105/admin/internship/students/table - null null <s:Microsoft.AspNetCore.Hosting.Diagnostics>
[2024-04-28 19:57:01 +07:00 INF] Executing endpoint 'Internship_system.Controllers.InternshipAdminController.ExportStudentsAsTable (Internship-system.API)' <s:Microsoft.AspNetCore.Routing.EndpointMiddleware>
[2024-04-28 19:57:01 +07:00 INF] Route matched with {action = "ExportStudentsAsTable", controller = "InternshipAdmin"}. Executing controller action with signature System.Threading.Tasks.Task ExportStudentsAsTable() on controller Internship_system.Controllers.InternshipAdminController (Internship-system.API). <s:Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker>
[2024-04-28 19:57:01 +07:00 INF] Executed action Internship_system.Controllers.InternshipAdminController.ExportStudentsAsTable (Internship-system.API) in 126.9074ms <s:Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker>
[2024-04-28 19:57:01 +07:00 INF] Executed endpoint 'Internship_system.Controllers.InternshipAdminController.ExportStudentsAsTable (Internship-system.API)' <s:Microsoft.AspNetCore.Routing.EndpointMiddleware>
[2024-04-28 19:57:01 +07:00 ERR] {"StatusCode":500,"Message":"Something went wrong","TraceId":"00-bfbb4320e9426e95d7a41ba25c8a4812-56ad893a6cbe41ab-00"} <s:Internship_system.BLL.Exceptions.ExceptionHandlerMiddleware>
OfficeOpenXml.LicenseException: Please set the ExcelPackage.LicenseContext property. See https://epplussoftware.com/developers/licenseexception
   at OfficeOpenXml.ExcelPackage.get_Workbook()
   at Internship_system.BLL.Services.InternshipAdminService.ExportStudentsAsTable() in D:\prog\a_projects\back\Internship\Internship-system.BLL\Services\InternshipAdminService.cs:line 124
   at Internship_system.Controllers.InternshipAdminController.ExportStudentsAsTable() in D:\prog\a_projects\back\Internship\Internship-system.API\Controllers\InternshipAdminController.cs:line 49
   at Microsoft.AspNetCore.Mvc.Infrastructure.ActionMethodExecutor.TaskResultExecutor.Execute(ActionContext actionContext, IActionResultTypeMapper mapper, ObjectMethodExecutor executor, Object controller, Object[] arguments)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.<InvokeActionMethodAsync>g__Awaited|12_0(ControllerActionInvoker invoker, ValueTask`1 actionResultValueTask)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.<InvokeNextActionFilterAsync>g__Awaited|10_0(ControllerActionInvoker invoker, Task lastTask, State next, Scope scope, Object state, Boolean isCompleted)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.Rethrow(ActionExecutedContextSealed context)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.Next(State& next, Scope& scope, Object& state, Boolean& isCompleted)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.InvokeInnerFilterAsync()
--- End of stack trace from previous location ---
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.<InvokeFilterPipelineAsync>g__Awaited|20_0(ResourceInvoker invoker, Task lastTask, State next, Scope scope, Object state, Boolean isCompleted)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.<InvokeAsync>g__Logged|17_1(ResourceInvoker invoker)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.<InvokeAsync>g__Logged|17_1(ResourceInvoker invoker)
   at Microsoft.AspNetCore.Routing.EndpointMiddleware.<Invoke>g__AwaitRequestTask|7_0(Endpoint endpoint, Task requestTask, ILogger logger)
   at Microsoft.AspNetCore.Authentication.AuthenticationMiddleware.Invoke(HttpContext context)
   at Microsoft.AspNetCore.Authorization.AuthorizationMiddleware.Invoke(HttpContext context)
   at Internship_system.BLL.Exceptions.ExceptionHandlerMiddleware.InvokeAsync(HttpContext context) in D:\prog\a_projects\back\Internship\Internship-system.BLL\Exceptions\ExceptionHandlerMiddleware.cs:line 27
[2024-04-28 19:57:01 +07:00 INF] Request finished HTTP/1.1 GET http://localhost:5105/admin/internship/students/table - 500 null application/json 224.4403ms <s:Microsoft.AspNetCore.Hosting.Diagnostics>
[2024-04-28 19:57:26 +07:00 INF] Executed DbCommand (101ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT EXISTS (
    SELECT 1 FROM pg_catalog.pg_class c
    JOIN pg_catalog.pg_namespace n ON n.oid=c.relnamespace
    WHERE n.nspname='public' AND
          c.relname='__EFMigrationsHistory'
) <s:Microsoft.EntityFrameworkCore.Database.Command>
[2024-04-28 19:57:26 +07:00 INF] Executed DbCommand (16ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT "MigrationId", "ProductVersion"
FROM "__EFMigrationsHistory"
ORDER BY "MigrationId"; <s:Microsoft.EntityFrameworkCore.Database.Command>
[2024-04-28 19:57:26 +07:00 INF] Executed DbCommand (8ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT EXISTS (
    SELECT 1 FROM pg_catalog.pg_class c
    JOIN pg_catalog.pg_namespace n ON n.oid=c.relnamespace
    WHERE n.nspname='public' AND
          c.relname='__EFMigrationsHistory'
) <s:Microsoft.EntityFrameworkCore.Database.Command>
[2024-04-28 19:57:26 +07:00 INF] Executed DbCommand (2ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT EXISTS (
    SELECT 1 FROM pg_catalog.pg_class c
    JOIN pg_catalog.pg_namespace n ON n.oid=c.relnamespace
    WHERE n.nspname='public' AND
          c.relname='__EFMigrationsHistory'
) <s:Microsoft.EntityFrameworkCore.Database.Command>
[2024-04-28 19:57:26 +07:00 INF] Executed DbCommand (1ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT "MigrationId", "ProductVersion"
FROM "__EFMigrationsHistory"
ORDER BY "MigrationId"; <s:Microsoft.EntityFrameworkCore.Database.Command>
[2024-04-28 19:57:26 +07:00 INF] No migrations were applied. The database is already up to date. <s:Microsoft.EntityFrameworkCore.Migrations>
[2024-04-28 19:57:26 +07:00 INF] User profile is available. Using 'C:\Users\danka\AppData\Local\ASP.NET\DataProtection-Keys' as key repository and Windows DPAPI to encrypt keys at rest. <s:Microsoft.AspNetCore.DataProtection.KeyManagement.XmlKeyManager>
[2024-04-28 19:57:27 +07:00 INF] Executed DbCommand (15ms) [Parameters=[@__normalizedName_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT a."Id", a."ConcurrencyStamp", a."Name", a."NormalizedName", a."RoleType"
FROM "AspNetRoles" AS a
WHERE a."NormalizedName" = @__normalizedName_0
LIMIT 1 <s:Microsoft.EntityFrameworkCore.Database.Command>
[2024-04-28 19:57:27 +07:00 INF] Executed DbCommand (1ms) [Parameters=[@__normalizedName_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT a."Id", a."ConcurrencyStamp", a."Name", a."NormalizedName", a."RoleType"
FROM "AspNetRoles" AS a
WHERE a."NormalizedName" = @__normalizedName_0
LIMIT 1 <s:Microsoft.EntityFrameworkCore.Database.Command>
[2024-04-28 19:57:27 +07:00 INF] Executed DbCommand (3ms) [Parameters=[@__normalizedEmail_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT a."Id", a."AccessFailedCount", a."ConcurrencyStamp", a."Discriminator", a."Email", a."EmailConfirmed", a."FullName", a."JoinedAt", a."LockoutEnabled", a."LockoutEnd", a."NormalizedEmail", a."NormalizedUserName", a."PasswordHash", a."PhoneNumber", a."PhoneNumberConfirmed", a."SecurityStamp", a."TwoFactorEnabled", a."UserName", a."CourseNumber", a."Group"
FROM "AspNetUsers" AS a
WHERE a."NormalizedEmail" = @__normalizedEmail_0
LIMIT 2 <s:Microsoft.EntityFrameworkCore.Database.Command>
[2024-04-28 19:57:27 +07:00 INF] Executed DbCommand (2ms) [Parameters=[@__normalizedEmail_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT a."Id", a."AccessFailedCount", a."ConcurrencyStamp", a."Discriminator", a."Email", a."EmailConfirmed", a."FullName", a."JoinedAt", a."LockoutEnabled", a."LockoutEnd", a."NormalizedEmail", a."NormalizedUserName", a."PasswordHash", a."PhoneNumber", a."PhoneNumberConfirmed", a."SecurityStamp", a."TwoFactorEnabled", a."UserName", a."CourseNumber", a."Group"
FROM "AspNetUsers" AS a
WHERE a."NormalizedEmail" = @__normalizedEmail_0
LIMIT 2 <s:Microsoft.EntityFrameworkCore.Database.Command>
[2024-04-28 19:57:27 +07:00 INF] Executed DbCommand (1ms) [Parameters=[@__normalizedRoleName_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT a."Id", a."ConcurrencyStamp", a."Name", a."NormalizedName", a."RoleType"
FROM "AspNetRoles" AS a
WHERE a."NormalizedName" = @__normalizedRoleName_0
LIMIT 2 <s:Microsoft.EntityFrameworkCore.Database.Command>
[2024-04-28 19:57:27 +07:00 INF] Executed DbCommand (4ms) [Parameters=[@__get_Item_0='?' (DbType = Guid), @__get_Item_1='?' (DbType = Guid)], CommandType='"Text"', CommandTimeout='30']
SELECT a."UserId", a."RoleId"
FROM "AspNetUserRoles" AS a
WHERE a."UserId" = @__get_Item_0 AND a."RoleId" = @__get_Item_1
LIMIT 1 <s:Microsoft.EntityFrameworkCore.Database.Command>
[2024-04-28 19:57:27 +07:00 INF] Now listening on: http://localhost:5105 <s:Microsoft.Hosting.Lifetime>
[2024-04-28 19:57:27 +07:00 INF] Application started. Press Ctrl+C to shut down. <s:Microsoft.Hosting.Lifetime>
[2024-04-28 19:57:27 +07:00 INF] Hosting environment: Development <s:Microsoft.Hosting.Lifetime>
[2024-04-28 19:57:27 +07:00 INF] Content root path: D:\prog\a_projects\back\Internship\Internship-system.API <s:Microsoft.Hosting.Lifetime>
[2024-04-28 19:57:28 +07:00 INF] Request starting HTTP/1.1 GET http://localhost:5105/swagger/index.html - null null <s:Microsoft.AspNetCore.Hosting.Diagnostics>
[2024-04-28 19:57:28 +07:00 INF] Request finished HTTP/1.1 GET http://localhost:5105/swagger/index.html - 200 null text/html;charset=utf-8 388.432ms <s:Microsoft.AspNetCore.Hosting.Diagnostics>
[2024-04-28 19:57:28 +07:00 INF] Request starting HTTP/1.1 GET http://localhost:5105/swagger/v1/swagger.json - null null <s:Microsoft.AspNetCore.Hosting.Diagnostics>
[2024-04-28 19:57:29 +07:00 INF] Request finished HTTP/1.1 GET http://localhost:5105/swagger/v1/swagger.json - 200 null application/json;charset=utf-8 447.1542ms <s:Microsoft.AspNetCore.Hosting.Diagnostics>
[2024-04-28 19:57:43 +07:00 INF] Request starting HTTP/1.1 GET http://localhost:5105/admin/internship/students/table - null null <s:Microsoft.AspNetCore.Hosting.Diagnostics>
[2024-04-28 19:57:43 +07:00 WRN] Failed to determine the https port for redirect. <s:Microsoft.AspNetCore.HttpsPolicy.HttpsRedirectionMiddleware>
[2024-04-28 19:57:43 +07:00 INF] Executing endpoint 'Internship_system.Controllers.InternshipAdminController.ExportStudentsAsTable (Internship-system.API)' <s:Microsoft.AspNetCore.Routing.EndpointMiddleware>
[2024-04-28 19:57:43 +07:00 INF] Route matched with {action = "ExportStudentsAsTable", controller = "InternshipAdmin"}. Executing controller action with signature System.Threading.Tasks.Task ExportStudentsAsTable() on controller Internship_system.Controllers.InternshipAdminController (Internship-system.API). <s:Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker>
[2024-04-28 19:57:43 +07:00 INF] Executed action Internship_system.Controllers.InternshipAdminController.ExportStudentsAsTable (Internship-system.API) in 426.5529ms <s:Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker>
[2024-04-28 19:57:43 +07:00 INF] Executed endpoint 'Internship_system.Controllers.InternshipAdminController.ExportStudentsAsTable (Internship-system.API)' <s:Microsoft.AspNetCore.Routing.EndpointMiddleware>
[2024-04-28 19:57:43 +07:00 ERR] {"StatusCode":500,"Message":"Something went wrong","TraceId":"00-c0d93d489eb57c4a3d9ed4b59ba5730e-82e964813a059298-00"} <s:Internship_system.BLL.Exceptions.ExceptionHandlerMiddleware>
OfficeOpenXml.LicenseException: Please set the ExcelPackage.LicenseContext property. See https://epplussoftware.com/developers/licenseexception
   at OfficeOpenXml.ExcelPackage.get_Workbook()
   at Internship_system.BLL.Services.InternshipAdminService.ExportStudentsAsTable() in D:\prog\a_projects\back\Internship\Internship-system.BLL\Services\InternshipAdminService.cs:line 124
   at Internship_system.Controllers.InternshipAdminController.ExportStudentsAsTable() in D:\prog\a_projects\back\Internship\Internship-system.API\Controllers\InternshipAdminController.cs:line 49
   at Microsoft.AspNetCore.Mvc.Infrastructure.ActionMethodExecutor.TaskResultExecutor.Execute(ActionContext actionContext, IActionResultTypeMapper mapper, ObjectMethodExecutor executor, Object controller, Object[] arguments)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.<InvokeActionMethodAsync>g__Awaited|12_0(ControllerActionInvoker invoker, ValueTask`1 actionResultValueTask)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.<InvokeNextActionFilterAsync>g__Awaited|10_0(ControllerActionInvoker invoker, Task lastTask, State next, Scope scope, Object state, Boolean isCompleted)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.Rethrow(ActionExecutedContextSealed context)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.Next(State& next, Scope& scope, Object& state, Boolean& isCompleted)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.InvokeInnerFilterAsync()
--- End of stack trace from previous location ---
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.<InvokeFilterPipelineAsync>g__Awaited|20_0(ResourceInvoker invoker, Task lastTask, State next, Scope scope, Object state, Boolean isCompleted)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.<InvokeAsync>g__Logged|17_1(ResourceInvoker invoker)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.<InvokeAsync>g__Logged|17_1(ResourceInvoker invoker)
   at Microsoft.AspNetCore.Routing.EndpointMiddleware.<Invoke>g__AwaitRequestTask|7_0(Endpoint endpoint, Task requestTask, ILogger logger)
   at Microsoft.AspNetCore.Authentication.AuthenticationMiddleware.Invoke(HttpContext context)
   at Microsoft.AspNetCore.Authorization.AuthorizationMiddleware.Invoke(HttpContext context)
   at Internship_system.BLL.Exceptions.ExceptionHandlerMiddleware.InvokeAsync(HttpContext context) in D:\prog\a_projects\back\Internship\Internship-system.BLL\Exceptions\ExceptionHandlerMiddleware.cs:line 27
[2024-04-28 19:57:43 +07:00 INF] Request finished HTTP/1.1 GET http://localhost:5105/admin/internship/students/table - 500 null application/json 611.0939ms <s:Microsoft.AspNetCore.Hosting.Diagnostics>
[2024-04-28 19:58:08 +07:00 INF] Request starting HTTP/1.1 GET http://localhost:5105/admin/internship/students/table - null null <s:Microsoft.AspNetCore.Hosting.Diagnostics>
[2024-04-28 19:58:08 +07:00 INF] Executing endpoint 'Internship_system.Controllers.InternshipAdminController.ExportStudentsAsTable (Internship-system.API)' <s:Microsoft.AspNetCore.Routing.EndpointMiddleware>
[2024-04-28 19:58:08 +07:00 INF] Route matched with {action = "ExportStudentsAsTable", controller = "InternshipAdmin"}. Executing controller action with signature System.Threading.Tasks.Task ExportStudentsAsTable() on controller Internship_system.Controllers.InternshipAdminController (Internship-system.API). <s:Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker>
[2024-04-28 19:59:18 +07:00 INF] Executed DbCommand (105ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT EXISTS (
    SELECT 1 FROM pg_catalog.pg_class c
    JOIN pg_catalog.pg_namespace n ON n.oid=c.relnamespace
    WHERE n.nspname='public' AND
          c.relname='__EFMigrationsHistory'
) <s:Microsoft.EntityFrameworkCore.Database.Command>
[2024-04-28 19:59:18 +07:00 INF] Executed DbCommand (13ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT "MigrationId", "ProductVersion"
FROM "__EFMigrationsHistory"
ORDER BY "MigrationId"; <s:Microsoft.EntityFrameworkCore.Database.Command>
[2024-04-28 19:59:18 +07:00 INF] Executed DbCommand (3ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT EXISTS (
    SELECT 1 FROM pg_catalog.pg_class c
    JOIN pg_catalog.pg_namespace n ON n.oid=c.relnamespace
    WHERE n.nspname='public' AND
          c.relname='__EFMigrationsHistory'
) <s:Microsoft.EntityFrameworkCore.Database.Command>
[2024-04-28 19:59:18 +07:00 INF] Executed DbCommand (1ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT EXISTS (
    SELECT 1 FROM pg_catalog.pg_class c
    JOIN pg_catalog.pg_namespace n ON n.oid=c.relnamespace
    WHERE n.nspname='public' AND
          c.relname='__EFMigrationsHistory'
) <s:Microsoft.EntityFrameworkCore.Database.Command>
[2024-04-28 19:59:18 +07:00 INF] Executed DbCommand (1ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT "MigrationId", "ProductVersion"
FROM "__EFMigrationsHistory"
ORDER BY "MigrationId"; <s:Microsoft.EntityFrameworkCore.Database.Command>
[2024-04-28 19:59:18 +07:00 INF] No migrations were applied. The database is already up to date. <s:Microsoft.EntityFrameworkCore.Migrations>
[2024-04-28 19:59:18 +07:00 INF] User profile is available. Using 'C:\Users\danka\AppData\Local\ASP.NET\DataProtection-Keys' as key repository and Windows DPAPI to encrypt keys at rest. <s:Microsoft.AspNetCore.DataProtection.KeyManagement.XmlKeyManager>
[2024-04-28 19:59:18 +07:00 INF] Executed DbCommand (14ms) [Parameters=[@__normalizedName_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT a."Id", a."ConcurrencyStamp", a."Name", a."NormalizedName", a."RoleType"
FROM "AspNetRoles" AS a
WHERE a."NormalizedName" = @__normalizedName_0
LIMIT 1 <s:Microsoft.EntityFrameworkCore.Database.Command>
[2024-04-28 19:59:18 +07:00 INF] Executed DbCommand (1ms) [Parameters=[@__normalizedName_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT a."Id", a."ConcurrencyStamp", a."Name", a."NormalizedName", a."RoleType"
FROM "AspNetRoles" AS a
WHERE a."NormalizedName" = @__normalizedName_0
LIMIT 1 <s:Microsoft.EntityFrameworkCore.Database.Command>
[2024-04-28 19:59:18 +07:00 INF] Executed DbCommand (4ms) [Parameters=[@__normalizedEmail_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT a."Id", a."AccessFailedCount", a."ConcurrencyStamp", a."Discriminator", a."Email", a."EmailConfirmed", a."FullName", a."JoinedAt", a."LockoutEnabled", a."LockoutEnd", a."NormalizedEmail", a."NormalizedUserName", a."PasswordHash", a."PhoneNumber", a."PhoneNumberConfirmed", a."SecurityStamp", a."TwoFactorEnabled", a."UserName", a."CourseNumber", a."Group"
FROM "AspNetUsers" AS a
WHERE a."NormalizedEmail" = @__normalizedEmail_0
LIMIT 2 <s:Microsoft.EntityFrameworkCore.Database.Command>
[2024-04-28 19:59:19 +07:00 INF] Executed DbCommand (2ms) [Parameters=[@__normalizedEmail_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT a."Id", a."AccessFailedCount", a."ConcurrencyStamp", a."Discriminator", a."Email", a."EmailConfirmed", a."FullName", a."JoinedAt", a."LockoutEnabled", a."LockoutEnd", a."NormalizedEmail", a."NormalizedUserName", a."PasswordHash", a."PhoneNumber", a."PhoneNumberConfirmed", a."SecurityStamp", a."TwoFactorEnabled", a."UserName", a."CourseNumber", a."Group"
FROM "AspNetUsers" AS a
WHERE a."NormalizedEmail" = @__normalizedEmail_0
LIMIT 2 <s:Microsoft.EntityFrameworkCore.Database.Command>
[2024-04-28 19:59:19 +07:00 INF] Executed DbCommand (2ms) [Parameters=[@__normalizedRoleName_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT a."Id", a."ConcurrencyStamp", a."Name", a."NormalizedName", a."RoleType"
FROM "AspNetRoles" AS a
WHERE a."NormalizedName" = @__normalizedRoleName_0
LIMIT 2 <s:Microsoft.EntityFrameworkCore.Database.Command>
[2024-04-28 19:59:19 +07:00 INF] Executed DbCommand (4ms) [Parameters=[@__get_Item_0='?' (DbType = Guid), @__get_Item_1='?' (DbType = Guid)], CommandType='"Text"', CommandTimeout='30']
SELECT a."UserId", a."RoleId"
FROM "AspNetUserRoles" AS a
WHERE a."UserId" = @__get_Item_0 AND a."RoleId" = @__get_Item_1
LIMIT 1 <s:Microsoft.EntityFrameworkCore.Database.Command>
[2024-04-28 19:59:19 +07:00 INF] Now listening on: http://localhost:5105 <s:Microsoft.Hosting.Lifetime>
[2024-04-28 19:59:19 +07:00 INF] Application started. Press Ctrl+C to shut down. <s:Microsoft.Hosting.Lifetime>
[2024-04-28 19:59:19 +07:00 INF] Hosting environment: Development <s:Microsoft.Hosting.Lifetime>
[2024-04-28 19:59:19 +07:00 INF] Content root path: D:\prog\a_projects\back\Internship\Internship-system.API <s:Microsoft.Hosting.Lifetime>
[2024-04-28 19:59:20 +07:00 INF] Request starting HTTP/1.1 GET http://localhost:5105/swagger/index.html - null null <s:Microsoft.AspNetCore.Hosting.Diagnostics>
[2024-04-28 19:59:20 +07:00 INF] Request finished HTTP/1.1 GET http://localhost:5105/swagger/index.html - 200 null text/html;charset=utf-8 574.5836ms <s:Microsoft.AspNetCore.Hosting.Diagnostics>
[2024-04-28 19:59:21 +07:00 INF] Request starting HTTP/1.1 GET http://localhost:5105/swagger/v1/swagger.json - null null <s:Microsoft.AspNetCore.Hosting.Diagnostics>
[2024-04-28 19:59:21 +07:00 INF] Request finished HTTP/1.1 GET http://localhost:5105/swagger/v1/swagger.json - 200 null application/json;charset=utf-8 718.0806ms <s:Microsoft.AspNetCore.Hosting.Diagnostics>
[2024-04-28 19:59:23 +07:00 INF] Request starting HTTP/1.1 GET http://localhost:5105/admin/internship/students/table - null null <s:Microsoft.AspNetCore.Hosting.Diagnostics>
[2024-04-28 19:59:23 +07:00 WRN] Failed to determine the https port for redirect. <s:Microsoft.AspNetCore.HttpsPolicy.HttpsRedirectionMiddleware>
[2024-04-28 19:59:23 +07:00 INF] Executing endpoint 'Internship_system.Controllers.InternshipAdminController.ExportStudentsAsTable (Internship-system.API)' <s:Microsoft.AspNetCore.Routing.EndpointMiddleware>
[2024-04-28 19:59:23 +07:00 INF] Route matched with {action = "ExportStudentsAsTable", controller = "InternshipAdmin"}. Executing controller action with signature System.Threading.Tasks.Task ExportStudentsAsTable() on controller Internship_system.Controllers.InternshipAdminController (Internship-system.API). <s:Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker>
[2024-04-28 19:59:41 +07:00 INF] Executed action Internship_system.Controllers.InternshipAdminController.ExportStudentsAsTable (Internship-system.API) in 17636.6229ms <s:Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker>
[2024-04-28 19:59:41 +07:00 INF] Executed endpoint 'Internship_system.Controllers.InternshipAdminController.ExportStudentsAsTable (Internship-system.API)' <s:Microsoft.AspNetCore.Routing.EndpointMiddleware>
[2024-04-28 19:59:41 +07:00 INF] Request finished HTTP/1.1 GET http://localhost:5105/admin/internship/students/table - 200 0 null 17708.107ms <s:Microsoft.AspNetCore.Hosting.Diagnostics>
[2024-04-28 20:00:44 +07:00 INF] Executed DbCommand (121ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT EXISTS (
    SELECT 1 FROM pg_catalog.pg_class c
    JOIN pg_catalog.pg_namespace n ON n.oid=c.relnamespace
    WHERE n.nspname='public' AND
          c.relname='__EFMigrationsHistory'
) <s:Microsoft.EntityFrameworkCore.Database.Command>
[2024-04-28 20:00:44 +07:00 INF] Executed DbCommand (19ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT "MigrationId", "ProductVersion"
FROM "__EFMigrationsHistory"
ORDER BY "MigrationId"; <s:Microsoft.EntityFrameworkCore.Database.Command>
[2024-04-28 20:00:45 +07:00 INF] Executed DbCommand (5ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT EXISTS (
    SELECT 1 FROM pg_catalog.pg_class c
    JOIN pg_catalog.pg_namespace n ON n.oid=c.relnamespace
    WHERE n.nspname='public' AND
          c.relname='__EFMigrationsHistory'
) <s:Microsoft.EntityFrameworkCore.Database.Command>
[2024-04-28 20:00:45 +07:00 INF] Executed DbCommand (2ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT EXISTS (
    SELECT 1 FROM pg_catalog.pg_class c
    JOIN pg_catalog.pg_namespace n ON n.oid=c.relnamespace
    WHERE n.nspname='public' AND
          c.relname='__EFMigrationsHistory'
) <s:Microsoft.EntityFrameworkCore.Database.Command>
[2024-04-28 20:00:45 +07:00 INF] Executed DbCommand (2ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT "MigrationId", "ProductVersion"
FROM "__EFMigrationsHistory"
ORDER BY "MigrationId"; <s:Microsoft.EntityFrameworkCore.Database.Command>
[2024-04-28 20:00:45 +07:00 INF] No migrations were applied. The database is already up to date. <s:Microsoft.EntityFrameworkCore.Migrations>
[2024-04-28 20:00:45 +07:00 INF] User profile is available. Using 'C:\Users\danka\AppData\Local\ASP.NET\DataProtection-Keys' as key repository and Windows DPAPI to encrypt keys at rest. <s:Microsoft.AspNetCore.DataProtection.KeyManagement.XmlKeyManager>
[2024-04-28 20:00:45 +07:00 INF] Executed DbCommand (19ms) [Parameters=[@__normalizedName_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT a."Id", a."ConcurrencyStamp", a."Name", a."NormalizedName", a."RoleType"
FROM "AspNetRoles" AS a
WHERE a."NormalizedName" = @__normalizedName_0
LIMIT 1 <s:Microsoft.EntityFrameworkCore.Database.Command>
[2024-04-28 20:00:45 +07:00 INF] Executed DbCommand (1ms) [Parameters=[@__normalizedName_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT a."Id", a."ConcurrencyStamp", a."Name", a."NormalizedName", a."RoleType"
FROM "AspNetRoles" AS a
WHERE a."NormalizedName" = @__normalizedName_0
LIMIT 1 <s:Microsoft.EntityFrameworkCore.Database.Command>
[2024-04-28 20:00:45 +07:00 INF] Executed DbCommand (5ms) [Parameters=[@__normalizedEmail_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT a."Id", a."AccessFailedCount", a."ConcurrencyStamp", a."Discriminator", a."Email", a."EmailConfirmed", a."FullName", a."JoinedAt", a."LockoutEnabled", a."LockoutEnd", a."NormalizedEmail", a."NormalizedUserName", a."PasswordHash", a."PhoneNumber", a."PhoneNumberConfirmed", a."SecurityStamp", a."TwoFactorEnabled", a."UserName", a."CourseNumber", a."Group"
FROM "AspNetUsers" AS a
WHERE a."NormalizedEmail" = @__normalizedEmail_0
LIMIT 2 <s:Microsoft.EntityFrameworkCore.Database.Command>
[2024-04-28 20:00:46 +07:00 INF] Executed DbCommand (1ms) [Parameters=[@__normalizedEmail_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT a."Id", a."AccessFailedCount", a."ConcurrencyStamp", a."Discriminator", a."Email", a."EmailConfirmed", a."FullName", a."JoinedAt", a."LockoutEnabled", a."LockoutEnd", a."NormalizedEmail", a."NormalizedUserName", a."PasswordHash", a."PhoneNumber", a."PhoneNumberConfirmed", a."SecurityStamp", a."TwoFactorEnabled", a."UserName", a."CourseNumber", a."Group"
FROM "AspNetUsers" AS a
WHERE a."NormalizedEmail" = @__normalizedEmail_0
LIMIT 2 <s:Microsoft.EntityFrameworkCore.Database.Command>
[2024-04-28 20:00:46 +07:00 INF] Executed DbCommand (1ms) [Parameters=[@__normalizedRoleName_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT a."Id", a."ConcurrencyStamp", a."Name", a."NormalizedName", a."RoleType"
FROM "AspNetRoles" AS a
WHERE a."NormalizedName" = @__normalizedRoleName_0
LIMIT 2 <s:Microsoft.EntityFrameworkCore.Database.Command>
[2024-04-28 20:00:46 +07:00 INF] Executed DbCommand (5ms) [Parameters=[@__get_Item_0='?' (DbType = Guid), @__get_Item_1='?' (DbType = Guid)], CommandType='"Text"', CommandTimeout='30']
SELECT a."UserId", a."RoleId"
FROM "AspNetUserRoles" AS a
WHERE a."UserId" = @__get_Item_0 AND a."RoleId" = @__get_Item_1
LIMIT 1 <s:Microsoft.EntityFrameworkCore.Database.Command>
[2024-04-28 20:00:46 +07:00 INF] Now listening on: http://localhost:5105 <s:Microsoft.Hosting.Lifetime>
[2024-04-28 20:00:46 +07:00 INF] Application started. Press Ctrl+C to shut down. <s:Microsoft.Hosting.Lifetime>
[2024-04-28 20:00:46 +07:00 INF] Hosting environment: Development <s:Microsoft.Hosting.Lifetime>
[2024-04-28 20:00:46 +07:00 INF] Content root path: D:\prog\a_projects\back\Internship\Internship-system.API <s:Microsoft.Hosting.Lifetime>
[2024-04-28 20:00:47 +07:00 INF] Request starting HTTP/1.1 GET http://localhost:5105/swagger/index.html - null null <s:Microsoft.AspNetCore.Hosting.Diagnostics>
[2024-04-28 20:00:47 +07:00 INF] Request finished HTTP/1.1 GET http://localhost:5105/swagger/index.html - 200 null text/html;charset=utf-8 335.1ms <s:Microsoft.AspNetCore.Hosting.Diagnostics>
[2024-04-28 20:00:47 +07:00 INF] Request starting HTTP/1.1 GET http://localhost:5105/swagger/v1/swagger.json - null null <s:Microsoft.AspNetCore.Hosting.Diagnostics>
[2024-04-28 20:00:48 +07:00 INF] Request finished HTTP/1.1 GET http://localhost:5105/swagger/v1/swagger.json - 200 null application/json;charset=utf-8 461.7252ms <s:Microsoft.AspNetCore.Hosting.Diagnostics>
[2024-04-28 20:00:51 +07:00 INF] Request starting HTTP/1.1 GET http://localhost:5105/admin/internship/students/table - null null <s:Microsoft.AspNetCore.Hosting.Diagnostics>
[2024-04-28 20:00:51 +07:00 WRN] Failed to determine the https port for redirect. <s:Microsoft.AspNetCore.HttpsPolicy.HttpsRedirectionMiddleware>
[2024-04-28 20:00:51 +07:00 INF] Executing endpoint 'Internship_system.Controllers.InternshipAdminController.ExportStudentsAsTable (Internship-system.API)' <s:Microsoft.AspNetCore.Routing.EndpointMiddleware>
[2024-04-28 20:00:51 +07:00 INF] Route matched with {action = "ExportStudentsAsTable", controller = "InternshipAdmin"}. Executing controller action with signature System.Threading.Tasks.Task ExportStudentsAsTable() on controller Internship_system.Controllers.InternshipAdminController (Internship-system.API). <s:Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker>
[2024-04-28 20:00:52 +07:00 INF] Executed action Internship_system.Controllers.InternshipAdminController.ExportStudentsAsTable (Internship-system.API) in 1192.5525ms <s:Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker>
[2024-04-28 20:00:52 +07:00 INF] Executed endpoint 'Internship_system.Controllers.InternshipAdminController.ExportStudentsAsTable (Internship-system.API)' <s:Microsoft.AspNetCore.Routing.EndpointMiddleware>
[2024-04-28 20:00:52 +07:00 INF] Request finished HTTP/1.1 GET http://localhost:5105/admin/internship/students/table - 200 0 null 1277.35ms <s:Microsoft.AspNetCore.Hosting.Diagnostics>
[2024-04-28 20:02:27 +07:00 INF] Request starting HTTP/1.1 POST http://localhost:5105/admin/internship/students - multipart/form-data; boundary=----WebKitFormBoundary4qj3UxGyFI68oBtX 4356 <s:Microsoft.AspNetCore.Hosting.Diagnostics>
[2024-04-28 20:02:27 +07:00 INF] CORS policy execution successful. <s:Microsoft.AspNetCore.Cors.Infrastructure.CorsService>
[2024-04-28 20:02:27 +07:00 INF] Executing endpoint 'Internship_system.Controllers.InternshipAdminController.UploadStudents (Internship-system.API)' <s:Microsoft.AspNetCore.Routing.EndpointMiddleware>
[2024-04-28 20:02:27 +07:00 INF] Route matched with {action = "UploadStudents", controller = "InternshipAdmin"}. Executing controller action with signature System.Threading.Tasks.Task UploadStudents(Microsoft.AspNetCore.Http.IFormFile) on controller Internship_system.Controllers.InternshipAdminController (Internship-system.API). <s:Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker>
[2024-04-28 20:02:27 +07:00 INF] Executed DbCommand (3ms) [Parameters=[@__normalizedEmail_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT a."Id", a."AccessFailedCount", a."ConcurrencyStamp", a."Discriminator", a."Email", a."EmailConfirmed", a."FullName", a."JoinedAt", a."LockoutEnabled", a."LockoutEnd", a."NormalizedEmail", a."NormalizedUserName", a."PasswordHash", a."PhoneNumber", a."PhoneNumberConfirmed", a."SecurityStamp", a."TwoFactorEnabled", a."UserName", a."CourseNumber", a."Group"
FROM "AspNetUsers" AS a
WHERE a."NormalizedEmail" = @__normalizedEmail_0
LIMIT 2 <s:Microsoft.EntityFrameworkCore.Database.Command>
[2024-04-28 20:02:28 +07:00 INF] Executed DbCommand (1ms) [Parameters=[@__normalizedUserName_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT a."Id", a."AccessFailedCount", a."ConcurrencyStamp", a."Discriminator", a."Email", a."EmailConfirmed", a."FullName", a."JoinedAt", a."LockoutEnabled", a."LockoutEnd", a."NormalizedEmail", a."NormalizedUserName", a."PasswordHash", a."PhoneNumber", a."PhoneNumberConfirmed", a."SecurityStamp", a."TwoFactorEnabled", a."UserName", a."CourseNumber", a."Group"
FROM "AspNetUsers" AS a
WHERE a."NormalizedUserName" = @__normalizedUserName_0
LIMIT 1 <s:Microsoft.EntityFrameworkCore.Database.Command>
[2024-04-28 20:02:28 +07:00 INF] Executed DbCommand (23ms) [Parameters=[@p18='?' (DbType = Guid), @p0='?' (DbType = Int32), @p1='?', @p19='?', @p2='?' (DbType = Int32), @p3='?', @p4='?' (DbType = Boolean), @p5='?', @p6='?', @p7='?' (DbType = DateTime), @p8='?' (DbType = Boolean), @p9='?' (DbType = DateTime), @p10='?', @p11='?', @p12='?', @p13='?', @p14='?' (DbType = Boolean), @p15='?', @p16='?' (DbType = Boolean), @p17='?'], CommandType='"Text"', CommandTimeout='30']
UPDATE "AspNetUsers" SET "AccessFailedCount" = @p0, "ConcurrencyStamp" = @p1, "CourseNumber" = @p2, "Email" = @p3, "EmailConfirmed" = @p4, "FullName" = @p5, "Group" = @p6, "JoinedAt" = @p7, "LockoutEnabled" = @p8, "LockoutEnd" = @p9, "NormalizedEmail" = @p10, "NormalizedUserName" = @p11, "PasswordHash" = @p12, "PhoneNumber" = @p13, "PhoneNumberConfirmed" = @p14, "SecurityStamp" = @p15, "TwoFactorEnabled" = @p16, "UserName" = @p17
WHERE "Id" = @p18 AND "ConcurrencyStamp" = @p19; <s:Microsoft.EntityFrameworkCore.Database.Command>
[2024-04-28 20:02:28 +07:00 INF] Executed DbCommand (1ms) [Parameters=[@__normalizedEmail_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT a."Id", a."AccessFailedCount", a."ConcurrencyStamp", a."Discriminator", a."Email", a."EmailConfirmed", a."FullName", a."JoinedAt", a."LockoutEnabled", a."LockoutEnd", a."NormalizedEmail", a."NormalizedUserName", a."PasswordHash", a."PhoneNumber", a."PhoneNumberConfirmed", a."SecurityStamp", a."TwoFactorEnabled", a."UserName", a."CourseNumber", a."Group"
FROM "AspNetUsers" AS a
WHERE a."NormalizedEmail" = @__normalizedEmail_0
LIMIT 2 <s:Microsoft.EntityFrameworkCore.Database.Command>
[2024-04-28 20:02:28 +07:00 INF] Executed DbCommand (1ms) [Parameters=[@__normalizedUserName_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT a."Id", a."AccessFailedCount", a."ConcurrencyStamp", a."Discriminator", a."Email", a."EmailConfirmed", a."FullName", a."JoinedAt", a."LockoutEnabled", a."LockoutEnd", a."NormalizedEmail", a."NormalizedUserName", a."PasswordHash", a."PhoneNumber", a."PhoneNumberConfirmed", a."SecurityStamp", a."TwoFactorEnabled", a."UserName", a."CourseNumber", a."Group"
FROM "AspNetUsers" AS a
WHERE a."NormalizedUserName" = @__normalizedUserName_0
LIMIT 1 <s:Microsoft.EntityFrameworkCore.Database.Command>
[2024-04-28 20:02:28 +07:00 INF] Executed DbCommand (2ms) [Parameters=[@p18='?' (DbType = Guid), @p0='?' (DbType = Int32), @p1='?', @p19='?', @p2='?' (DbType = Int32), @p3='?', @p4='?' (DbType = Boolean), @p5='?', @p6='?', @p7='?' (DbType = DateTime), @p8='?' (DbType = Boolean), @p9='?' (DbType = DateTime), @p10='?', @p11='?', @p12='?', @p13='?', @p14='?' (DbType = Boolean), @p15='?', @p16='?' (DbType = Boolean), @p17='?'], CommandType='"Text"', CommandTimeout='30']
UPDATE "AspNetUsers" SET "AccessFailedCount" = @p0, "ConcurrencyStamp" = @p1, "CourseNumber" = @p2, "Email" = @p3, "EmailConfirmed" = @p4, "FullName" = @p5, "Group" = @p6, "JoinedAt" = @p7, "LockoutEnabled" = @p8, "LockoutEnd" = @p9, "NormalizedEmail" = @p10, "NormalizedUserName" = @p11, "PasswordHash" = @p12, "PhoneNumber" = @p13, "PhoneNumberConfirmed" = @p14, "SecurityStamp" = @p15, "TwoFactorEnabled" = @p16, "UserName" = @p17
WHERE "Id" = @p18 AND "ConcurrencyStamp" = @p19; <s:Microsoft.EntityFrameworkCore.Database.Command>
[2024-04-28 20:02:28 +07:00 INF] Executed action Internship_system.Controllers.InternshipAdminController.UploadStudents (Internship-system.API) in 816.8729ms <s:Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker>
[2024-04-28 20:02:28 +07:00 INF] Executed endpoint 'Internship_system.Controllers.InternshipAdminController.UploadStudents (Internship-system.API)' <s:Microsoft.AspNetCore.Routing.EndpointMiddleware>
[2024-04-28 20:02:28 +07:00 ERR] {"StatusCode":500,"Message":"Something went wrong","TraceId":"00-7832a0e0756e52a273248dadce6c7c02-c5979306da907465-00"} <s:Internship_system.BLL.Exceptions.ExceptionHandlerMiddleware>
System.IO.IOException: The process cannot access the file 'D:\prog\a_projects\back\Internship\Internship-system.API\Uploads\exportStudents.xlsx' because it is being used by another process.
   at System.IO.FileSystem.DeleteFile(String fullPath)
   at Internship_system.BLL.Services.InternshipAdminService.UploadStudents(IFormFile studentsTable) in D:\prog\a_projects\back\Internship\Internship-system.BLL\Services\InternshipAdminService.cs:line 108
   at Internship_system.Controllers.InternshipAdminController.UploadStudents(IFormFile studentsTable) in D:\prog\a_projects\back\Internship\Internship-system.API\Controllers\InternshipAdminController.cs:line 39
   at Microsoft.AspNetCore.Mvc.Infrastructure.ActionMethodExecutor.TaskResultExecutor.Execute(ActionContext actionContext, IActionResultTypeMapper mapper, ObjectMethodExecutor executor, Object controller, Object[] arguments)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.<InvokeActionMethodAsync>g__Awaited|12_0(ControllerActionInvoker invoker, ValueTask`1 actionResultValueTask)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.<InvokeNextActionFilterAsync>g__Awaited|10_0(ControllerActionInvoker invoker, Task lastTask, State next, Scope scope, Object state, Boolean isCompleted)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.Rethrow(ActionExecutedContextSealed context)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.Next(State& next, Scope& scope, Object& state, Boolean& isCompleted)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.<InvokeInnerFilterAsync>g__Awaited|13_0(ControllerActionInvoker invoker, Task lastTask, State next, Scope scope, Object state, Boolean isCompleted)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.<InvokeNextResourceFilter>g__Awaited|25_0(ResourceInvoker invoker, Task lastTask, State next, Scope scope, Object state, Boolean isCompleted)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.Rethrow(ResourceExecutedContextSealed context)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.Next(State& next, Scope& scope, Object& state, Boolean& isCompleted)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.<InvokeFilterPipelineAsync>g__Awaited|20_0(ResourceInvoker invoker, Task lastTask, State next, Scope scope, Object state, Boolean isCompleted)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.<InvokeAsync>g__Logged|17_1(ResourceInvoker invoker)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.<InvokeAsync>g__Logged|17_1(ResourceInvoker invoker)
   at Microsoft.AspNetCore.Routing.EndpointMiddleware.<Invoke>g__AwaitRequestTask|7_0(Endpoint endpoint, Task requestTask, ILogger logger)
   at Microsoft.AspNetCore.Authentication.AuthenticationMiddleware.Invoke(HttpContext context)
   at Microsoft.AspNetCore.Authorization.AuthorizationMiddleware.Invoke(HttpContext context)
   at Internship_system.BLL.Exceptions.ExceptionHandlerMiddleware.InvokeAsync(HttpContext context) in D:\prog\a_projects\back\Internship\Internship-system.BLL\Exceptions\ExceptionHandlerMiddleware.cs:line 27
[2024-04-28 20:02:28 +07:00 INF] Request finished HTTP/1.1 POST http://localhost:5105/admin/internship/students - 500 null application/json 945.3889ms <s:Microsoft.AspNetCore.Hosting.Diagnostics>
[2024-04-28 20:02:39 +07:00 INF] Application is shutting down... <s:Microsoft.Hosting.Lifetime>
[2024-04-28 20:03:10 +07:00 INF] Executed DbCommand (109ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT EXISTS (
    SELECT 1 FROM pg_catalog.pg_class c
    JOIN pg_catalog.pg_namespace n ON n.oid=c.relnamespace
    WHERE n.nspname='public' AND
          c.relname='__EFMigrationsHistory'
) <s:Microsoft.EntityFrameworkCore.Database.Command>
[2024-04-28 20:03:10 +07:00 INF] Executed DbCommand (9ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT "MigrationId", "ProductVersion"
FROM "__EFMigrationsHistory"
ORDER BY "MigrationId"; <s:Microsoft.EntityFrameworkCore.Database.Command>
[2024-04-28 20:03:10 +07:00 INF] Executed DbCommand (4ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT EXISTS (
    SELECT 1 FROM pg_catalog.pg_class c
    JOIN pg_catalog.pg_namespace n ON n.oid=c.relnamespace
    WHERE n.nspname='public' AND
          c.relname='__EFMigrationsHistory'
) <s:Microsoft.EntityFrameworkCore.Database.Command>
[2024-04-28 20:03:10 +07:00 INF] Executed DbCommand (1ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT EXISTS (
    SELECT 1 FROM pg_catalog.pg_class c
    JOIN pg_catalog.pg_namespace n ON n.oid=c.relnamespace
    WHERE n.nspname='public' AND
          c.relname='__EFMigrationsHistory'
) <s:Microsoft.EntityFrameworkCore.Database.Command>
[2024-04-28 20:03:10 +07:00 INF] Executed DbCommand (1ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT "MigrationId", "ProductVersion"
FROM "__EFMigrationsHistory"
ORDER BY "MigrationId"; <s:Microsoft.EntityFrameworkCore.Database.Command>
[2024-04-28 20:03:10 +07:00 INF] No migrations were applied. The database is already up to date. <s:Microsoft.EntityFrameworkCore.Migrations>
[2024-04-28 20:03:10 +07:00 INF] User profile is available. Using 'C:\Users\danka\AppData\Local\ASP.NET\DataProtection-Keys' as key repository and Windows DPAPI to encrypt keys at rest. <s:Microsoft.AspNetCore.DataProtection.KeyManagement.XmlKeyManager>
[2024-04-28 20:03:11 +07:00 INF] Executed DbCommand (15ms) [Parameters=[@__normalizedName_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT a."Id", a."ConcurrencyStamp", a."Name", a."NormalizedName", a."RoleType"
FROM "AspNetRoles" AS a
WHERE a."NormalizedName" = @__normalizedName_0
LIMIT 1 <s:Microsoft.EntityFrameworkCore.Database.Command>
[2024-04-28 20:03:11 +07:00 INF] Executed DbCommand (1ms) [Parameters=[@__normalizedName_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT a."Id", a."ConcurrencyStamp", a."Name", a."NormalizedName", a."RoleType"
FROM "AspNetRoles" AS a
WHERE a."NormalizedName" = @__normalizedName_0
LIMIT 1 <s:Microsoft.EntityFrameworkCore.Database.Command>
[2024-04-28 20:03:11 +07:00 INF] Executed DbCommand (3ms) [Parameters=[@__normalizedEmail_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT a."Id", a."AccessFailedCount", a."ConcurrencyStamp", a."Discriminator", a."Email", a."EmailConfirmed", a."FullName", a."JoinedAt", a."LockoutEnabled", a."LockoutEnd", a."NormalizedEmail", a."NormalizedUserName", a."PasswordHash", a."PhoneNumber", a."PhoneNumberConfirmed", a."SecurityStamp", a."TwoFactorEnabled", a."UserName", a."CourseNumber", a."Group"
FROM "AspNetUsers" AS a
WHERE a."NormalizedEmail" = @__normalizedEmail_0
LIMIT 2 <s:Microsoft.EntityFrameworkCore.Database.Command>
[2024-04-28 20:03:11 +07:00 INF] Executed DbCommand (2ms) [Parameters=[@__normalizedEmail_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT a."Id", a."AccessFailedCount", a."ConcurrencyStamp", a."Discriminator", a."Email", a."EmailConfirmed", a."FullName", a."JoinedAt", a."LockoutEnabled", a."LockoutEnd", a."NormalizedEmail", a."NormalizedUserName", a."PasswordHash", a."PhoneNumber", a."PhoneNumberConfirmed", a."SecurityStamp", a."TwoFactorEnabled", a."UserName", a."CourseNumber", a."Group"
FROM "AspNetUsers" AS a
WHERE a."NormalizedEmail" = @__normalizedEmail_0
LIMIT 2 <s:Microsoft.EntityFrameworkCore.Database.Command>
[2024-04-28 20:03:11 +07:00 INF] Executed DbCommand (1ms) [Parameters=[@__normalizedRoleName_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT a."Id", a."ConcurrencyStamp", a."Name", a."NormalizedName", a."RoleType"
FROM "AspNetRoles" AS a
WHERE a."NormalizedName" = @__normalizedRoleName_0
LIMIT 2 <s:Microsoft.EntityFrameworkCore.Database.Command>
[2024-04-28 20:03:11 +07:00 INF] Executed DbCommand (5ms) [Parameters=[@__get_Item_0='?' (DbType = Guid), @__get_Item_1='?' (DbType = Guid)], CommandType='"Text"', CommandTimeout='30']
SELECT a."UserId", a."RoleId"
FROM "AspNetUserRoles" AS a
WHERE a."UserId" = @__get_Item_0 AND a."RoleId" = @__get_Item_1
LIMIT 1 <s:Microsoft.EntityFrameworkCore.Database.Command>
[2024-04-28 20:03:12 +07:00 INF] Now listening on: http://localhost:5105 <s:Microsoft.Hosting.Lifetime>
[2024-04-28 20:03:12 +07:00 INF] Application started. Press Ctrl+C to shut down. <s:Microsoft.Hosting.Lifetime>
[2024-04-28 20:03:12 +07:00 INF] Hosting environment: Development <s:Microsoft.Hosting.Lifetime>
[2024-04-28 20:03:12 +07:00 INF] Content root path: D:\prog\a_projects\back\Internship\Internship-system.API <s:Microsoft.Hosting.Lifetime>
[2024-04-28 20:03:12 +07:00 INF] Request starting HTTP/1.1 GET http://localhost:5105/swagger/index.html - null null <s:Microsoft.AspNetCore.Hosting.Diagnostics>
[2024-04-28 20:03:12 +07:00 INF] Request finished HTTP/1.1 GET http://localhost:5105/swagger/index.html - 200 null text/html;charset=utf-8 555.3539ms <s:Microsoft.AspNetCore.Hosting.Diagnostics>
[2024-04-28 20:03:13 +07:00 INF] Request starting HTTP/1.1 GET http://localhost:5105/swagger/v1/swagger.json - null null <s:Microsoft.AspNetCore.Hosting.Diagnostics>
[2024-04-28 20:03:13 +07:00 INF] Request finished HTTP/1.1 GET http://localhost:5105/swagger/v1/swagger.json - 200 null application/json;charset=utf-8 562.39ms <s:Microsoft.AspNetCore.Hosting.Diagnostics>
[2024-04-28 20:03:23 +07:00 INF] Request starting HTTP/1.1 GET http://localhost:5105/admin/internship/students/table - null null <s:Microsoft.AspNetCore.Hosting.Diagnostics>
[2024-04-28 20:03:23 +07:00 WRN] Failed to determine the https port for redirect. <s:Microsoft.AspNetCore.HttpsPolicy.HttpsRedirectionMiddleware>
[2024-04-28 20:03:23 +07:00 INF] Executing endpoint 'Internship_system.Controllers.InternshipAdminController.ExportStudentsAsTable (Internship-system.API)' <s:Microsoft.AspNetCore.Routing.EndpointMiddleware>
[2024-04-28 20:03:23 +07:00 INF] Route matched with {action = "ExportStudentsAsTable", controller = "InternshipAdmin"}. Executing controller action with signature System.Threading.Tasks.Task ExportStudentsAsTable() on controller Internship_system.Controllers.InternshipAdminController (Internship-system.API). <s:Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker>
[2024-04-28 20:03:24 +07:00 INF] Executed action Internship_system.Controllers.InternshipAdminController.ExportStudentsAsTable (Internship-system.API) in 977.2809ms <s:Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker>
[2024-04-28 20:03:24 +07:00 INF] Executed endpoint 'Internship_system.Controllers.InternshipAdminController.ExportStudentsAsTable (Internship-system.API)' <s:Microsoft.AspNetCore.Routing.EndpointMiddleware>
[2024-04-28 20:03:24 +07:00 INF] Request finished HTTP/1.1 GET http://localhost:5105/admin/internship/students/table - 200 0 null 1055.0361ms <s:Microsoft.AspNetCore.Hosting.Diagnostics>
[2024-04-28 20:03:34 +07:00 INF] Request starting HTTP/1.1 POST http://localhost:5105/admin/internship/students - multipart/form-data; boundary=----WebKitFormBoundary4yaNEQOwH1fXkGFN 4356 <s:Microsoft.AspNetCore.Hosting.Diagnostics>
[2024-04-28 20:03:34 +07:00 INF] CORS policy execution successful. <s:Microsoft.AspNetCore.Cors.Infrastructure.CorsService>
[2024-04-28 20:03:34 +07:00 INF] Executing endpoint 'Internship_system.Controllers.InternshipAdminController.UploadStudents (Internship-system.API)' <s:Microsoft.AspNetCore.Routing.EndpointMiddleware>
[2024-04-28 20:03:34 +07:00 INF] Route matched with {action = "UploadStudents", controller = "InternshipAdmin"}. Executing controller action with signature System.Threading.Tasks.Task UploadStudents(Microsoft.AspNetCore.Http.IFormFile) on controller Internship_system.Controllers.InternshipAdminController (Internship-system.API). <s:Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker>
[2024-04-28 20:03:34 +07:00 INF] Executed DbCommand (3ms) [Parameters=[@__normalizedEmail_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT a."Id", a."AccessFailedCount", a."ConcurrencyStamp", a."Discriminator", a."Email", a."EmailConfirmed", a."FullName", a."JoinedAt", a."LockoutEnabled", a."LockoutEnd", a."NormalizedEmail", a."NormalizedUserName", a."PasswordHash", a."PhoneNumber", a."PhoneNumberConfirmed", a."SecurityStamp", a."TwoFactorEnabled", a."UserName", a."CourseNumber", a."Group"
FROM "AspNetUsers" AS a
WHERE a."NormalizedEmail" = @__normalizedEmail_0
LIMIT 2 <s:Microsoft.EntityFrameworkCore.Database.Command>
[2024-04-28 20:03:35 +07:00 INF] Executed DbCommand (4ms) [Parameters=[@__normalizedUserName_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT a."Id", a."AccessFailedCount", a."ConcurrencyStamp", a."Discriminator", a."Email", a."EmailConfirmed", a."FullName", a."JoinedAt", a."LockoutEnabled", a."LockoutEnd", a."NormalizedEmail", a."NormalizedUserName", a."PasswordHash", a."PhoneNumber", a."PhoneNumberConfirmed", a."SecurityStamp", a."TwoFactorEnabled", a."UserName", a."CourseNumber", a."Group"
FROM "AspNetUsers" AS a
WHERE a."NormalizedUserName" = @__normalizedUserName_0
LIMIT 1 <s:Microsoft.EntityFrameworkCore.Database.Command>
[2024-04-28 20:03:35 +07:00 INF] Executed DbCommand (46ms) [Parameters=[@p18='?' (DbType = Guid), @p0='?' (DbType = Int32), @p1='?', @p19='?', @p2='?' (DbType = Int32), @p3='?', @p4='?' (DbType = Boolean), @p5='?', @p6='?', @p7='?' (DbType = DateTime), @p8='?' (DbType = Boolean), @p9='?' (DbType = DateTime), @p10='?', @p11='?', @p12='?', @p13='?', @p14='?' (DbType = Boolean), @p15='?', @p16='?' (DbType = Boolean), @p17='?'], CommandType='"Text"', CommandTimeout='30']
UPDATE "AspNetUsers" SET "AccessFailedCount" = @p0, "ConcurrencyStamp" = @p1, "CourseNumber" = @p2, "Email" = @p3, "EmailConfirmed" = @p4, "FullName" = @p5, "Group" = @p6, "JoinedAt" = @p7, "LockoutEnabled" = @p8, "LockoutEnd" = @p9, "NormalizedEmail" = @p10, "NormalizedUserName" = @p11, "PasswordHash" = @p12, "PhoneNumber" = @p13, "PhoneNumberConfirmed" = @p14, "SecurityStamp" = @p15, "TwoFactorEnabled" = @p16, "UserName" = @p17
WHERE "Id" = @p18 AND "ConcurrencyStamp" = @p19; <s:Microsoft.EntityFrameworkCore.Database.Command>
[2024-04-28 20:03:35 +07:00 INF] Executed DbCommand (2ms) [Parameters=[@__normalizedEmail_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT a."Id", a."AccessFailedCount", a."ConcurrencyStamp", a."Discriminator", a."Email", a."EmailConfirmed", a."FullName", a."JoinedAt", a."LockoutEnabled", a."LockoutEnd", a."NormalizedEmail", a."NormalizedUserName", a."PasswordHash", a."PhoneNumber", a."PhoneNumberConfirmed", a."SecurityStamp", a."TwoFactorEnabled", a."UserName", a."CourseNumber", a."Group"
FROM "AspNetUsers" AS a
WHERE a."NormalizedEmail" = @__normalizedEmail_0
LIMIT 2 <s:Microsoft.EntityFrameworkCore.Database.Command>
[2024-04-28 20:03:35 +07:00 INF] Executed DbCommand (2ms) [Parameters=[@__normalizedUserName_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT a."Id", a."AccessFailedCount", a."ConcurrencyStamp", a."Discriminator", a."Email", a."EmailConfirmed", a."FullName", a."JoinedAt", a."LockoutEnabled", a."LockoutEnd", a."NormalizedEmail", a."NormalizedUserName", a."PasswordHash", a."PhoneNumber", a."PhoneNumberConfirmed", a."SecurityStamp", a."TwoFactorEnabled", a."UserName", a."CourseNumber", a."Group"
FROM "AspNetUsers" AS a
WHERE a."NormalizedUserName" = @__normalizedUserName_0
LIMIT 1 <s:Microsoft.EntityFrameworkCore.Database.Command>
[2024-04-28 20:03:35 +07:00 INF] Executed DbCommand (3ms) [Parameters=[@p18='?' (DbType = Guid), @p0='?' (DbType = Int32), @p1='?', @p19='?', @p2='?' (DbType = Int32), @p3='?', @p4='?' (DbType = Boolean), @p5='?', @p6='?', @p7='?' (DbType = DateTime), @p8='?' (DbType = Boolean), @p9='?' (DbType = DateTime), @p10='?', @p11='?', @p12='?', @p13='?', @p14='?' (DbType = Boolean), @p15='?', @p16='?' (DbType = Boolean), @p17='?'], CommandType='"Text"', CommandTimeout='30']
UPDATE "AspNetUsers" SET "AccessFailedCount" = @p0, "ConcurrencyStamp" = @p1, "CourseNumber" = @p2, "Email" = @p3, "EmailConfirmed" = @p4, "FullName" = @p5, "Group" = @p6, "JoinedAt" = @p7, "LockoutEnabled" = @p8, "LockoutEnd" = @p9, "NormalizedEmail" = @p10, "NormalizedUserName" = @p11, "PasswordHash" = @p12, "PhoneNumber" = @p13, "PhoneNumberConfirmed" = @p14, "SecurityStamp" = @p15, "TwoFactorEnabled" = @p16, "UserName" = @p17
WHERE "Id" = @p18 AND "ConcurrencyStamp" = @p19; <s:Microsoft.EntityFrameworkCore.Database.Command>
[2024-04-28 20:03:35 +07:00 INF] Executed action Internship_system.Controllers.InternshipAdminController.UploadStudents (Internship-system.API) in 1067.5924ms <s:Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker>
[2024-04-28 20:03:35 +07:00 INF] Executed endpoint 'Internship_system.Controllers.InternshipAdminController.UploadStudents (Internship-system.API)' <s:Microsoft.AspNetCore.Routing.EndpointMiddleware>
[2024-04-28 20:03:36 +07:00 ERR] {"StatusCode":500,"Message":"Something went wrong","TraceId":"00-de90b6550081703ffddf586ff077bf6a-17fff1c45d4e8c0b-00"} <s:Internship_system.BLL.Exceptions.ExceptionHandlerMiddleware>
System.IO.IOException: The process cannot access the file 'D:\prog\a_projects\back\Internship\Internship-system.API\Uploads\exportStudents.xlsx' because it is being used by another process.
   at System.IO.FileSystem.DeleteFile(String fullPath)
   at Internship_system.BLL.Services.InternshipAdminService.UploadStudents(IFormFile studentsTable) in D:\prog\a_projects\back\Internship\Internship-system.BLL\Services\InternshipAdminService.cs:line 108
   at Internship_system.Controllers.InternshipAdminController.UploadStudents(IFormFile studentsTable) in D:\prog\a_projects\back\Internship\Internship-system.API\Controllers\InternshipAdminController.cs:line 39
   at Microsoft.AspNetCore.Mvc.Infrastructure.ActionMethodExecutor.TaskResultExecutor.Execute(ActionContext actionContext, IActionResultTypeMapper mapper, ObjectMethodExecutor executor, Object controller, Object[] arguments)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.<InvokeActionMethodAsync>g__Awaited|12_0(ControllerActionInvoker invoker, ValueTask`1 actionResultValueTask)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.<InvokeNextActionFilterAsync>g__Awaited|10_0(ControllerActionInvoker invoker, Task lastTask, State next, Scope scope, Object state, Boolean isCompleted)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.Rethrow(ActionExecutedContextSealed context)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.Next(State& next, Scope& scope, Object& state, Boolean& isCompleted)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.<InvokeInnerFilterAsync>g__Awaited|13_0(ControllerActionInvoker invoker, Task lastTask, State next, Scope scope, Object state, Boolean isCompleted)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.<InvokeNextResourceFilter>g__Awaited|25_0(ResourceInvoker invoker, Task lastTask, State next, Scope scope, Object state, Boolean isCompleted)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.Rethrow(ResourceExecutedContextSealed context)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.Next(State& next, Scope& scope, Object& state, Boolean& isCompleted)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.<InvokeFilterPipelineAsync>g__Awaited|20_0(ResourceInvoker invoker, Task lastTask, State next, Scope scope, Object state, Boolean isCompleted)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.<InvokeAsync>g__Logged|17_1(ResourceInvoker invoker)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.<InvokeAsync>g__Logged|17_1(ResourceInvoker invoker)
   at Microsoft.AspNetCore.Routing.EndpointMiddleware.<Invoke>g__AwaitRequestTask|7_0(Endpoint endpoint, Task requestTask, ILogger logger)
   at Microsoft.AspNetCore.Authentication.AuthenticationMiddleware.Invoke(HttpContext context)
   at Microsoft.AspNetCore.Authorization.AuthorizationMiddleware.Invoke(HttpContext context)
   at Internship_system.BLL.Exceptions.ExceptionHandlerMiddleware.InvokeAsync(HttpContext context) in D:\prog\a_projects\back\Internship\Internship-system.BLL\Exceptions\ExceptionHandlerMiddleware.cs:line 27
[2024-04-28 20:03:36 +07:00 INF] Request finished HTTP/1.1 POST http://localhost:5105/admin/internship/students - 500 null application/json 1453.6651ms <s:Microsoft.AspNetCore.Hosting.Diagnostics>
